<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Courier;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Helv;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"New York";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:System;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;}
@font-face
	{font-family:Latha;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Raavi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Shruti;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Sendnya;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Gautami;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tunga;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"DengXian Light";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Microsoft YaHei";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:Menlo;
	panose-1:2 11 6 9 3 8 4 2 2 4;}
@font-face
	{font-family:STFangsong;
	panose-1:2 1 6 0 4 1 1 1 1 1;}
@font-face
	{font-family:"Lucida Grande";
	panose-1:2 11 6 0 4 5 2 2 2 4;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"\@Microsoft YaHei";}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:"\@SimHei";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:125%;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;}
h1
	{mso-style-link:"Heading 1 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:240%;
	page-break-after:avoid;
	font-size:15.0pt;
	font-family:"Times New Roman",serif;
	color:black;
	font-weight:bold;}
h2
	{mso-style-link:"Heading 2 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:172%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	color:black;
	font-weight:bold;}
h3
	{mso-style-link:"Heading 3 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:172%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman",serif;
	color:black;
	font-weight:bold;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:14.0pt;
	margin-right:0cm;
	margin-bottom:14.5pt;
	margin-left:0cm;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:156%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"DengXian Light";
	font-weight:bold;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:125%;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:21.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:125%;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:42.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:125%;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	line-height:125%;
	layout-grid-mode:char;
	border:none;
	padding:0cm;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:125%;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;}
p.MsoDate, li.MsoDate, div.MsoDate
	{mso-style-link:"Date Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:5.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:125%;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{mso-style-link:"Document Map Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:125%;
	layout-grid-mode:char;
	font-size:9.0pt;
	font-family:SimSun;}
p
	{margin-right:0cm;
	margin-left:0cm;
	line-height:125%;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
pre
	{mso-style-link:"HTML Preformatted Char";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:125%;
	font-size:12.0pt;
	font-family:SimSun;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:125%;
	font-size:9.0pt;
	font-family:"Times New Roman",serif;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:21.0pt;
	line-height:125%;
	font-size:10.5pt;
	font-family:"Times New Roman",serif;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	color:black;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:SimHei;
	color:black;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	color:black;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"DengXian Light";
	font-weight:bold;}
span.ttag
	{mso-style-name:t_tag;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.DocumentMapChar
	{mso-style-name:"Document Map Char";
	mso-style-link:"Document Map";
	font-family:SimSun;}
span.sc-1
	{mso-style-name:sc-1;}
span.st0
	{mso-style-name:st0;}
span.HTMLPreformattedChar
	{mso-style-name:"HTML Preformatted Char";
	mso-style-link:"HTML Preformatted";
	font-family:SimSun;}
span.re2
	{mso-style-name:re2;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
span.DateChar
	{mso-style-name:"Date Char";
	mso-style-link:Date;}
span.sc3
	{mso-style-name:sc3;}
span.re1
	{mso-style-name:re1;}
span.re0
	{mso-style-name:re0;}
p.1, li.1, div.1
	{mso-style-name:"1\.";
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:10.0pt;
	line-height:16.5pt;
	page-break-after:avoid;
	punctuation-trim:leading;
	font-size:11.0pt;
	font-family:"Arial",sans-serif;}
p.a, li.a, div.a
	{mso-style-name:表文;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:14.0pt;
	font-size:7.5pt;
	font-family:"Calibri",sans-serif;
	position:relative;
	top:-4.0pt;
	layout-grid-mode:line;}
p.a0, li.a0, div.a0
	{mso-style-name:编程步骤;
	mso-style-link:"编程步骤 Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	line-height:11.0pt;
	layout-grid-mode:char;
	background:#E0E0E0;
	punctuation-trim:leading;
	font-size:10.5pt;
	font-family:"Courier New";
	color:black;}
span.Char
	{mso-style-name:"编程步骤 Char";
	mso-style-link:编程步骤;
	font-family:"Courier New";
	color:black;
	background:#E0E0E0;}
p.a1, li.a1, div.a1
	{mso-style-name:石墨文档正文;
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:12.0pt;
	font-family:"Microsoft YaHei",sans-serif;}
p.a2, li.a2, div.a2
	{mso-style-name:我的正文;
	mso-style-link:"我的正文 Char Char";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	text-justify:inter-ideograph;
	text-indent:10.0pt;
	line-height:150%;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.CharChar
	{mso-style-name:"我的正文 Char Char";
	mso-style-link:我的正文;}
p.TOCHeading1, li.TOCHeading1, div.TOCHeading1
	{mso-style-name:"TOC Heading1";
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:16.0pt;
	font-family:"DengXian Light";
	color:#2F5496;}
span.UnresolvedMention1
	{mso-style-name:"Unresolved Mention1";
	color:#605E5C;
	background:#E1DFDD;}
p.WPSOffice1, li.WPSOffice1, div.WPSOffice1
	{mso-style-name:"WPSOffice手动目录 1";
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.WPSOffice2, li.WPSOffice2, div.WPSOffice2
	{mso-style-name:"WPSOffice手动目录 2";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:10.0pt;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
p.WPSOffice3, li.WPSOffice3, div.WPSOffice3
	{mso-style-name:"WPSOffice手动目录 3";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:20.0pt;
	margin-bottom:.0001pt;
	line-height:normal;
	font-size:10.0pt;
	font-family:"Times New Roman",serif;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:teal;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:red;}
.MsoChpDefault
	{font-size:10.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	layout-grid:15.6pt;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>

</head>

<body lang=en-CN link=blue vlink=purple style='text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:15.6pt'>

<p class=a1 style='text-align:justify;text-justify:inter-ideograph'><span
lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal align=center style='text-align:center;line-height:normal'><a
name="_Toc10725136"></a><span lang=ZH-CN style='font-family:SimSun'>目录</span></p>

<p class=MsoToc1><a href="#_Toc27466"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>1</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>面试说明</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................................................. 9</span></a></p>

<p class=MsoToc2><a href="#_Toc21380"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>面试过程最关键的是什么？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................. 9</span></a></p>

<p class=MsoToc2><a href="#_Toc20949"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>面试时该怎么说？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................... 9</span></a></p>

<p class=MsoToc3><a href="#_Toc26133"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>）语言表达清楚</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................... 9</span></a></p>

<p class=MsoToc3><a href="#_Toc7982"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>）所述内容不犯错</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................ 9</span></a></p>

<p class=MsoToc2><a href="#_Toc26632"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>面试技巧</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................................. 9</span></a></p>

<p class=MsoToc3><a href="#_Toc28673"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1.3.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>六个常见问题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................ 9</span></a></p>

<p class=MsoToc3><a href="#_Toc13232"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1.3.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>两个注意事项</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.......................................................................................... 10</span></a></p>

<p class=MsoToc3><a href="#_Toc3137"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1.3.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>自我介绍（控制在</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>4</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>分半以内，不超过</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>分钟）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>...................................... 10</span></a></p>

<p class=MsoToc1><a href="#_Toc13409"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>2</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>手写代码</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................................................ 10</span></a></p>

<p class=MsoToc2><a href="#_Toc4219"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>冒泡排序</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 10</span></a></p>

<p class=MsoToc2><a href="#_Toc238"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>二分查找</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 11</span></a></p>

<p class=MsoToc2><a href="#_Toc23238"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>快排</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................................. 13</span></a></p>

<p class=MsoToc2><a href="#_Toc24409"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>归并</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................................. 14</span></a></p>

<p class=MsoToc2><a href="#_Toc8251"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.5  </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>二叉树之</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Scala</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>实现</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......................................................................................... 16</span></a></p>

<p class=MsoToc3><a href="#_Toc8950"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.5.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>二叉树概念</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 16</span></a></p>

<p class=MsoToc3><a href="#_Toc30484"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.5.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>二叉树的特点</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.......................................................................................... 16</span></a></p>

<p class=MsoToc3><a href="#_Toc8318"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.5.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>二叉树的</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Scala</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>代码实现</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.......................................................................... 16</span></a></p>

<p class=MsoToc2><a href="#_Toc17126"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>手写</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark-WordCount....................................................................................... 20</span></a></p>

<p class=MsoToc2><a href="#_Toc4074"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>手写</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>程序</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................................................. 21</span></a></p>

<p class=MsoToc1><a href="#_Toc7062"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>3</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>项目架构</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................................................ 21</span></a></p>

<p class=MsoToc2><a href="#_Toc12823"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数仓概念</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 21</span></a></p>

<p class=MsoToc2><a href="#_Toc19698"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>系统数据流程设计</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................. 21</span></a></p>

<p class=MsoToc2><a href="#_Toc119"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>框架版本选型</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................... 21</span></a></p>

<p class=MsoToc2><a href="#_Toc15383"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>服务器选型</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................................... 21</span></a></p>

<p class=MsoToc3><a href="#_Toc8029"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>）机器成本考虑：</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.......................................................................................... 22</span></a></p>

<p class=MsoToc3><a href="#_Toc10508"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>）运维成本考虑：</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.......................................................................................... 22</span></a></p>

<p class=MsoToc2><a href="#_Toc20395"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>集群规模</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 22</span></a></p>

<p class=MsoToc2><a href="#_Toc13884"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>人员配置参考</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................... 22</span></a></p>

<p class=MsoToc3><a href="#_Toc17128"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.6.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>整体架构。</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 22</span></a></p>

<p class=MsoToc3><a href="#_Toc11446"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.6.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>你们部门的职级等级，晋升规则</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................. 22</span></a></p>

<p class=MsoToc3><a href="#_Toc3335"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3.6.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>人员配置参考</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.......................................................................................... 22</span></a></p>

<p class=MsoToc1><a href="#_Toc27474"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>4</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>项目涉及技术</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................................................................... 23</span></a></p>

<p class=MsoToc2><a href="#_Toc2408"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.1 Linux&amp;Shell</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>相关总结</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......................................................................................... 23</span></a></p>

<p class=MsoToc3><a href="#_Toc8245"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.1.1 Linux</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>常用命令</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................................................... 23</span></a></p>

<p class=MsoToc3><a href="#_Toc29910"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.1.2 Shell</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>常用工具</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.......................................................................................... 23</span></a></p>

<p class=MsoToc2><a href="#_Toc10058"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2 Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>相关总结</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................ 24</span></a></p>

<p class=MsoToc3><a href="#_Toc19605"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.1 Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>常用端口号</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................... 24</span></a></p>

<p class=MsoToc3><a href="#_Toc32170"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.2 Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>配置文件以及简单的</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Hadoop</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>集群搭建</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.......................................... 24</span></a></p>

<p class=MsoToc3><a href="#_Toc17085"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.3 HDFS</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>读流程和写流程</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 25</span></a></p>

<p class=MsoToc3><a href="#_Toc30978"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.4 MapReduce</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Shuffle</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>过程及</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Hadoop</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>优化（包括：压缩、小文件、集群优化）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>      26</span></a></p>

<p class=MsoToc3><a href="#_Toc23145"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.5 Yarn</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Job</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>提交流程</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................................. 29</span></a></p>

<p class=MsoToc3><a href="#_Toc11135"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.6 Yarn</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的默认调度器、调度器分类、以及他们之间的区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................ 29</span></a></p>

<p class=MsoToc3><a href="#_Toc4754"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.7</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目经验之</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>LZO</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>压缩</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................... 30</span></a></p>

<p class=MsoToc3><a href="#_Toc24519"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.8 Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>参数调优</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................................... 31</span></a></p>

<p class=MsoToc3><a href="#_Toc31884"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.9</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目经验之基准测试</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................. 31</span></a></p>

<p class=MsoToc3><a href="#_Toc13828"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.2.10 Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>宕机</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................... 31</span></a></p>

<p class=MsoToc2><a href="#_Toc17265"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.3 Zookeeper</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>相关总结</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................ 31</span></a></p>

<p class=MsoToc3><a href="#_Toc29207"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.3.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>选举机制</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................. 31</span></a></p>

<p class=MsoToc3><a href="#_Toc5136"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.3.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>常用命令</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................. 32</span></a></p>

<p class=MsoToc2><a href="#_Toc19546"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.4 Flume</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>相关总结</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................. 32</span></a></p>

<p class=MsoToc3><a href="#_Toc4365"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.4.1 Flume</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>组成，</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Put</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>事务，</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Take</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>事务</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................. 32</span></a></p>

<p class=MsoToc3><a href="#_Toc25003"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.4.2 Flume</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>拦截器</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................ 32</span></a></p>

<p class=MsoToc3><a href="#_Toc7518"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.4.3 Flume</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>采集数据会丢失吗</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>?</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>（防止数据丢失的机制）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.................................. 33</span></a></p>

<p class=MsoToc3><a href="#_Toc1169"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.4.4 Flume</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>内存</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................... 33</span></a></p>

<p class=MsoToc3><a href="#_Toc22341"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.4.5 FileChannel</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>优化</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>....................................................................................... 33</span></a></p>

<p class=MsoToc3><a href="#_Toc181"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.4.6 HDFS Sink</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>小文件处理</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................. 33</span></a></p>

<p class=MsoToc2><a href="#_Toc12400"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5 Kafka</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>相关总结</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................. 34</span></a></p>

<p class=MsoToc3><a href="#_Toc11021"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.1 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>架构</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................ 34</span></a></p>

<p class=MsoToc3><a href="#_Toc13304"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.2 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>压测</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................ 34</span></a></p>

<p class=MsoToc3><a href="#_Toc11366"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.3 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的机器数量</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................... 34</span></a></p>

<p class=MsoToc3><a href="#_Toc20801"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.4 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的日志保存时间</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 34</span></a></p>

<p class=MsoToc3><a href="#_Toc8494"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.5 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的硬盘大小</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................... 34</span></a></p>

<p class=MsoToc3><a href="#_Toc31513"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.6 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>监控</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................ 34</span></a></p>

<p class=MsoToc3><a href="#_Toc16563"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.7 Kakfa</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>分区数</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................ 35</span></a></p>

<p class=MsoToc3><a href="#_Toc9346"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.8 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>副本数设定</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 35</span></a></p>

<p class=MsoToc3><a href="#_Toc3888"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.9 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>多少个</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Topic............................................................................................ 35</span></a></p>

<p class=MsoToc3><a href="#_Toc12550"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.10 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>丢不丢数据</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................... 35</span></a></p>

<p class=MsoToc3><a href="#_Toc31065"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.11 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>ISR</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>副本同步队列</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................................... 35</span></a></p>

<p class=MsoToc3><a href="#_Toc23695"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.12 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>分区分配策略</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................ 35</span></a></p>

<p class=MsoToc3><a href="#_Toc27983"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.13 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>中数据量计算</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................ 36</span></a></p>

<p class=MsoToc3><a href="#_Toc32533"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.14 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>挂掉</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 36</span></a></p>

<p class=MsoToc3><a href="#_Toc25630"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.5.15 Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>消息数据积压，</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>消费能力不足怎么处理？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................. 36</span></a></p>

<p class=MsoToc2><a href="#_Toc29345"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6 Hive</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>总结</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 37</span></a></p>

<p class=MsoToc3><a href="#_Toc10287"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6.1 Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的架构</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 37</span></a></p>

<p class=MsoToc3><a href="#_Toc22128"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6.2 Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>和数据库比较</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................... 37</span></a></p>

<p class=MsoToc3><a href="#_Toc18522"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>内部表和外部表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................... 37</span></a></p>

<p class=MsoToc3><a href="#_Toc69"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6.4 4</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>个</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>By</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................................. 37</span></a></p>

<p class=MsoToc3><a href="#_Toc25724"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>窗口函数</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................. 38</span></a></p>

<p class=MsoToc3><a href="#_Toc13604"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>自定义</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>UDF</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>、</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>UDTF................................................................................ 38</span></a></p>

<p class=MsoToc3><a href="#_Toc10167"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.6.7 Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>优化</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................. 39</span></a></p>

<p class=MsoToc2><a href="#_Toc19725"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.7 HBase</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>总结</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................................................................... 40</span></a></p>

<p class=MsoToc3><a href="#_Toc9677"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.7.1 HBase</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>存储结构</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................ 40</span></a></p>

<p class=MsoToc3><a href="#_Toc16756"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.7.2 rowkey</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>设计原则</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................... 40</span></a></p>

<p class=MsoToc3><a href="#_Toc15413"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.7.3 RowKey</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>如何设计</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................... 41</span></a></p>

<p class=MsoToc3><a href="#_Toc25733"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.7.4 Phoenix</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>二级索引（讲原理）</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................... 41</span></a></p>

<p class=MsoToc2><a href="#_Toc23759"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.8 Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>参数</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................................................................... 41</span></a></p>

<p class=MsoToc3><a href="#_Toc12147"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.8.1 Sqoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>导入导出</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Null</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>存储一致性问题</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................................ 41</span></a></p>

<p class=MsoToc3><a href="#_Toc6001"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.8.2 Sqoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>数据导出一致性问题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................... 41</span></a></p>

<p class=MsoToc3><a href="#_Toc18536"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.8.3 Sqoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>底层运行的任务是什么</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................... 42</span></a></p>

<p class=MsoToc3><a href="#_Toc8351"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.8.4 Sqoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>数据导出的时候一次执行多长时间</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.................................................. 42</span></a></p>

<p class=MsoToc2><a href="#_Toc9426"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9 Scala.................................................................................................................. 42</span></a></p>

<p class=MsoToc3><a href="#_Toc18214"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>元组</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................ 42</span></a></p>

<p class=MsoToc3><a href="#_Toc4884"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>隐式转换</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................. 42</span></a></p>

<p class=MsoToc3><a href="#_Toc6007"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>函数式编程理解</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................... 43</span></a></p>

<p class=MsoToc3><a href="#_Toc3830"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>样例类</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................................... 43</span></a></p>

<p class=MsoToc3><a href="#_Toc8948"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>柯里化</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................................... 43</span></a></p>

<p class=MsoToc3><a href="#_Toc7740"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>闭包</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................ 44</span></a></p>

<p class=MsoToc3><a href="#_Toc21133"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.9.7 Some</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>、</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>None</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>、</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Option</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>的正确使用</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................. 44</span></a></p>

<p class=MsoToc2><a href="#_Toc8013"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10 Spark................................................................................................................ 44</span></a></p>

<p class=MsoToc3><a href="#_Toc10080"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.1 Spark</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>有几种部署方式？请分别简要论述</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................. 44</span></a></p>

<p class=MsoToc3><a href="#_Toc477"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.2 Spark</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>任务使用什么进行提交，</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>javaEE</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>界面还是脚本</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................... 45</span></a></p>

<p class=MsoToc3><a href="#_Toc8504"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.3 Spark</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>提交作业参数（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.................................................................. 45</span></a></p>

<p class=MsoToc3><a href="#_Toc25059"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的架构与作业提交流程（画图讲解，注明各个部分的作用）（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'> 46</span></a></p>

<p class=MsoToc3><a href="#_Toc541"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何理解</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>中的血统概念（</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>RDD</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）（笔试重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................. 46</span></a></p>

<p class=MsoToc3><a href="#_Toc32627"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的宽窄依赖，以及</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Spark</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>如何划分</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>stage</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>，每个</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>stage</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>又根据什么决定</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>task</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>个数</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>? </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>（笔试重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>     46</span></a></p>

<p class=MsoToc3><a href="#_Toc8021"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>请列举</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>transformation</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>算子（不少于</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>8</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>个），并简述功能（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'> 46</span></a></p>

<p class=MsoToc3><a href="#_Toc8752"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.8 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>请列举</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>action</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>算子（不少于</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>6</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>个），并简述功能（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......... 47</span></a></p>

<p class=MsoToc3><a href="#_Toc13194"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.9 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>请列举会引起</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Shuffle</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>过程的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Spark</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>算子，并简述功能。</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......................... 48</span></a></p>

<p class=MsoToc3><a href="#_Toc11628"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.10 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的两种核心</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Shuffle</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>（</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>HashShuffle</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>与</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>SortShuffle</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）的工作流程（包括未优化的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>HashShuffle</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>、优化的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>HashShuffle</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>、普通的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>SortShuffle</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>与</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>bypass</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>SortShuffle</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................... 48</span></a></p>

<p class=MsoToc3><a href="#_Toc745"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.11 Spark</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>常用算子</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>reduceByKey</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>与</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>groupByKey</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>的区别，哪一种更具优势？（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>     50</span></a></p>

<p class=MsoToc3><a href="#_Toc4661"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.12 Repartition</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>和</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Coalesce</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>关系与区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......................................................... 50</span></a></p>

<p class=MsoToc3><a href="#_Toc27003"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.13 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>分别简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>中的缓存机制（</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>cache</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>和</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>persist</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）与</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>checkpoint</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>机制，并指出两者的区别与联系</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>     51</span></a></p>

<p class=MsoToc3><a href="#_Toc30429"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.14 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>中共享变量（广播变量和累加器）的基本原理与用途。（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>      51</span></a></p>

<p class=MsoToc3><a href="#_Toc27912"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.15 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>当</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>涉及到数据库的操作时，如何减少</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Spark</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>运行中的数据库连接数？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>      51</span></a></p>

<p class=MsoToc3><a href="#_Toc26567"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.16 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>SparkSQL</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>中</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>RDD</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>、</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>DataFrame</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>、</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>DataSet</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>三者的区别与联系</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>? </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>（笔试重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>      51</span></a></p>

<p class=MsoToc3><a href="#_Toc30524"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.17 SparkSQL</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>中</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>join</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>操作与</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>left&nbsp;join</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>操作的区别？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>...................................... 52</span></a></p>

<p class=MsoToc3><a href="#_Toc17268"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.18 SparkStreaming</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>有哪几种方式消费</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Kafka</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>中的数据，它们之间的区别是什么？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>    53</span></a></p>

<p class=MsoToc3><a href="#_Toc16885"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.19 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>SparkStreaming</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>窗口函数的原理（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>...................................... 54</span></a></p>

<p class=MsoToc3><a href="#_Toc25642"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.20 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>请手写出</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>wordcount</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Spark</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>代码实现（</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Scala</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）（手写代码重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>....... 54</span></a></p>

<p class=MsoToc3><a href="#_Toc3795"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.21 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何使用</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Spark</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>实现</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>topN</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>的获取（描述思路或使用伪代码）（重点）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.. 55</span></a></p>

<p class=MsoToc3><a href="#_Toc23470"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4.10.22 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>京东：调优之前与调优之后性能的详细对比（例如调整</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>map</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>个数，</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>map</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>个数之前多少、之后多少，有什么提升）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>     55</span></a></p>

<p class=MsoToc1><a href="#_Toc19594"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>5</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>用户行为数据分析</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.............................................................................................. 56</span></a></p>

<p class=MsoToc2><a href="#_Toc31201"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数仓分层架构表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................ 56</span></a></p>

<p class=MsoToc2><a href="#_Toc8070"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>埋点行为数据基本格式</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>(</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>基本字段</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>)...................................................................... 56</span></a></p>

<p class=MsoToc2><a href="#_Toc23881"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目经验总结</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................... 58</span></a></p>

<p class=MsoToc3><a href="#_Toc12506"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.3.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目经验之元数据备份</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................ 58</span></a></p>

<p class=MsoToc3><a href="#_Toc1221"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.3.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>日期处理函数</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.......................................................................................... 58</span></a></p>

<p class=MsoToc3><a href="#_Toc32157"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.3.3 Union</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>与</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Union all</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................. 58</span></a></p>

<p class=MsoToc3><a href="#_Toc21501"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.3.4 Shell</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>中单引号和双引号区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................................... 58</span></a></p>

<p class=MsoToc2><a href="#_Toc29206"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.4 ods</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................................ 59</span></a></p>

<p class=MsoToc3><a href="#_Toc18517"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>）</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>ods_start_log </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>启动日志表</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................. 59</span></a></p>

<p class=MsoToc3><a href="#_Toc14185"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>）</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>ods_event_log </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>事件日志表（格式同启动日志表）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.......................................... 59</span></a></p>

<p class=MsoToc2><a href="#_Toc19047"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.5 dwd</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................................... 59</span></a></p>

<p class=MsoToc3><a href="#_Toc4013"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.5.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>自定义</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>UDF/UDTF</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>（项目中的应用）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>....................................................... 59</span></a></p>

<p class=MsoToc3><a href="#_Toc10317"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.5.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>事件日志基础明细表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................ 59</span></a></p>

<p class=MsoToc3><a href="#_Toc15237"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.5.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>商品点击表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 60</span></a></p>

<p class=MsoToc3><a href="#_Toc26438"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.5.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>其他的具体事件明细表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................ 60</span></a></p>

<p class=MsoToc2><a href="#_Toc32183"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求一：用户活跃主题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................................... 61</span></a></p>

<p class=MsoToc3><a href="#_Toc20346"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.6.1 DWS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层日活明细表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................. 61</span></a></p>

<p class=MsoToc3><a href="#_Toc13404"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.6.2 DWS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层周活明细表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................. 61</span></a></p>

<p class=MsoToc3><a href="#_Toc27369"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.6.3 DWS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层月活明细表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................. 62</span></a></p>

<p class=MsoToc3><a href="#_Toc31892"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.6.4 ADS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层日周月活跃设备数表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................... 62</span></a></p>

<p class=MsoToc2><a href="#_Toc14540"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求二：用户新增主题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................................... 63</span></a></p>

<p class=MsoToc3><a href="#_Toc15595"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.7.1 DWS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层日新增明细表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................... 63</span></a></p>

<p class=MsoToc3><a href="#_Toc8424"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.7.2 ADS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层每日新增设备数表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................................... 64</span></a></p>

<p class=MsoToc2><a href="#_Toc5072"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.8 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求三：用户留存主题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................................... 64</span></a></p>

<p class=MsoToc3><a href="#_Toc20141"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.8.1 DWS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层日留存明细表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................... 65</span></a></p>

<p class=MsoToc3><a href="#_Toc21193"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.8.2 ADS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层留存用户数表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................ 66</span></a></p>

<p class=MsoToc3><a href="#_Toc6675"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.8.3 ADS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层留存用户率表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................ 66</span></a></p>

<p class=MsoToc2><a href="#_Toc13386"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.9 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求四：沉默用户</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................. 67</span></a></p>

<p class=MsoToc2><a href="#_Toc5265"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.10 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求五：本周回流用户数</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................. 67</span></a></p>

<p class=MsoToc2><a href="#_Toc10596"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.11 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求六：流失用户数</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................ 68</span></a></p>

<p class=MsoToc2><a href="#_Toc17064"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.12 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求七：最近连续</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>3</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>周活跃用户数</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................... 68</span></a></p>

<p class=MsoToc2><a href="#_Toc17814"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.13 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求八：最近七天内连续三天活跃用户数</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................................ 69</span></a></p>

<p class=MsoToc2><a href="#_Toc3790"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求逻辑</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................................................................... 69</span></a></p>

<p class=MsoToc3><a href="#_Toc17037"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析用户活跃？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 69</span></a></p>

<p class=MsoToc3><a href="#_Toc10441"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析用户新增？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 69</span></a></p>

<p class=MsoToc3><a href="#_Toc8863"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析用户</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>1</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>天留存？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>....................................................................... 69</span></a></p>

<p class=MsoToc3><a href="#_Toc23727"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析沉默用户？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 69</span></a></p>

<p class=MsoToc3><a href="#_Toc28727"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析本周回流用户？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................... 69</span></a></p>

<p class=MsoToc3><a href="#_Toc1836"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析流失用户？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 69</span></a></p>

<p class=MsoToc3><a href="#_Toc18833"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析最近连续</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>3</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>周活跃用户数？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................... 70</span></a></p>

<p class=MsoToc3><a href="#_Toc14531"><span lang=EN-US style='color:windowtext;
text-decoration:none'>5.14.8 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何分析最近七天内连续三天活跃用户数？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................... 70</span></a></p>

<p class=MsoToc1><a href="#_Toc9083"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>6</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>业务交互数据分析</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.............................................................................................. 70</span></a></p>

<p class=MsoToc2><a href="#_Toc26645"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>电商常识</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 70</span></a></p>

<p class=MsoToc2><a href="#_Toc17142"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>电商业务流程</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................... 70</span></a></p>

<p class=MsoToc2><a href="#_Toc21371"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>业务表关键字段</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................................ 71</span></a></p>

<p class=MsoToc3><a href="#_Toc11488"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>订单表（</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>order_info</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................... 71</span></a></p>

<p class=MsoToc3><a href="#_Toc29825"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>用户表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................................... 71</span></a></p>

<p class=MsoToc3><a href="#_Toc1055"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>订单详情表（</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>order_detail</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>...................................................................... 71</span></a></p>

<p class=MsoToc3><a href="#_Toc15348"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>商品表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................................... 71</span></a></p>

<p class=MsoToc3><a href="#_Toc20954"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>商品一级分类表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................... 72</span></a></p>

<p class=MsoToc3><a href="#_Toc17316"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>商品二级分类表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................... 72</span></a></p>

<p class=MsoToc3><a href="#_Toc20677"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>商品三级分类表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................... 72</span></a></p>

<p class=MsoToc3><a href="#_Toc19218"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.3.8 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>支付流水表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 72</span></a></p>

<p class=MsoToc2><a href="#_Toc23440"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.4 MySql</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>中表的分类</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................. 73</span></a></p>

<p class=MsoToc2><a href="#_Toc16022"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>同步策略</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 74</span></a></p>

<p class=MsoToc2><a href="#_Toc24560"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>关系型数据库范式理论</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................................... 74</span></a></p>

<p class=MsoToc2><a href="#_Toc17614"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数据模型</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 75</span></a></p>

<p class=MsoToc2><a href="#_Toc738"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.8 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>业务数据数仓搭建</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................. 75</span></a></p>

<p class=MsoToc3><a href="#_Toc27722"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.8.1 ods</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................................... 75</span></a></p>

<p class=MsoToc3><a href="#_Toc18456"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.8.2 dwd</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................................................... 75</span></a></p>

<p class=MsoToc3><a href="#_Toc9169"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.8.3 dws</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................................................... 76</span></a></p>

<p class=MsoToc2><a href="#_Toc23979"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.9 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求一：</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>GMV</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>成交总额</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.................................................................................... 77</span></a></p>

<p class=MsoToc2><a href="#_Toc14783"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.10 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求二：转化率</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................... 77</span></a></p>

<p class=MsoToc3><a href="#_Toc30346"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.10.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>新增用户占日活跃用户比率表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................ 77</span></a></p>

<p class=MsoToc3><a href="#_Toc17217"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.10.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>用户行为转化率表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................. 78</span></a></p>

<p class=MsoToc2><a href="#_Toc12611"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.11 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>需求三：品牌复购率</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................ 78</span></a></p>

<p class=MsoToc3><a href="#_Toc4730"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.11.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>用户购买商品明细表（宽表）</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................ 78</span></a></p>

<p class=MsoToc3><a href="#_Toc13838"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.11.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>品牌复购率表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................................................... 79</span></a></p>

<p class=MsoToc2><a href="#_Toc23259"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.12 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目中有多少张宽表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................ 79</span></a></p>

<p class=MsoToc2><a href="#_Toc20041"><span lang=EN-US style='color:windowtext;
text-decoration:none'>6.13 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>拉链表</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................................. 80</span></a></p>

<p class=MsoToc1><a href="#_Toc23859"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>7</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>项目中遇到过哪些问题</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>....................................................................................... 81</span></a></p>

<p class=MsoToc2><a href="#_Toc2247"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.1 Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>宕机</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................................... 81</span></a></p>

<p class=MsoToc2><a href="#_Toc322"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.2 Flume</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>小文件</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................................... 81</span></a></p>

<p class=MsoToc2><a href="#_Toc22943"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.3 Kafka</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>挂掉</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................................................................... 81</span></a></p>

<p class=MsoToc2><a href="#_Toc12495"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.4 Kafka</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>消息数据积压，</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>消费能力不足怎么处理？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................ 81</span></a></p>

<p class=MsoToc2><a href="#_Toc22874"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.5 Kafka</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数据重复</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................................. 82</span></a></p>

<p class=MsoToc2><a href="#_Toc10390"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.6 Mysql</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>高可用</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>..................................................................................................... 82</span></a></p>

<p class=MsoToc2><a href="#_Toc9909"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>自定义</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>UDF</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>和</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>UDTF</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>解析和调试复杂字段</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................................ 82</span></a></p>

<p class=MsoToc2><a href="#_Toc21902"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.8 Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数据导出</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Parquet...................................................................................... 82</span></a></p>

<p class=MsoToc2><a href="#_Toc18259"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.9 Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数据导出控制</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................... 82</span></a></p>

<p class=MsoToc2><a href="#_Toc18761"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.10 Sqoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>数据导出一致性问题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................... 82</span></a></p>

<p class=MsoToc2><a href="#_Toc1803"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.11 SparkStreaming</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>优雅关闭</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................................... 83</span></a></p>

<p class=MsoToc2><a href="#_Toc26246"><span lang=EN-US style='color:windowtext;
text-decoration:none'>7.12 Spark OOM</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>、数据倾斜解决</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 83</span></a></p>

<p class=MsoToc1><a href="#_Toc4804"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>9</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>项目经验</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................................................ 83</span></a></p>

<p class=MsoToc2><a href="#_Toc12078"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>框架经验</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 83</span></a></p>

<p class=MsoToc3><a href="#_Toc13041"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.1.1 Hadoop..................................................................................................... 83</span></a></p>

<p class=MsoToc3><a href="#_Toc10064"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.1.2 Flume....................................................................................................... 84</span></a></p>

<p class=MsoToc3><a href="#_Toc27438"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.1.3 Kafka........................................................................................................ 84</span></a></p>

<p class=MsoToc3><a href="#_Toc7379"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.1.4 MySql</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>之元数据备份</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................. 85</span></a></p>

<p class=MsoToc3><a href="#_Toc12178"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.1.5 Sqoop</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>参数</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................... 85</span></a></p>

<p class=MsoToc3><a href="#_Toc25089"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.1.6 Azkaban</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>每天执行多少个任务</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................... 85</span></a></p>

<p class=MsoToc2><a href="#_Toc9637"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>业务经验</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 85</span></a></p>

<p class=MsoToc3><a href="#_Toc14609"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.1 ODS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层采用什么压缩方式和存储格式？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................... 85</span></a></p>

<p class=MsoToc3><a href="#_Toc22064"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.2 DWD</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层做了哪些事？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 85</span></a></p>

<p class=MsoToc3><a href="#_Toc24923"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.3 DWS</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>层做了哪些事？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................... 86</span></a></p>

<p class=MsoToc3><a href="#_Toc7728"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>分析过哪些指标（一分钟至少说出</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>30</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>个指标）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>....................................... 87</span></a></p>

<p class=MsoToc3><a href="#_Toc31457"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>分析过最难的两个指标，现场手写</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................... 91</span></a></p>

<p class=MsoToc3><a href="#_Toc24753"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数据仓库每天跑多少张表，大概什么时候运行，运行多久？</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.................... 92</span></a></p>

<p class=MsoToc3><a href="#_Toc23365"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.7 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数仓中使用的哪种文件存储格式</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................. 92</span></a></p>

<p class=MsoToc3><a href="#_Toc18543"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.8 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数仓中用到过哪些</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Shell</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>脚本及具体功能</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.................................................. 92</span></a></p>

<p class=MsoToc3><a href="#_Toc1905"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.9 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目中用过的报表工具</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................ 92</span></a></p>

<p class=MsoToc3><a href="#_Toc8027"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.10 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>测试相关</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................... 92</span></a></p>

<p class=MsoToc3><a href="#_Toc24441"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.11 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目实际工作流程</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.................................................................................. 93</span></a></p>

<p class=MsoToc3><a href="#_Toc13184"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.12 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目中实现一个需求大概多长时间</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>......................................................... 93</span></a></p>

<p class=MsoToc3><a href="#_Toc13944"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.13 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目在</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>3</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>年内迭代次数，每一个项目具体是如何迭代的。</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>...................... 93</span></a></p>

<p class=MsoToc3><a href="#_Toc15324"><span lang=EN-US style='color:windowtext;
text-decoration:none'>9.2.14 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>项目开发中每天做什么事</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................... 93</span></a></p>

<p class=MsoToc1><a href="#_Toc7805"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>10</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=EN-US style='color:windowtext;text-decoration:none'>JavaSE</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>（答案精简）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......................................................................................... 94</span></a></p>

<p class=MsoToc2><a href="#_Toc1314"><span lang=EN-US style='color:windowtext;
text-decoration:none'>10.1 hashMap</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>底层源码，数据结构</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................... 94</span></a></p>

<p class=MsoToc2><a href="#_Toc12486"><span lang=EN-US style='color:windowtext;
text-decoration:none'>10.2 Java</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>自带有哪几种线程池？</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................. 96</span></a></p>

<p class=MsoToc2><a href="#_Toc11661"><span lang=EN-US style='color:windowtext;
text-decoration:none'>10.3 HashMap</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>和</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>HashTable</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.............................................................................. 97</span></a></p>

<p class=MsoToc3><a href="#_Toc7380"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1) </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>线程安全性不同</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................... 97</span></a></p>

<p class=MsoToc3><a href="#_Toc12315"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2) </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>是否提供</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>contains</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>方法</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................................. 97</span></a></p>

<p class=MsoToc3><a href="#_Toc23839"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3) key</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>和</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>value</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>是否允许</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>null</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>值</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......................................................................... 97</span></a></p>

<p class=MsoToc3><a href="#_Toc17143"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4) </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数组初始化和扩容机制</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>................................................................................ 98</span></a></p>

<p class=MsoToc2><a href="#_Toc9845"><span lang=EN-US style='color:windowtext;
text-decoration:none'>10.4 TreeSet</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>和</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>HashSet</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................................................... 98</span></a></p>

<p class=MsoToc2><a href="#_Toc27096"><span lang=EN-US style='color:windowtext;
text-decoration:none'>10.5 String buffer</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>和</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>String build</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................................................ 98</span></a></p>

<p class=MsoToc2><a href="#_Toc3913"><span lang=EN-US style='color:windowtext;
text-decoration:none'>10.6 Final</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>、</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Finally</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>、</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Finalize..................................................................................... 98</span></a></p>

<p class=MsoToc2><a href="#_Toc25751"><span lang=EN-US style='color:windowtext;
text-decoration:none'>10.7 ==</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>和</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Equals</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.............................................................................................. 99</span></a></p>

<p class=MsoToc1><a href="#_Toc5756"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>11</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Redis</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>（答案精简）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................................................................... 99</span></a></p>

<p class=MsoToc2><a href="#_Toc9044"><span lang=EN-US style='color:windowtext;
text-decoration:none'>11.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>缓存穿透、缓存雪崩、缓存击穿</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>...................................................................... 99</span></a></p>

<p class=MsoToc2><a href="#_Toc11620"><span lang=EN-US style='color:windowtext;
text-decoration:none'>11.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>哨兵模式</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................ 100</span></a></p>

<p class=MsoToc2><a href="#_Toc29918"><span lang=EN-US style='color:windowtext;
text-decoration:none'>11.3 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>数据类型</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................ 100</span></a></p>

<p class=MsoToc2><a href="#_Toc18208"><span lang=EN-US style='color:windowtext;
text-decoration:none'>11.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>持久化</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 100</span></a></p>

<p class=MsoToc2><a href="#_Toc2363"><span lang=EN-US style='color:windowtext;
text-decoration:none'>11.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>悲观锁</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 101</span></a></p>

<p class=MsoToc2><a href="#_Toc16250"><span lang=EN-US style='color:windowtext;
text-decoration:none'>11.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>乐观锁</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 101</span></a></p>

<p class=MsoToc1><a href="#_Toc29052"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>12</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=EN-US style='color:windowtext;text-decoration:none'>MySql............................................................................................................. 101</span></a></p>

<p class=MsoToc2><a href="#_Toc15845"><span lang=EN-US style='color:windowtext;
text-decoration:none'>12.1 MyISAM</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>与</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>InnoDB</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................. 101</span></a></p>

<p class=MsoToc2><a href="#_Toc20302"><span lang=EN-US style='color:windowtext;
text-decoration:none'>12.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>索引</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>.............................................................................................................. 101</span></a></p>

<p class=MsoToc2><a href="#_Toc7511"><span lang=EN-US style='color:windowtext;
text-decoration:none'>12.3 b-tree</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>和</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>b+tree</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>的区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................................................... 102</span></a></p>

<p class=MsoToc2><a href="#_Toc14814"><span lang=EN-US style='color:windowtext;
text-decoration:none'>12.4 redis</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>是单线程的，为什么那么快</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................................... 102</span></a></p>

<p class=MsoToc2><a href="#_Toc26642"><span lang=EN-US style='color:windowtext;
text-decoration:none'>12.5 MySQL</span><span lang=ZH-CN style='font-family:
SimSun;color:windowtext;text-decoration:none'>的事务</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>............................................................................................... 102</span></a></p>

<p class=MsoToc3><a href="#_Toc19209"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>一、事务的基本要素（</span><span lang=EN-US
style='font-family:SimSun;color:windowtext;text-decoration:none'>ACID</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>......................................................................... 102</span></a></p>

<p class=MsoToc3><a href="#_Toc11931"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>二、事务的并发问题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................... 103</span></a></p>

<p class=MsoToc3><a href="#_Toc7925"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>三、</span><span lang=EN-US
style='font-family:SimSun;color:windowtext;text-decoration:none'>MySQL</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>事务隔离级别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>................................................................................. 103</span></a></p>

<p class=MsoToc2><a href="#_Toc31590"><span lang=EN-US style='color:windowtext;
text-decoration:none'>12.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>常见面试</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>sql.................................................................................................. 103</span></a></p>

<p class=MsoToc1><a href="#_Toc8579"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>13</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=EN-US style='color:windowtext;text-decoration:none'>JVM............................................................................................................... 108</span></a></p>

<p class=MsoToc2><a href="#_Toc28941"><span lang=EN-US style='color:windowtext;
text-decoration:none'>13.1 JVM</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>内存分哪几个区，每个区的作用是什么</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>?................................................. 108</span></a></p>

<p class=MsoToc2><a href="#_Toc8250"><span lang=EN-US style='color:windowtext;
text-decoration:none'>13.2 Java</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>类加载过程</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>?............................................................................................ 109</span></a></p>

<p class=MsoToc3><a href="#_Toc20231"><span lang=EN-US style='color:windowtext;
text-decoration:none'>1) </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>加载</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 109</span></a></p>

<p class=MsoToc3><a href="#_Toc3223"><span lang=EN-US style='color:windowtext;
text-decoration:none'>2) </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>验证</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 109</span></a></p>

<p class=MsoToc3><a href="#_Toc14642"><span lang=EN-US style='color:windowtext;
text-decoration:none'>3) </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>解析</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 110</span></a></p>

<p class=MsoToc3><a href="#_Toc31215"><span lang=EN-US style='color:windowtext;
text-decoration:none'>4) </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>初始化</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>....................................................................................................... 110</span></a></p>

<p class=MsoToc2><a href="#_Toc16571"><span lang=EN-US style='color:windowtext;
text-decoration:none'>13.3 java</span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>中垃圾收集的方法有哪些</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>?........................................................................ 110</span></a></p>

<p class=MsoToc2><a href="#_Toc31553"><span lang=EN-US style='color:windowtext;
text-decoration:none'>13.4 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>如何判断一个对象是否存活</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>?(</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>或者</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>GC</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>对象的判定方法</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>)................................. 110</span></a></p>

<p class=MsoToc2><a href="#_Toc24863"><span lang=EN-US style='color:windowtext;
text-decoration:none'>13.5 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>什么是类加载器，类加载器有哪些</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>?............................................................... 111</span></a></p>

<p class=MsoToc2><a href="#_Toc26791"><span lang=EN-US style='color:windowtext;
text-decoration:none'>13.6 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>简述</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>Java</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>内存分配与回收策略以及</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Minor GC</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>和</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>Major GC</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>（</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>full GC</span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>）</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........... 111</span></a></p>

<p class=MsoToc1><a href="#_Toc31322"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>14</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=EN-US style='color:windowtext;text-decoration:none'>JUC................................................................................................................ 112</span></a></p>

<p class=MsoToc2><a href="#_Toc4426"><span lang=EN-US style='line-height:125%;
color:windowtext;text-decoration:none'>14.1 Synchronized</span><span
lang=ZH-CN style='line-height:125%;font-family:SimHei;color:windowtext;
text-decoration:none'>与</span><span lang=EN-US style='line-height:125%;
color:windowtext;text-decoration:none'>Lock</span><span lang=ZH-CN
style='line-height:125%;font-family:SimHei;color:windowtext;text-decoration:
none'>的区别</span><span lang=EN-US style='color:windowtext;text-decoration:none'>........................................................................... 112</span></a></p>

<p class=MsoToc2><a href="#_Toc22923"><span lang=EN-US style='line-height:125%;
color:windowtext;text-decoration:none'>14.2 Runnable</span><span lang=ZH-CN
style='line-height:125%;font-family:SimHei;color:windowtext;text-decoration:
none'>和</span><span lang=EN-US style='line-height:125%;color:windowtext;
text-decoration:none'>Callable</span><span lang=ZH-CN style='line-height:125%;
font-family:SimHei;color:windowtext;text-decoration:none'>的区别</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>............................................................................. 112</span></a></p>

<p class=MsoToc2><a href="#_Toc17928"><span lang=EN-US style='line-height:125%;
color:windowtext;text-decoration:none'>14.3 </span><span lang=ZH-CN
style='line-height:125%;font-family:SimHei;color:windowtext;text-decoration:
none'>什么是分布式锁</span><span lang=EN-US style='color:windowtext;text-decoration:
none'>............................................................................................. 112</span></a></p>

<p class=MsoToc2><a href="#_Toc11140"><span lang=EN-US style='line-height:125%;
color:windowtext;text-decoration:none'>14.4 </span><span lang=ZH-CN
style='line-height:125%;font-family:SimHei;color:windowtext;text-decoration:
none'>什么是分布式事务</span><span lang=EN-US style='color:windowtext;text-decoration:
none'>......................................................................................... 112</span></a></p>

<p class=MsoToc1><a href="#_Toc18984"><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>第</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>15</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>章</span><span
lang=ZH-CN style='color:windowtext;text-decoration:none'> </span><span
lang=ZH-CN style='font-family:SimSun;color:windowtext;text-decoration:none'>模拟考试</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>........................................................................................................ 112</span></a></p>

<p class=MsoToc2><a href="#_Toc20776"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.1 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>选择题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 112</span></a></p>

<p class=MsoToc3><a href="#_Toc25296"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.1.1&nbsp;&nbsp;HDFS................................................................................................... 112</span></a></p>

<p class=MsoToc3><a href="#_Toc2959"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.1.2&nbsp;&nbsp;</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>集群管理</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.............................................................................................. 113</span></a></p>

<p class=MsoToc3><a href="#_Toc17184"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.1.3&nbsp;&nbsp;Zookeeper</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>基础</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>..................................................................................... 114</span></a></p>

<p class=MsoToc2><a href="#_Toc26164"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.2 </span><span lang=ZH-CN style='font-family:SimSun;
color:windowtext;text-decoration:none'>判断题</span><span lang=EN-US
style='color:windowtext;text-decoration:none'>........................................................................................................... 114</span></a></p>

<p class=MsoToc3><a href="#_Toc16918"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.2.1&nbsp;&nbsp;</span><span lang=ZH-CN
style='font-family:SimSun;color:windowtext;text-decoration:none'>集群管理</span><span
lang=EN-US style='color:windowtext;text-decoration:none'>.............................................................................................. 114</span></a></p>

<p class=MsoToc3><a href="#_Toc14275"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.2.2&nbsp;&nbsp;HDFS................................................................................................... 115</span></a></p>

<p class=MsoToc3><a href="#_Toc28845"><span lang=EN-US style='color:windowtext;
text-decoration:none'>14.2.3&nbsp;&nbsp;MapReduce........................................................................................... 115</span></a></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h1><a name="_Toc27466"><span lang=ZH-CN style='font-family:SimSun'>第</span><span
lang=EN-US>1</span></a><span lang=ZH-CN style='font-family:SimSun'>章</span><span
lang=ZH-CN> </span><span lang=ZH-CN style='font-family:SimSun'>面试说明</span></h1>

<h2><a name="_Toc10725138"></a><a name="_Toc21380"><span lang=EN-US>1.1 </span></a><span
lang=ZH-CN style='font-family:SimHei'>面试过程最关键的是什么？</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）不是你说了什么，而是你怎么说</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）大大方方的聊，放松</span></p>

<h2><a name="_Toc10725139"></a><a name="_Toc20949"><span lang=EN-US>1.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>面试时该怎么说？</span></h2>

<p class=MsoNormal style='line-height:150%'><a name="_Toc26133"><span
lang=EN-US style='color:black'>1</span></a><span lang=ZH-CN style='font-family:
SimSun;color:black'>）语言表达清楚</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）思维逻辑清晰，表达流畅</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）一二三层次表达</span></p>

<p class=MsoNormal style='line-height:150%'><a name="_Toc7982"><span
lang=EN-US style='color:black'>2</span></a><span lang=ZH-CN style='font-family:
SimSun;color:black'>）所述内容不犯错</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）不说前东家或者自己的坏话</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）往自己擅长的方面说</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）实质，对考官来说，内容听过，就是自我肯定；没听过，那就是个学习的过程。</span></p>

<h2><a name="_Toc26632"></a><a name="_Toc10725140"><span lang=EN-US>1.3 </span></a><span
lang=ZH-CN style='font-family:SimHei'>面试技巧</span></h2>

<h3><a name="_Toc28673"></a><a name="_Toc10725141"><span lang=EN-US>1.3.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>六个常见问题</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）你的优点是什么？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>大胆的说出自己各个方面的优势和特长</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）你的缺点是什么？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>不要谈自己真实问题；用</span><span
lang=EN-US style='color:black'>“</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>缺点</span><span lang=EN-US style='color:black'>”</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>衬托自己的优点</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）你的离职原因是什么？</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>不说前东家坏话，哪怕被伤过</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>合情合理合法</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>不要说超过</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>个以上的原因</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）您对薪资的期望是多少？</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>非终面不深谈薪资</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>只说区间，不说具体数字</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>底线是不低于当前薪资</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>非要具体数字，区间取中间值，或者当前薪资的</span><span
lang=EN-US style='color:black'>+20%</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）您还有什么想问的问题？</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>这是体现个人眼界和层次的问题</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>问题本身不在于面试官想得到什么样的答案，而在于你跟别的应聘者的对比</span></p>

<p class=MsoListParagraph style='margin-left:42.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>标准答案：</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>公司希望我入职后的</span><span
lang=EN-US style='color:black'>3-6</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个月内，给公司解决什么样的问题</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>公司（或者对这个部门）未来的战略规划是什么样子的？</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>以你现在对我的了解，您觉得我需要多长时间融入公司？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>6</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）您最快多长时间能入职？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>一周左右，如果公司需要，可以适当提前</span></p>

<h3><a name="_Toc13232"></a><a name="_Toc10725142"><span lang=EN-US>1.3.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>两个注意事项</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）职业化的语言</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）职业化的形象</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h3><a name="_Toc3137"></a><a name="_Toc10725143"><span lang=EN-US>1.3.3 </span></a><span
lang=ZH-CN style='font-family:SimSun'>自我介绍（控制在</span><span lang=EN-US>4</span><span
lang=ZH-CN style='font-family:SimSun'>分半以内，不超过</span><span lang=EN-US>5</span><span
lang=ZH-CN style='font-family:SimSun'>分钟）</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）个人基本信息</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）工作履历</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>时间、公司名称、任职岗位、主要工作内容、工作业绩、离职原因</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）深度沟通（也叫压力面试）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>刨根问底下沉式追问（注意是下沉式，而不是发散式的）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>基本技巧：往自己熟悉的方向说</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h1><a name="_Toc10725144"></a><a name="_Toc13409"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>2</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=ZH-CN style='font-family:SimSun'>手写代码</span></h1>

<h2><a name="_Toc10725145"></a><a name="_Toc10725148"></a><a name="_Toc4219"><span
lang=EN-US>2.1 </span></a><span lang=ZH-CN style='font-family:SimHei'>冒泡排序</span></h2>

<p class=a0><span lang=EN-US>/**</span></p>

<p class=a0><span lang=EN-US> * </span><span lang=ZH-CN style='font-family:
SimSun'>冒泡排序</span><span lang=ZH-CN> </span><span lang=ZH-CN style='font-family:
SimSun'>时间复杂度</span><span lang=ZH-CN> </span><span lang=EN-US>O(n^2) </span><span
lang=ZH-CN style='font-family:SimSun'>空间复杂度</span><span lang=EN-US>O(1)</span></p>

<p class=a0><span lang=EN-US> */</span></p>

<p class=a0><span lang=EN-US>public class BubbleSort {</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>   public static void bubbleSort(int[] data) {</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>      System.out.println(&quot;</span><span
lang=ZH-CN style='font-family:SimSun'>开始排序</span><span lang=EN-US>&quot;);</span></p>

<p class=a0><span lang=EN-US>      int arrayLength = data.length;</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>      for (int i = 0; i &lt; arrayLength - 1; i++)
{</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>         boolean flag = false;</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>         for (int j = 0; j &lt; arrayLength - 1 -
i; j++) {</span></p>

<p class=a0><span lang=EN-US>            if(data[j] &gt; data[j + 1]){</span></p>

<p class=a0><span lang=EN-US>               int temp = data[j + 1];</span></p>

<p class=a0><span lang=EN-US>               data[j + 1] = data[j];</span></p>

<p class=a0><span lang=EN-US>               data[j] = temp;</span></p>

<p class=a0><span lang=EN-US>               flag = true;</span></p>

<p class=a0><span lang=EN-US>            }</span></p>

<p class=a0><span lang=EN-US>         }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>        
System.out.println(java.util.Arrays.toString(data));</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>         if (!flag)</span></p>

<p class=a0><span lang=EN-US>            break;</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>   }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>   public static void main(String[] args) {</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>      int[] data = { 9, -16, 21, 23, -30, -49, 21,
30, 30 };</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>      System.out.println(&quot;</span><span
lang=ZH-CN style='font-family:SimSun'>排序之前：</span><span lang=EN-US>\n&quot; +
java.util.Arrays.toString(data));</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>      bubbleSort(data);</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>      System.out.println(&quot;</span><span
lang=ZH-CN style='font-family:SimSun'>排序之后：</span><span lang=EN-US>\n&quot; +
java.util.Arrays.toString(data));</span></p>

<p class=a0><span lang=EN-US>   }</span></p>

<p class=a0><span lang=EN-US>}</span></p>

<h2><a name="_Toc10725149"></a><a name="_Toc238"><span lang=EN-US>2.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>二分查找</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=394 height=223 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image001.jpg"></span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=ZH-CN
style='font-size:9.0pt;line-height:125%;font-family:SimSun;color:black'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:125%;color:black'>4-</span><span
lang=ZH-CN style='font-size:9.0pt;line-height:125%;font-family:SimSun;
color:black'>二分查找核心思路</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>实现代码：</span></p>

<p class=a0><span lang=EN-US>/**</span></p>

<p class=a0><span lang=EN-US> * </span><span lang=ZH-CN style='font-family:
SimSun'>二分查找</span><span lang=ZH-CN> </span><span lang=ZH-CN style='font-family:
SimSun'>时间复杂度</span><span lang=EN-US>O(log2n);</span><span lang=ZH-CN
style='font-family:SimSun'>空间复杂度</span><span lang=EN-US>O(1)</span></p>

<p class=a0><span lang=EN-US> */</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>def
binarySearch(arr:Array[Int],left:Int,right:Int,findVal:Int): Int={<br>
  if(left&gt;right){//</span><span lang=ZH-CN style='font-family:SimSun'>递归退出条件，找不到，返回</span><span
lang=EN-US>-1<br>
    -1<br>
  }<br>
<br>
  val midIndex = (left+right)/2<br>
<br>
  if (findVal &lt; arr(midIndex)){//</span><span lang=ZH-CN style='font-family:
SimSun'>向左递归查找</span><span lang=EN-US><br>
    binarySearch(arr,left,midIndex,findVal)<br>
  }else if(findVal &gt; arr(midIndex)){//</span><span lang=ZH-CN
style='font-family:SimSun'>向右递归查找</span><span lang=EN-US><br>
    binarySearch(arr,midIndex,right,findVal)<br>
  }else{//</span><span lang=ZH-CN style='font-family:SimSun'>查找到，返回下标</span><span
lang=EN-US><br>
    midIndex<br>
  }<br>
}</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>拓展需求：当一个有序数组中，有多个相同的数值时，如何将所有的数值都查找到。</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>代码实现如下：</span></p>

<p class=a0><span lang=EN-US>/*</span></p>

<p class=a0><span lang=EN-US>  {1,8, 10, 89, 1000, 1000</span><span lang=ZH-CN
style='font-family:SimSun'>，</span><span lang=EN-US>1234} </span><span
lang=ZH-CN style='font-family:SimSun'>当一个有序数组中，有多个相同的数值时，如何将所有的数值都查找到，比如这里的</span><span
lang=EN-US> 1000.</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>分析</span></p>

<p class=a0><span lang=EN-US>  1. </span><span lang=ZH-CN style='font-family:
SimSun'>返回的结果是一个可变数组</span><span lang=EN-US> ArrayBuffer</span></p>

<p class=a0><span lang=EN-US>  2. </span><span lang=ZH-CN style='font-family:
SimSun'>在找到结果时，向左边扫描，向右边扫描</span><span lang=EN-US> [</span><span lang=ZH-CN
style='font-family:SimSun'>条件</span><span lang=EN-US>]</span></p>

<p class=a0><span lang=EN-US>  3. </span><span lang=ZH-CN style='font-family:
SimSun'>找到结果后，就加入到</span><span lang=EN-US>ArrayBuffer</span></p>

<p class=a0><span lang=EN-US>   */</span></p>

<p class=a0><span lang=EN-US>  def binarySearch2(arr: Array[Int], l: Int, r:
Int,</span></p>

<p class=a0><span lang=EN-US>                    findVal: Int):
ArrayBuffer[Int] = {</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>找不到条件</span><span lang=EN-US>?</span></p>

<p class=a0><span lang=EN-US>    if (l &gt; r) {</span></p>

<p class=a0><span lang=EN-US>      return ArrayBuffer()</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    val midIndex = (l + r) / 2</span></p>

<p class=a0><span lang=EN-US>    val midVal = arr(midIndex)</span></p>

<p class=a0><span lang=EN-US>    if (midVal &gt; findVal) {</span></p>

<p class=a0><span lang=EN-US>      //</span><span lang=ZH-CN style='font-family:
SimSun'>向左进行递归查找</span></p>

<p class=a0><span lang=EN-US>      binarySearch2(arr, l, midIndex - 1, findVal)</span></p>

<p class=a0><span lang=EN-US>    } else if (midVal &lt; findVal) { //</span><span
lang=ZH-CN style='font-family:SimSun'>向右进行递归查找</span></p>

<p class=a0><span lang=EN-US>      binarySearch2(arr, midIndex + 1, r, findVal)</span></p>

<p class=a0><span lang=EN-US>    } else {</span></p>

<p class=a0><span lang=EN-US>      println(&quot;midIndex=&quot; + midIndex)</span></p>

<p class=a0><span lang=EN-US>      //</span><span lang=ZH-CN style='font-family:
SimSun'>定义一个可变数组</span></p>

<p class=a0><span lang=EN-US>      val resArr = ArrayBuffer[Int]()</span></p>

<p class=a0><span lang=EN-US>      //</span><span lang=ZH-CN style='font-family:
SimSun'>向左边扫描</span></p>

<p class=a0><span lang=EN-US>      var temp = midIndex - 1</span></p>

<p class=a0><span lang=EN-US>      breakable {</span></p>

<p class=a0><span lang=EN-US>        while (true) {</span></p>

<p class=a0><span lang=EN-US>          if (temp &lt; 0 || arr(temp) != findVal)
{</span></p>

<p class=a0><span lang=EN-US>            break()</span></p>

<p class=a0><span lang=EN-US>          }</span></p>

<p class=a0><span lang=EN-US>          if (arr(temp) == findVal) {</span></p>

<p class=a0><span lang=EN-US>            resArr.append(temp)</span></p>

<p class=a0><span lang=EN-US>          }</span></p>

<p class=a0><span lang=EN-US>          temp -= 1</span></p>

<p class=a0><span lang=EN-US>        }</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>      //</span><span lang=ZH-CN style='font-family:
SimSun'>将中间这个索引加入</span></p>

<p class=a0><span lang=EN-US>      resArr.append(midIndex)</span></p>

<p class=a0><span lang=EN-US>      //</span><span lang=ZH-CN style='font-family:
SimSun'>向右边扫描</span></p>

<p class=a0><span lang=EN-US>      temp = midIndex + 1</span></p>

<p class=a0><span lang=EN-US>      breakable {</span></p>

<p class=a0><span lang=EN-US>        while (true) {</span></p>

<p class=a0><span lang=EN-US>          if (temp &gt; arr.length - 1 ||
arr(temp) != findVal) {</span></p>

<p class=a0><span lang=EN-US>            break()</span></p>

<p class=a0><span lang=EN-US>          }</span></p>

<p class=a0><span lang=EN-US>          if (arr(temp) == findVal) {</span></p>

<p class=a0><span lang=EN-US>            resArr.append(temp)</span></p>

<p class=a0><span lang=EN-US>          }</span></p>

<p class=a0><span lang=EN-US>          temp += 1</span></p>

<p class=a0><span lang=EN-US>        }</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>      return resArr</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<h2 style='margin-left:18.75pt'><a name="_Toc23238"><span lang=EN-US>2.3 </span></a><span
lang=ZH-CN style='font-family:SimHei'>快排</span></h2>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-US
style='color:black'><img border=0 width=416 height=236
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image002.jpg"></span><span lang=ZH-CN style='font-size:
9.0pt;line-height:125%;font-family:SimSun;color:black'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:125%;color:black'>1-</span><span
lang=ZH-CN style='font-size:9.0pt;line-height:125%;font-family:SimSun;
color:black'>快速排序核心思想</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;color:black'>代码实现：</span></p>

<p class=a0><span lang=EN-US>/**</span></p>

<p class=a0><span lang=EN-US> * </span><span lang=ZH-CN style='font-family:
SimSun'>快排</span><span lang=ZH-CN> </span></p>

<p class=a0 style='margin-left:10.5pt;text-indent:-10.5pt'><span lang=EN-US> * </span><span
lang=ZH-CN style='font-family:SimSun'>时间复杂度</span><span lang=EN-US>:</span><span
lang=ZH-CN style='font-family:SimSun'>平均时间复杂度为</span><span lang=EN-US>O(nlogn)</span></p>

<p class=a0><span lang=EN-US> * </span><span lang=ZH-CN style='font-family:
SimSun'>空间复杂度</span><span lang=EN-US>:O(logn)</span><span lang=ZH-CN
style='font-family:SimSun'>，因为递归栈空间的使用问题</span></p>

<p class=a0><span lang=EN-US> */</span></p>

<p class=a0><span lang=EN-US>def quickSort(list: List[Int]): List[Int] = list
match {</span></p>

<p class=a0><span lang=EN-US>    case Nil =&gt; Nil</span></p>

<p class=a0><span lang=EN-US>    case List() =&gt; List()</span></p>

<p class=a0><span lang=EN-US>    case head :: tail =&gt;</span></p>

<p class=a0><span lang=EN-US>      val (left, right) = tail.partition(_ &lt;
head)</span></p>

<p class=a0><span lang=EN-US>      quickSort(left) ::: head :: quickSort(right)</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<h2 style='margin-left:36.75pt;text-indent:-18.0pt'><a name="_Toc10725146"><span
lang=EN-US>2.4<span style='font:7.0pt "Times New Roman"'> </span></span><span
lang=EN-US> </span></a><a name="_Toc24409"><span lang=ZH-CN style='font-family:
SimHei'>归并</span></a></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=416 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image003.jpg"></span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=ZH-CN
style='font-size:9.0pt;line-height:125%;font-family:SimSun;color:black'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:125%;color:black'>2-</span><span
lang=ZH-CN style='font-size:9.0pt;line-height:125%;font-family:SimSun;
color:black'>归并排序核心思想</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>核心思想：不断的将大的数组分成两个小数组，直到不能拆分为止，即形成了单个值。此时使用合并的排序思想对已经有序的数组进行合并，合并为一个大的数据，不断重复此过程，直到最终所有数据合并到一个数组为止。</span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=EN-US
style='color:black'><img border=0 width=395 height=220
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image004.jpg"></span></p>

<p class=MsoNormal align=center style='text-align:center'><span lang=ZH-CN
style='font-size:9.0pt;line-height:125%;font-family:SimSun;color:black'>图</span><span
lang=EN-US style='font-size:9.0pt;line-height:125%;color:black'>3-</span><span
lang=ZH-CN style='font-size:9.0pt;line-height:125%;font-family:SimSun;
color:black'>归并排序“治”流程</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;color:black'>代码实现：</span></p>

<p class=a0><span lang=EN-US>/**</span></p>

<p class=a0><span lang=EN-US> * </span><span lang=ZH-CN style='font-family:
SimSun'>快排</span><span lang=ZH-CN> </span></p>

<p class=a0 style='margin-left:10.5pt;text-indent:-10.5pt'><span lang=EN-US> * </span><span
lang=ZH-CN style='font-family:SimSun'>时间复杂度</span><span lang=EN-US>:O(nlogn)</span></p>

<p class=a0><span lang=EN-US> * </span><span lang=ZH-CN style='font-family:
SimSun'>空间复杂度</span><span lang=EN-US>:O(n)</span></p>

<p class=a0><span lang=EN-US> */</span></p>

<p class=a0><span lang=EN-US>def merge(left: List[Int], right: List[Int]): List[Int]
= (left, right) match {</span></p>

<p class=a0><span lang=EN-US>    case (Nil, _) =&gt; right</span></p>

<p class=a0><span lang=EN-US>    case (_, Nil) =&gt; left</span></p>

<p class=a0><span lang=EN-US>    case (x :: xTail, y :: yTail) =&gt;</span></p>

<p class=a0><span lang=EN-US>      if (x &lt;= y) x :: merge(xTail, right)</span></p>

<p class=a0><span lang=EN-US>      else y :: merge(left, yTail)</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US> </span></p>

<h2><a name="_Toc10725147"></a><a name="_Toc10725150"></a><a name="_Toc8251"><span
lang=EN-US>2.5  </span></a><span lang=ZH-CN style='font-family:SimHei'>二叉树之</span><span
lang=EN-US>Scala</span><span lang=ZH-CN style='font-family:SimHei'>实现</span></h2>

<h3><a name="_Toc8950"></a><a name="_Toc10725151"><span lang=EN-US>2.5.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>二叉树概念</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=399 height=225 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image005.jpg"></span></p>

<h3><a name="_Toc10725152"></a><a name="_Toc30484"><span lang=EN-US>2.5.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>二叉树的特点</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）树执行查找、删除、插入的时间复杂度都是</span><span lang=EN-US
style='color:black'>O(logN)</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）遍历二叉树的方法包括前序、中序、后序</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）非平衡树指的是根的左右两边的子节点的数量不一致</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>4</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>在非空二叉树中，第</span><span
lang=EN-US style='color:black'>i</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>层的结点总数不超过</span><span lang=EN-US style='color:black'> ,
i&gt;=1</span><span lang=ZH-CN style='font-family:SimSun;color:black'>；</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）深度为</span><span lang=EN-US style='color:black'>h</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的二叉树最多有个结点</span><span
lang=EN-US style='color:black'>(h&gt;=1)</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，最少有</span><span lang=EN-US
style='color:black'>h</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>个结点；</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>6</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）对于任意一棵二叉树，如果其叶结点数为</span><span lang=EN-US
style='color:black'>N0</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，而度数为</span><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的结点总数为</span><span
lang=EN-US style='color:black'>N2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，则</span><span lang=EN-US style='color:black'>N0=N2+1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>；</span></p>

<h3><a name="_Toc8318"></a><a name="_Toc10725153"><span lang=EN-US>2.5.3 </span></a><span
lang=ZH-CN style='font-family:SimSun'>二叉树的</span><span lang=EN-US>Scala</span><span
lang=ZH-CN style='font-family:SimSun'>代码实现</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>定义节点以及前序、中序、后序遍历</span></p>

<p class=a0><span lang=EN-US>class TreeNode(treeNo:Int){</span></p>

<p class=a0><span lang=EN-US>  val no = treeNo</span></p>

<p class=a0><span lang=EN-US>  var left:TreeNode = null</span></p>

<p class=a0><span lang=EN-US>  var right:TreeNode = null</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>后序遍历</span></p>

<p class=a0><span lang=EN-US>  def postOrder():Unit={</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向左递归输出左子树</span></p>

<p class=a0><span lang=EN-US>    if(this.left != null){</span></p>

<p class=a0><span lang=EN-US>      this.left.postOrder</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向右递归输出右子树</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null) {</span></p>

<p class=a0><span lang=EN-US>      this.right.postOrder</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>输出当前节点值</span></p>

<p class=a0><span lang=EN-US>    printf(&quot;</span><span lang=ZH-CN
style='font-family:SimSun'>节点信息</span><span lang=EN-US> no=%d \n&quot;,no)</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>中序遍历</span></p>

<p class=a0><span lang=EN-US>  def infixOrder():Unit={</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向左递归输出左子树</span></p>

<p class=a0><span lang=EN-US>    if(this.left != null){</span></p>

<p class=a0><span lang=EN-US>      this.left.infixOrder()</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>输出当前节点值</span></p>

<p class=a0><span lang=EN-US>    printf(&quot;</span><span lang=ZH-CN
style='font-family:SimSun'>节点信息</span><span lang=EN-US> no=%d \n&quot;,no)</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向右递归输出右子树</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null) {</span></p>

<p class=a0><span lang=EN-US>      this.right.infixOrder()</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>前序遍历</span></p>

<p class=a0><span lang=EN-US>  def preOrder():Unit={</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>输出当前节点值</span></p>

<p class=a0><span lang=EN-US>    printf(&quot;</span><span lang=ZH-CN
style='font-family:SimSun'>节点信息</span><span lang=EN-US> no=%d \n&quot;,no)</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向左递归输出左子树</span></p>

<p class=a0><span lang=EN-US>    if(this.left != null){</span></p>

<p class=a0><span lang=EN-US>      this.left.postOrder()</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向右递归输出右子树</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null) {</span></p>

<p class=a0><span lang=EN-US>      this.right.preOrder()</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>后序遍历查找</span></p>

<p class=a0><span lang=EN-US>  def postOrderSearch(no:Int): TreeNode = {</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向左递归输出左子树</span></p>

<p class=a0><span lang=EN-US>    var resNode:TreeNode = null</span></p>

<p class=a0><span lang=EN-US>    if (this.left != null) {</span></p>

<p class=a0><span lang=EN-US>      resNode = this.left.postOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    if (resNode != null) {</span></p>

<p class=a0><span lang=EN-US>      return resNode</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null) {</span></p>

<p class=a0><span lang=EN-US>      resNode = this.right.postOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    if (resNode != null) {</span></p>

<p class=a0><span lang=EN-US>      return resNode</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    println(&quot;ttt~~&quot;)</span></p>

<p class=a0><span lang=EN-US>    if (this.no == no) {</span></p>

<p class=a0><span lang=EN-US>      return this</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    resNode</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>中序遍历查找</span></p>

<p class=a0><span lang=EN-US>  def infixOrderSearch(no:Int): TreeNode = {</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    var resNode : TreeNode = null</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>先向左递归查找</span></p>

<p class=a0><span lang=EN-US>    if (this.left != null) {</span></p>

<p class=a0><span lang=EN-US>      resNode = this.left.infixOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    if (resNode != null) {</span></p>

<p class=a0><span lang=EN-US>      return resNode</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    println(&quot;yyy~~&quot;)</span></p>

<p class=a0><span lang=EN-US>    if (no == this.no) {</span></p>

<p class=a0><span lang=EN-US>      return this</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向右递归查找</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null) {</span></p>

<p class=a0><span lang=EN-US>      resNode = this.right.infixOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    return resNode</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>前序查找</span></p>

<p class=a0><span lang=EN-US>  def preOrderSearch(no:Int): TreeNode = {</span></p>

<p class=a0><span lang=EN-US>    if (no == this.no) {</span></p>

<p class=a0><span lang=EN-US>      return this</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向左递归查找</span></p>

<p class=a0><span lang=EN-US>    var resNode : TreeNode = null</span></p>

<p class=a0><span lang=EN-US>    if (this.left != null) {</span></p>

<p class=a0><span lang=EN-US>      resNode = this.left.preOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    if (resNode != null){</span></p>

<p class=a0><span lang=EN-US>      return  resNode</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向右边递归查找</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null) {</span></p>

<p class=a0><span lang=EN-US>      resNode = this.right.preOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    return resNode</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>删除节点</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>删除节点规则</span></p>

<p class=a0><span lang=EN-US>  //1</span><span lang=ZH-CN style='font-family:
SimSun'>如果删除的节点是叶子节点，则删除该节点</span></p>

<p class=a0><span lang=EN-US>  //2</span><span lang=ZH-CN style='font-family:
SimSun'>如果删除的节点是非叶子节点，则删除该子树</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  def delNode(no:Int): Unit = {</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>首先比较当前节点的左子节点是否为要删除的节点</span></p>

<p class=a0><span lang=EN-US>    if (this.left != null &amp;&amp; this.left.no
== no) {</span></p>

<p class=a0><span lang=EN-US>      this.left = null</span></p>

<p class=a0><span lang=EN-US>      return</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>比较当前节点的右子节点是否为要删除的节点</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null &amp;&amp;
this.right.no == no) {</span></p>

<p class=a0><span lang=EN-US>      this.right = null</span></p>

<p class=a0><span lang=EN-US>      return</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向左递归删除</span></p>

<p class=a0><span lang=EN-US>    if (this.left != null) {</span></p>

<p class=a0><span lang=EN-US>      this.left.delNode(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>向右递归删除</span></p>

<p class=a0><span lang=EN-US>    if (this.right != null) {</span></p>

<p class=a0><span lang=EN-US>      this.right.delNode(no)</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<p class=a0><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>定义二叉树，前序、中序、后序遍历，前序、中序、后序查找，删除节点</span></p>

<p class=a0><span lang=EN-US>class BinaryTree{</span></p>

<p class=a0><span lang=EN-US>  var root:TreeNode = null</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  //</span><span lang=ZH-CN style='font-family:
SimSun'>后序遍历</span></p>

<p class=a0><span lang=EN-US>  def postOrder(): Unit = {</span></p>

<p class=a0><span lang=EN-US>    if (root != null){</span></p>

<p class=a0><span lang=EN-US>      root.postOrder()</span></p>

<p class=a0><span lang=EN-US>    }else {</span></p>

<p class=a0><span lang=EN-US>      println(&quot;</span><span lang=ZH-CN
style='font-family:SimSun'>当前二叉树为空，不能遍历</span><span lang=EN-US>&quot;)</span></p>

<p class=a0><span lang=EN-US>}</span></p>

<p class=a0><span lang=EN-US>}</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>中序遍历</span></p>

<p class=a0><span lang=EN-US>    def infixOrder(): Unit = {</span></p>

<p class=a0><span lang=EN-US>      if (root != null){</span></p>

<p class=a0><span lang=EN-US>        root.infixOrder()</span></p>

<p class=a0><span lang=EN-US>      }else {</span></p>

<p class=a0><span lang=EN-US>        println(&quot;</span><span lang=ZH-CN
style='font-family:SimSun'>当前二叉树为空，不能遍历</span><span lang=EN-US>&quot;)</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>前序遍历</span></p>

<p class=a0><span lang=EN-US>    def preOrder(): Unit = {</span></p>

<p class=a0><span lang=EN-US>      if (root != null){</span></p>

<p class=a0><span lang=EN-US>        root.preOrder()</span></p>

<p class=a0><span lang=EN-US>      }else {</span></p>

<p class=a0><span lang=EN-US>        println(&quot;</span><span lang=ZH-CN
style='font-family:SimSun'>当前二叉树为空，不能遍历</span><span lang=EN-US>&quot;)</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>后序遍历查找</span></p>

<p class=a0><span lang=EN-US>    def postOrderSearch(no:Int): TreeNode = {</span></p>

<p class=a0><span lang=EN-US>      if (root != null) {</span></p>

<p class=a0><span lang=EN-US>        root.postOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>      }else{</span></p>

<p class=a0><span lang=EN-US>        null</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>中序遍历查找</span></p>

<p class=a0><span lang=EN-US>    def infixOrderSeacher(no:Int): TreeNode = {</span></p>

<p class=a0><span lang=EN-US>      if (root != null) {</span></p>

<p class=a0><span lang=EN-US>        return root.infixOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>      }else {</span></p>

<p class=a0><span lang=EN-US>        return null</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    //</span><span lang=ZH-CN style='font-family:
SimSun'>前序查找</span></p>

<p class=a0><span lang=EN-US>    def preOrderSearch(no:Int): TreeNode = {</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>      if (root != null) {</span></p>

<p class=a0><span lang=EN-US>        return root.preOrderSearch(no)</span></p>

<p class=a0><span lang=EN-US>      }else{</span></p>

<p class=a0><span lang=EN-US>        //println(&quot;</span><span lang=ZH-CN
style='font-family:SimSun'>当前二叉树为空，不能查找</span><span lang=EN-US>&quot;)</span></p>

<p class=a0><span lang=EN-US>        return null</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>    }</span></p>

<p class=a0><span lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun'>删除节点</span></p>

<p class=a0><span lang=EN-US>    def delNode(no:Int): Unit = {</span></p>

<p class=a0><span lang=EN-US>      if (root != null) {</span></p>

<p class=a0><span lang=EN-US>        //</span><span lang=ZH-CN
style='font-family:SimSun'>先处理一下</span><span lang=EN-US>root</span><span
lang=ZH-CN style='font-family:SimSun'>是不是要删除的</span></p>

<p class=a0><span lang=EN-US>        if (root.no == no){</span></p>

<p class=a0><span lang=EN-US>          root = null</span></p>

<p class=a0><span lang=EN-US>        }else {</span></p>

<p class=a0><span lang=EN-US>          root.delNode(no)</span></p>

<p class=a0><span lang=EN-US>        }</span></p>

<p class=a0><span lang=EN-US>      }</span></p>

<p class=a0><span lang=EN-US>    </span></p>

<p class=a0><span lang=EN-US>  }</span></p>

<h2><a name="_Toc17126"><span lang=EN-US>2.6 </span></a><span lang=ZH-CN
style='font-family:SimHei'>手写</span><span lang=EN-US>Spark-WordCount</span></h2>

<p class=a0><span lang=EN-US>val conf: SparkConf = </span></p>

<p class=a0><span lang=EN-US>new
SparkConf().setMaster(&quot;local[*]&quot;).setAppName(&quot;WordCount&quot;)</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>val sc = new SparkContext(conf)</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>sc.textFile(&quot;/input&quot;)</span></p>

<p class=a0><span lang=EN-US>  .flatMap(_.split(&quot; &quot;))</span></p>

<p class=a0><span lang=EN-US>  .map((_, 1))</span></p>

<p class=a0><span lang=EN-US>  .reduceByKey(_ + _)</span></p>

<p class=a0><span lang=EN-US>  .saveAsTextFile(&quot;/output&quot;)</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>sc.stop()<a name="_Toc10725154"></a></span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc4074"><span lang=EN-US>2.7 </span></a><span lang=ZH-CN
style='font-family:SimHei'>手写</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimHei'>程序</span></h2>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>要求：</span><span
lang=EN-US>(a,1) (a,3) (b,3) (b,5) (c,4)</span><span lang=ZH-CN
style='font-family:SimSun'>，求每个</span><span lang=EN-US>key</span><span
lang=ZH-CN style='font-family:SimSun'>对应</span><span lang=EN-US>value</span><span
lang=ZH-CN style='font-family:SimSun'>的平均值</span></p>

<p class=a0><span lang=EN-US>rdd.combineByKey(v=&gt;(v,1),(acc:(Int,Int),newV)=&gt;(acc._1+newV,acc._2+1),(acc1:(Int,Int),acc2:(Int,Int))=&gt;(acc1._1+acc2._1,acc1._2+acc2._2))</span></p>

<h1><a name="_Toc7062"><span lang=ZH-CN style='font-family:SimSun'>第</span><span
lang=EN-US>3</span></a><span lang=ZH-CN style='font-family:SimSun'>章</span><span
lang=ZH-CN> </span><span lang=ZH-CN style='font-family:SimSun'>项目架构</span></h1>

<h2><a name="_Toc12823"></a><a name="_Toc10725155"><span lang=EN-US>3.1 </span></a><span
lang=ZH-CN style='font-family:SimHei'>数仓概念</span></h2>

<p class=MsoNormal style='line-height:150%'><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>数据仓库的输入数据源和输出系统分别是什么？</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>输入系统：埋点产生的用户行为数据、</span><span
lang=EN-US style='color:black'>JavaEE</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>后台产生的业务数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>输出系统：报表系统、用户画像系统、推荐系统</span></p>

<h2><a name="_Toc19698"></a><a name="_Toc10725156"><span lang=EN-US>3.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>系统数据流程设计</span></h2>

<p class=MsoNormal><span lang=EN-US><img border=0 width=409 height=230
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image006.jpg"></span></p>

<h2><a name="_Toc119"></a><a name="_Toc10725157"><span lang=EN-US>3.3 </span></a><span
lang=ZH-CN style='font-family:SimHei'>框架版本选型</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>Apache</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：运维麻烦，组件间兼容性需要自己调研。（一般大厂使用，技术实力雄厚，有专业的运维人员）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>CDH</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：国内使用最多的版本，但</span><span
lang=EN-US style='color:black'> CM</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>不开源，但其实对中、小公司使用来说没有影响（建议使用）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>HDP</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：开源，可以进行二次开发，但是没有</span><span
lang=EN-US style='color:black'>CDH</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>稳定，国内使用较少</span></p>

<h2><a name="_Toc15383"></a><a name="_Toc10725158"><span lang=EN-US>3.4 </span></a><span
lang=ZH-CN style='font-family:SimHei'>服务器选型</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>服务器使用物理机还是云主机？</span></p>

<p class=MsoNormal style='line-height:150%'><a name="_Toc8029"><span
lang=EN-US style='color:black'>1</span></a><span lang=ZH-CN style='font-family:
SimSun;color:black'>）机器成本考虑：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）物理机：以</span><span lang=EN-US style='color:black'>128G</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>内存，</span><span lang=EN-US
style='color:black'>20</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>核物理</span><span lang=EN-US style='color:black'>CPU</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>40</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>线程，</span><span lang=EN-US style='color:black'>8THDD</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>2TSSD</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>硬盘，单台报价</span><span lang=EN-US style='color:black'>4W</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>出头，需考虑托管服务器费用。一般物理机寿命</span><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>年左右</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）云主机，以阿里云为例，差不多相同配置，每年</span><span lang=EN-US style='color:black'>5W</span></p>

<p class=MsoNormal style='line-height:150%'><a name="_Toc10508"><span
lang=EN-US style='color:black'>2</span></a><span lang=ZH-CN style='font-family:
SimSun;color:black'>）运维成本考虑：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）物理机：需要有专业的运维人员</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）云主机：很多运维工作都由阿里云已经完成，运维相对较轻松</span></p>

<p class=MsoNormal><a name="_Toc10725159"><span lang=EN-US>&nbsp;</span></a></p>

<h2><a name="_Toc20395"><span lang=EN-US>3.5 </span></a><span lang=ZH-CN
style='font-family:SimHei'>集群规模</span></h2>

<p class=MsoNormal><span lang=EN-US><img border=0 width=361 height=204
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image007.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h2><a name="_Toc10725160"></a><a name="_Toc13884"><span lang=EN-US>3.6 </span></a><span
lang=ZH-CN style='font-family:SimHei'>人员配置参考</span></h2>

<h3><a name="_Toc17128"></a><a name="_Toc10725161"><span lang=EN-US>3.6.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>整体架构。</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>属于研发部，技术总监下面有各个项目组，我们属于数据组，其他还有后端项目组，基础平台等。总监上面就是副总等级别了。其他的还有产品运营部等。</span></p>

<h3><a name="_Toc10725162"></a><a name="_Toc11446"><span lang=EN-US>3.6.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>你们部门的职级等级，晋升规则</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>职级就分初级，中级，高级。晋升规则不一定，看公司效益和职位空缺。</span></p>

<h3><a name="_Toc10725163"></a><a name="_Toc3335"><span lang=EN-US>3.6.3 </span></a><span
lang=ZH-CN style='font-family:SimSun'>人员配置参考</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:blue'>小型公司（</span><span lang=EN-US
style='color:blue'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:blue'>人左右）</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：组长</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人，剩余组员无明确分工，并且可能兼顾</span><span lang=EN-US style='color:
black'>javaEE</span><span lang=ZH-CN style='font-family:SimSun;color:black'>和前端。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:blue'>中小型公司（</span><span lang=EN-US
style='color:blue'>3~6</span><span lang=ZH-CN style='font-family:SimSun;
color:blue'>人左右）</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：组长</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人，离线</span><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人左右，实时</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人左右（离线一般多于实时），</span><span lang=EN-US style='color:black'>JavaEE
1</span><span lang=ZH-CN style='font-family:SimSun;color:black'>人（有或者没有人单独负责</span><span
lang=EN-US style='color:black'>JavaEE</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，有时是有组员大数据和</span><span lang=EN-US style='color:black'>JavaEE</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>一起做，或者大数据和前端一起做）。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:blue'>中型公司（</span><span lang=EN-US
style='color:blue'>5~10</span><span lang=ZH-CN style='font-family:SimSun;
color:blue'>人左右）</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：组长</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人，离线</span><span lang=EN-US style='color:black'>3~5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人左右（离线处理、数仓），实时</span><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人左右，</span><span lang=EN-US style='color:black'>JavaEE 1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人左右（负责对接</span><span
lang=EN-US style='color:black'>JavaEE</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>业务），前端</span><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人左右（有或者没有人单独负责前端）。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:blue'>中大型公司（</span><span lang=EN-US
style='color:blue'>5~20</span><span lang=ZH-CN style='font-family:SimSun;
color:blue'>人左右）</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：组长</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人，离线</span><span lang=EN-US style='color:black'>5~10</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人（离线处理、数仓），实时</span><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人左右，</span><span lang=EN-US style='color:black'>JavaEE2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人左右（负责对接</span><span
lang=EN-US style='color:black'>JavaEE</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>业务），前端</span><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人（有或者没有人单独负责前端）。（发展比较良好的中大型公司可能大数据部门已经细化拆分，分成多个大数据组，分别负责不同业务）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>上面只是参考配置，因为公司之间差异很大，例如</span><span
lang=EN-US style='color:black'>ofo</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>大数据部门只有</span><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>个人左右，因此根据所选公司规模确定一个合理范围，在面试前必须将这个人员配置考虑清楚，回答时要非常确定。</span></p>

<h1><a name="_Toc10725164"></a><a name="_Toc27474"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>4</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=ZH-CN style='font-family:SimSun'>项目涉及技术</span></h1>

<h2><a name="_Toc10725165"></a><a name="_Toc2408"><span lang=EN-US>4.1 Linux&amp;Shell</span></a><span
lang=ZH-CN style='font-family:SimHei'>相关总结</span></h2>

<h3><a name="_Toc10725166"></a><a name="_Toc8245"><span lang=EN-US>4.1.1 Linux</span></a><span
lang=ZH-CN style='font-family:SimSun'>常用命令</span></h3>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=555
 style='width:416.0pt;border-collapse:collapse;border:none'>
 <tr style='height:16.35pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:16.35pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>序号</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:16.35pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>命令</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:16.35pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>命令解释</span></p>
  </td>
 </tr>
 <tr style='height:16.35pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:16.35pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>1</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:16.35pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>top</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:16.35pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>查看内存</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>2</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>df -h</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>查看磁盘存储情况</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>3</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>iotop</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>查看磁盘</span><span lang=EN-US
  style='color:black'>IO</span><span lang=ZH-CN style='font-family:SimSun;
  color:black'>读写</span><span lang=EN-US style='color:black'>(yum install iotop</span><span
  lang=ZH-CN style='font-family:SimSun;color:black'>安装）</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>4</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>iotop -o</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>直接查看比较高的磁盘读写程序</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>5</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>netstat -tunlp | grep </span><span lang=ZH-CN
  style='font-family:SimSun;color:black'>端口号</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>查看端口占用情况</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>6</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>uptime</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>查看报告系统运行时长及平均负载</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=48 valign=top style='width:35.95pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>7</span></p>
  </td>
  <td width=227 valign=top style='width:6.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=EN-US
  style='color:black'>ps  aux</span></p>
  </td>
  <td width=280 valign=top style='width:209.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal style='line-height:150%'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>查看进程</span></p>
  </td>
 </tr>
</table>

<h3><a name="_Toc10725167"></a><a name="_Toc29910"><span lang=EN-US>4.1.2 Shell</span></a><span
lang=ZH-CN style='font-family:SimSun'>常用工具</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>awk</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>sed</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>cut</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>sort</span></p>

<h2><a name="_Toc10725168"></a><a name="_Toc10058"><span lang=EN-US>4.2 Hadoop</span></a><span
lang=ZH-CN style='font-family:SimHei'>相关总结</span></h2>

<h3><a name="_Toc19605"></a><a name="_Toc10725169"><span lang=EN-US>4.2.1 Hadoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>常用端口号</span></h3>

<p class=MsoListParagraph style='margin-left:0cm;text-indent:0cm;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>dfs.namenode.http-address:50070</span></p>

<p class=MsoListParagraph style='margin-left:0cm;text-indent:0cm;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>dfs.datanode.http-address:50075</span></p>

<p class=MsoListParagraph style='margin-left:0cm;text-indent:0cm;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>SecondaryNameNode</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>辅助名称节点端口号：</span><span lang=EN-US style='color:black'>50090</span></p>

<p class=MsoListParagraph style='margin-left:0cm;text-indent:0cm;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>dfs.datanode.address:50010</span></p>

<p class=MsoListParagraph style='margin-left:0cm;text-indent:0cm;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>fs.defaultFS:8020 </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>或者</span><span lang=EN-US style='color:black'>9000</span></p>

<p class=MsoListParagraph style='margin-left:0cm;text-indent:0cm;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>yarn.resourcemanager.webapp.address:8088</span></p>

<p class=MsoListParagraph style='margin-left:0cm;text-indent:0cm;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun;color:black'>历史服务器</span><span lang=EN-US
style='color:black'>web</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>访问端口：</span><span lang=EN-US style='color:black'>19888</span></p>

<h3><a name="_Toc10725170"></a><a name="_Toc32170"><span lang=EN-US>4.2.2 Hadoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>配置文件以及简单的</span><span lang=EN-US>Hadoop</span><span
lang=ZH-CN style='font-family:SimSun'>集群搭建</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>（</span><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）配置文件：</span></p>

<p class=MsoNormal style='margin-left:22.05pt;line-height:150%'><span
lang=EN-US style='color:black'>core-site.xml</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>hdfs-site.xml</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>mapred-site.xml</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>yarn-site.xml</span></p>

<p class=MsoNormal style='margin-left:22.05pt;line-height:150%'><span
lang=EN-US style='color:black'>hadoop-env.sh</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>yarn-env.sh</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>mapred-env.sh</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>slaves</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>（</span><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）简单的集群搭建过程：</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       JDK</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>安装</span></p>

<p class=MsoNormal style='margin-left:22.05pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>配置</span><span lang=EN-US
style='color:black'>SSH</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>免密登录</span></p>

<p class=MsoNormal style='margin-left:22.05pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>配置</span><span lang=EN-US
style='color:black'>hadoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>核心文件</span><span lang=EN-US style='color:black'>:&nbsp;</span></p>

<p class=MsoNormal style='margin-left:22.05pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>格式化</span><span lang=EN-US
style='color:black'>namenode</span></p>

<h3><a name="_Toc17085"></a><a name="_Toc10725171"><span lang=EN-US>4.2.3 HDFS</span></a><span
lang=ZH-CN style='font-family:SimSun'>读流程和写流程</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=414 height=230 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image008.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image009.jpg"></span></p>

<h3><a name="_Toc10725172"></a><a name="_Toc30978"><span lang=EN-US>4.2.4
MapReduce</span></a><span lang=ZH-CN style='font-family:SimSun'>的</span><span
lang=EN-US>Shuffle</span><span lang=ZH-CN style='font-family:SimSun'>过程及</span><span
lang=EN-US>Hadoop</span><span lang=ZH-CN style='font-family:SimSun'>优化（包括：压缩、小文件、集群优化）</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=414 height=234 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image010.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=410 height=234 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image011.jpg"></span></p>

<p class=MsoNormal style='line-height:150%'><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>一、</span><span lang=EN-US
style='color:black'>Shuffle</span></b><b><span lang=ZH-CN style='font-family:
SimSun;color:black'>机制</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>Map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>方法之后</span><span lang=EN-US
style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法之前这段处理过程叫</span><span lang=EN-US style='color:black'>Shuffle</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>Map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>方法之后，数据首先进入到分区方法，把数据标记好分区，然后把数据发送到环形缓冲区；环形缓冲区默认大小</span><span
lang=EN-US style='color:black'>100m</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，环形缓冲区达到</span><span lang=EN-US style='color:black'>80%</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>时，进行溢写；溢写前对数据进行排序，排序按照对</span><span
lang=EN-US style='color:black'>key</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的索引进行字典顺序排序，排序的手段快排；溢写产生大量溢写文件，需要对溢写文件进行归并排序；对溢写的文件也可以进行</span><span
lang=EN-US style='color:black'>Combiner</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>操作，前提是汇总操作，求平均值不行。最后将文件按照分区存储到磁盘，等待</span><span
lang=EN-US style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>端拉取。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）每个</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>拉取</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>端对应分区的数据。拉取数据后先存储到内存中，内存不够了，再存储到磁盘。拉取完所有数据后，采用归并排序将内存和磁盘中的数据都进行排序。在进入</span><span
lang=EN-US style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>方法前，可以对数据进行分组操作。</span></p>

<p class=MsoNormal style='line-height:150%'><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>二、</span><span lang=EN-US
style='color:black'>Hadoop</span></b><b><span lang=ZH-CN style='font-family:
SimSun;color:black'>优化</span></b></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>0</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>HDFS</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>小文件影响</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）影响</span><span lang=EN-US style='color:black'>NameNode</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的寿命，因为文件元数据存储在</span><span
lang=EN-US style='color:black'>NameNode</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的内存中</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）影响计算引擎的任务数量，比如每个小的文件都会生成一个</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>任务</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）数据输入小文件处理：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）合并小文件：对小文件进行归档（</span><span lang=EN-US style='color:black'>Har</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）、自定义</span><span lang=EN-US
style='color:black'>Inputformat</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>将小文件存储成</span><span lang=EN-US style='color:black'>SequenceFile</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>文件。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）采用</span><span lang=EN-US style='color:black'>ConbinFileInputFormat</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>来作为输入，解决输入端大量小文件场景。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）对于大量小文件</span><span lang=EN-US style='color:black'>Job</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，可以开启</span><span lang=EN-US
style='color:black'>JVM</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>重用。</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>阶段</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）增大环形缓冲区大小。由</span><span lang=EN-US style='color:black'>100m</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>扩大到</span><span lang=EN-US
style='color:black'>200m</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）增大环形缓冲区溢写的比例。由</span><span lang=EN-US style='color:black'>80%</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>扩大到</span><span lang=EN-US
style='color:black'>90%</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）减少对溢写文件的</span><span lang=EN-US style='color:black'>merge</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>次数。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>4</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）不影响实际业务的前提下，采用</span><span lang=EN-US style='color:black'>Combiner</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>提前合并，减少</span><span
lang=EN-US style='color:black'> I/O</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>。</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>阶段</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）合理设置</span><span lang=EN-US style='color:black'>Map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数：两个都不能设置太少，也不能设置太多。太少，会导致</span><span lang=EN-US
style='color:black'>Task</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>等待，延长处理时间；太多，会导致</span><span lang=ZH-CN style='color:black'> </span><span
lang=EN-US style='color:black'>Map</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>任务间竞争资源，造成处理超时等错误。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）设置</span><span lang=EN-US style='color:black'>Map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>共存：调整</span><span lang=EN-US style='color:black'>slowstart.completedmaps</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>参数，使</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>运行到一定程度后，</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>也开始运行，减少</span><span
lang=EN-US style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的等待时间。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）规避使用</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，因为</span><span lang=EN-US
style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>在用于连接数据集的时候将会产生大量的网络消耗。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>4</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）增加每个</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>去</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>中拿数据的并行数</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>5</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）集群性能可以的前提下，增大</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>端存储数据内存的大小。</span><span
lang=ZH-CN style='color:black'> </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>IO</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>传输</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
background:white'><span lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）采用数据压缩的方式，减少网络</span><span lang=EN-US style='color:black'>IO</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的的时间。安装</span><span
lang=EN-US style='color:black'>Snappy</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>和</span><span lang=EN-US style='color:black'>LZOP</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>压缩编码器。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）使用</span><span lang=EN-US style='color:black'>SequenceFile</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>二进制文件</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）整体</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>MapTask</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>默认内存大小为</span><span
lang=EN-US style='color:black'>1G</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，可以增加</span><span lang=EN-US style='color:black'>MapTask</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>内存大小为</span><span lang=EN-US
style='color:black'>4-5g</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>ReduceTask</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>默认内存大小为</span><span
lang=EN-US style='color:black'>1G</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，可以增加</span><span lang=EN-US style='color:black'>ReduceTask</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>内存大小为</span><span lang=EN-US
style='color:black'>4-5g</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）可以增加</span><span lang=EN-US style='color:black'>MapTask</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的</span><span lang=EN-US
style='color:black'>cpu</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>核数，增加</span><span lang=EN-US style='color:black'>ReduceTask</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的</span><span lang=EN-US
style='color:black'>CPU</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>核数</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>4</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）增加每个</span><span lang=EN-US style='color:black'>Container</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的</span><span lang=EN-US
style='color:black'>CPU</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>核数和内存大小</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>5</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）调整每个</span><span lang=EN-US style='color:black'>Map Task</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>Reduce Task</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>最大重试次数</span></p>

<p class=MsoNormal style='line-height:150%'><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>三、压缩</span></b></p>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 width=550
 style='width:412.7pt;border-collapse:collapse;border:none'>
 <tr style='height:22.5pt'>
  <td width=67 valign=top style='width:50.15pt;border:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>压缩格式</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>Hadoop</span><span lang=ZH-CN style='font-family:SimSun;
  color:black'>自带？</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>算法</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>文件扩展名</span></p>
  </td>
  <td width=66 valign=top style='width:49.6pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>支持切分</span></p>
  </td>
  <td width=162 valign=top style='width:121.6pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>换成压缩格式后，原来的程序是否需要修改</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=67 valign=top style='width:50.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>DEFLATE</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>是，直接使用</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>DEFLATE</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>.deflate</span></p>
  </td>
  <td width=66 valign=top style='width:49.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>否</span></p>
  </td>
  <td width=162 valign=top style='width:121.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>和文本处理一样，不需要修改</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=67 valign=top style='width:50.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>Gzip</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>是，直接使用</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>DEFLATE</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>.gz</span></p>
  </td>
  <td width=66 valign=top style='width:49.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>否</span></p>
  </td>
  <td width=162 valign=top style='width:121.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>和文本处理一样，不需要修改</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=67 valign=top style='width:50.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>bzip2</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>是，直接使用</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>bzip2</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>.bz2</span></p>
  </td>
  <td width=66 valign=top style='width:49.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>是</span></p>
  </td>
  <td width=162 valign=top style='width:121.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>和文本处理一样，不需要修改</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=67 valign=top style='width:50.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>LZO</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>否，需要安装</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>LZO</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>.lzo</span></p>
  </td>
  <td width=66 valign=top style='width:49.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>是</span></p>
  </td>
  <td width=162 valign=top style='width:121.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>需要建索引，还需要指定输入格式</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=67 valign=top style='width:50.15pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>Snappy</span></p>
  </td>
  <td width=104 valign=top style='width:77.95pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>否，需要安装</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>Snappy</span></p>
  </td>
  <td width=76 valign=top style='width:2.0cm;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=EN-US
  style='color:black'>.snappy</span></p>
  </td>
  <td width=66 valign=top style='width:49.6pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>否</span></p>
  </td>
  <td width=162 valign=top style='width:121.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=MsoNormal align=left style='text-align:left'><span lang=ZH-CN
  style='font-family:SimSun;color:black'>和文本处理一样，不需要修改</span></p>
  </td>
 </tr>
</table>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>提示：如果面试过程问起，我们一般回答压缩方式为</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Snappy</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，特点速度快，缺点无法切分（可以回答在链式</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>MR</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Reduce</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>端输出使用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>bzip2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>压缩，以便后续的</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>map</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>任务对数据进行</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>split</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>）</span></p>

<p class=MsoNormal style='line-height:150%'><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>四、切片机制</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）简单地按照文件的内容长度进行切片</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）切片大小，默认等于</span><span lang=EN-US style='color:black'>Block</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>大小</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）切片时不考虑数据集整体，而是逐个针对每一个文件单独切片</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>提示：切片大小公式：</span><span
lang=EN-US style='color:black'>max(0,min(Long_max,blockSize))</span></p>

<h3><a name="_Toc23145"></a><a name="_Toc10725173"><span lang=EN-US>4.2.5 Yarn</span></a><span
lang=ZH-CN style='font-family:SimSun'>的</span><span lang=EN-US>Job</span><span
lang=ZH-CN style='font-family:SimSun'>提交流程</span></h3>

<p class=MsoNormal><a name="_Hlk525278506"><span lang=EN-US style='color:black'><img
border=0 width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image012.jpg"></span></a></p>

<p class=MsoNormal><a name="_Toc10725174"><span lang=EN-US>&nbsp;</span></a></p>

<h3><a name="_Toc11135"><span lang=EN-US>4.2.6 Yarn</span></a><span lang=ZH-CN
style='font-family:SimSun'>的默认调度器、调度器分类、以及他们之间的区别</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Hadoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>调度器重要分为三类：</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>FIFO&nbsp;</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>Capacity Scheduler</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>（容量调度器）和</span><span lang=EN-US style='color:black'>Fair
Sceduler</span><span lang=ZH-CN style='font-family:SimSun;color:black'>（公平调度器）。</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hadoop2.7.2</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>默认的资源调度器是</span><span lang=EN-US
style='color:black'>&nbsp;</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>容量调度器</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）区别：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>FIFO</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>调度器：先进先出，同一时间队列中只有一个任务在执行。</span></p>

<p class=MsoNormal style='line-height:150%'><a name="_Hlk525278609"><span
lang=EN-US style='color:black'><img border=0 width=410 height=232
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image013.jpg"></span></a></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>容量调度器：多队列；每个队列内部先进先出，同一时间队列中只有一个任务在执行。队列的并行度为队列的个数。</span></p>

<p class=MsoNormal style='line-height:150%'><a name="_Hlk525278617"><span
lang=EN-US style='color:black'><img border=0 width=410 height=232
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image014.jpg"></span></a></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>公平调度器：多队列；每个队列内部按照缺额大小分配资源启动任务，同一时间队列中有多个任务执行。队列的并行度大于等于队列的个数。</span></p>

<p class=MsoNormal style='line-height:150%'><a name="_Hlk525278622"><span
lang=EN-US style='color:black'>3</span></a><span lang=ZH-CN style='font-family:
SimSun;color:black'>）一定要强调生产环境中不是使用的</span><span lang=EN-US style='color:black'>FifoScheduler</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，面试的时侯会发现候选人大概了解这几种调度器的区别，但是问在生产环境用哪种，却说使用的</span><span
lang=EN-US style='color:black'>FifoScheduler</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>（企业生产环境一定不会用这个调度的）</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black;
background:white'><img border=0 width=410 height=232
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image015.jpg"></span></p>

<h3><a name="_Toc4754"></a><a name="_Toc10725175"><span lang=EN-US>4.2.7</span></a><span
lang=ZH-CN style='font-family:SimSun'>项目经验之</span><span lang=EN-US>LZO</span><span
lang=ZH-CN style='font-family:SimSun'>压缩</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>默认不支持</span><span lang=EN-US style='color:black'>LZO</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>压缩，如果需要支持</span><span
lang=EN-US style='color:black'>LZO</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>压缩，需要添加</span><span lang=EN-US style='color:black'>jar</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>包，并在</span><span lang=EN-US
style='color:black'>hadoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>的</span><span lang=EN-US style='color:black'>cores-site.xml</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>文件中添加相关压缩配置。</span></p>

<h3><a name="_Toc10725176"></a><a name="_Toc24519"><span lang=EN-US>4.2.8 Hadoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>参数调优</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）在</span><span lang=EN-US style='color:black'>hdfs-site.xml</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>文件中配置多目录，最好提前配置好，否则更改目录需要重新启动集群</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>NameNode</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>有一个工作线程池，用来处理不同</span><span
lang=EN-US style='color:black'>DataNode</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的并发心跳以及客户端并发的元数据操作。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dfs.namenode.handler.count=20 * log2(Cluster
Size)</span><span lang=ZH-CN style='font-family:SimSun;color:black'>，比如集群规模为</span><span
lang=EN-US style='color:black'>10</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>台时，此参数设置为</span><span lang=EN-US style='color:black'>60</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）编辑日志存储路径</span><span lang=EN-US style='color:black'>dfs.namenode.edits.dir</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>设置与镜像文件存储路径</span><span
lang=EN-US style='color:black'>dfs.namenode.name.dir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>尽量分开，达到最低写入延迟</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>4</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）服务器节点上</span><span lang=EN-US style='color:black'>YARN</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>可使用的物理内存总量，默认是</span><span
lang=EN-US style='color:black'>8192</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>（</span><span lang=EN-US style='color:black'>MB</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>），注意，如果你的节点内存资源不够</span><span
lang=EN-US style='color:black'>8GB</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，则需要调减小这个值，而</span><span lang=EN-US style='color:black'>YARN</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>不会智能的探测节点的物理内存总量。</span><span
lang=EN-US style='color:black'>yarn.nodemanager.resource.memory-mb</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）单个任务可申请的最多物理内存量，默认是</span><span lang=EN-US
style='color:black'>8192</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>（</span><span lang=EN-US style='color:black'>MB</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）。</span><span lang=EN-US
style='color:black'>yarn.scheduler.maximum-allocation-mb</span></p>

<h3><a name="_Toc10725177"></a><a name="_Toc31884"><span lang=EN-US>4.2.9</span></a><span
lang=ZH-CN style='font-family:SimSun'>项目经验之基准测试</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>搭建完</span><span lang=EN-US
style='color:black'>Hadoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>集群后需要对</span><span lang=EN-US style='color:black'>HDFS</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>读写性能和</span><span lang=EN-US
style='color:black'>MR</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>计算能力测试。测试</span><span lang=EN-US style='color:black'>jar</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>包在</span><span lang=EN-US
style='color:black'>hadoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>的</span><span lang=EN-US style='color:black'>share</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>文件夹下。</span></p>

<h3><a name="_Toc13828"></a><a name="_Toc10725178"><span lang=EN-US>4.2.10 Hadoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>宕机</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-family:SimSun;color:black'>1</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）如果</span><span lang=EN-US
style='font-family:SimSun;color:black'>MR</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>造成系统宕机。此时要控制</span><span lang=EN-US
style='font-family:SimSun;color:black'>Yarn</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>同时运行的任务数，和每个任务申请的最大内存。调整参数：</span><span
lang=EN-US style='font-family:SimSun;color:black'>yarn.scheduler.maximum-allocation-mb</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（单个任务可申请的最多物理内存量，默认是</span><span
lang=EN-US style='font-family:SimSun;color:black'>8192MB</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-family:SimSun;color:black'>2</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）如果写入文件过量造成</span><span lang=EN-US
style='font-family:SimSun;color:black'>NameNode</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>宕机。那么调高</span><span lang=EN-US
style='font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的存储大小，控制从</span><span lang=EN-US
style='font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>到</span><span lang=EN-US
style='font-family:SimSun;color:black'>HDFS</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的写入速度。高峰期的时候用</span><span lang=EN-US
style='font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>进行缓存，高峰期过去数据同步会自动跟上。</span></p>

<h2><a name="_Toc10725179"></a><a name="_Toc17265"><span lang=EN-US>4.3 Zookeeper</span></a><span
lang=ZH-CN style='font-family:SimHei'>相关总结</span></h2>

<h3><a name="_Toc10725180"></a><a name="_Toc29207"><span lang=EN-US>4.3.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>选举机制</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>半数机制</span></p>

<h3><a name="_Toc5136"></a><a name="_Toc10725181"><span lang=EN-US>4.3.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>常用命令</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       ls</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>get</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>create</span></p>

<h2><a name="_Toc19546"></a><a name="_Toc10725182"><span lang=EN-US>4.4 Flume</span></a><span
lang=ZH-CN style='font-family:SimHei'>相关总结</span></h2>

<h3><a name="_Toc10725183"></a><a name="_Toc4365"><span lang=EN-US>4.4.1 Flume</span></a><span
lang=ZH-CN style='font-family:SimSun'>组成，</span><span lang=EN-US>Put</span><span
lang=ZH-CN style='font-family:SimSun'>事务，</span><span lang=EN-US>Take</span><span
lang=ZH-CN style='font-family:SimSun'>事务</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Flume</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>组成，</span><span lang=EN-US style='color:black'>Put</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>事务，</span><span lang=EN-US
style='color:black'>Take</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>事务</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       Taildir
Source</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：断点续传、多目录。</span><span
lang=EN-US style='color:black'>Flume1.6</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>以前需要自己自定义</span><span lang=EN-US
style='color:black'>Source</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>记录每次读取文件位置，实现断点续传。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       File
Channel</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：数据存储在磁盘，宕机数据可以保存。但是传输速率慢。适合对数据传输可靠性要求高的场景，比如，金融行业。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       Memory
Channel</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：数据存储在内存中，宕机数据丢失。传输速率快。适合对数据传输可靠性要求不高的场景，比如，普通的日志数据。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       Kafka
Channel</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：减少了</span><span
lang=EN-US style='color:black'>Flume</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的</span><span lang=EN-US style='color:black'>Sink</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>阶段，提高了传输效率。</span><span
lang=EN-US style='color:black'>           </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       Source</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>到</span><span lang=EN-US
style='color:black'>Channel</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>是</span><span lang=EN-US style='color:black'>Put</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>事务</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       Channel</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>到</span><span lang=EN-US
style='color:black'>Sink</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>是</span><span lang=EN-US style='color:black'>Take</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>事务</span></p>

<h3><a name="_Toc10725184"></a><a name="_Toc25003"><span lang=EN-US>4.4.2 Flume</span></a><span
lang=ZH-CN style='font-family:SimSun'>拦截器</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）拦截器注意事项</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>              </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>项目中自定义了：</span><span
lang=EN-US style='color:black'>ETL</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>拦截器和区分类型拦截器。</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>采用两个拦截器的优缺点：优点，模块化开发和可移植性；缺点，性能会低一些</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）自定义拦截器步骤</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'>a</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）实现</span><span lang=EN-US
style='color:black'> Interceptor</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'>b</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）重写四个方法</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:84.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>initialize </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>初始化</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:84.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>public Event intercept(Event event) </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>处理单个</span><span lang=EN-US
style='color:black'>Event</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:84.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>public List&lt;Event&gt; intercept(List&lt;Event&gt;
events) </span><span lang=ZH-CN style='font-family:SimSun;color:black'>处理多个</span><span
lang=EN-US style='color:black'>Event</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，在这个方法中调用</span><span lang=EN-US style='color:black'>Event
intercept(Event event)</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:84.0pt;margin-bottom:.0001pt;text-indent:-21.0pt;line-height:
150%'><span lang=EN-US style='font-family:Wingdings;color:black'>Ø<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=EN-US
style='color:black'>close </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法</span></p>

<p class=MsoNormal style='margin-left:21.0pt;text-indent:21.0pt;line-height:
150%'><span lang=EN-US style='color:black'>c</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）静态内部类，实现</span><span lang=EN-US
style='color:black'>Interceptor.Builder</span></p>

<p class=MsoNormal style='line-height:150%'><b><span lang=EN-US
style='font-size:14.0pt;line-height:150%;color:black'> </span></b></p>

<h3><a name="_Toc7518"></a><a name="_Toc10725187"><span lang=EN-US>4.4.3 Flume</span></a><span
lang=ZH-CN style='font-family:SimSun'>采集数据会丢失吗</span><span lang=EN-US>?</span><span
lang=ZH-CN style='font-family:SimSun'>（防止数据丢失的机制）</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>不会，</span><span lang=EN-US
style='color:black'>Channel</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>存储可以存储在</span><span lang=EN-US style='color:black'>File</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>中，数据传输自身有事务。</span></p>

<h3><a name="_Toc1169"></a><a name="_Toc10725188"><span lang=EN-US>4.4.4 Flume</span></a><span
lang=ZH-CN style='font-family:SimSun'>内存</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>开发中在</span><span lang=EN-US
style='color:black'>flume-env.sh</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中设置</span><span lang=EN-US style='color:black'>JVM heap</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>为</span><span lang=EN-US
style='color:black'>4G</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>或更高，部署在单独的服务器上（</span><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>核</span><span lang=EN-US
style='color:black'>8</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>线程</span><span lang=EN-US style='color:black'>16G</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>内存）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>-Xmx</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>与</span><span lang=EN-US style='color:black'>-Xms</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>最好设置一致，减少内存抖动带来的性能影响，如果设置不一致容易导致频繁</span><span
lang=EN-US style='color:black'>fullgc</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>。</span></p>

<h3><a name="_Toc10725189"></a><a name="_Toc22341"><span lang=EN-US>4.4.5 FileChannel</span></a><span
lang=ZH-CN style='font-family:SimSun'>优化</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>通过配置</span><span lang=EN-US
style='color:black'>dataDirs</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>指向多个路径，每个路径对应不同的硬盘，增大</span><span lang=EN-US style='color:black'>Flume</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>吞吐量。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>官方说明如下：</span></p>

<p class=a0><span lang=EN-US>Comma separated list of directories for storing
log files. Using multiple directories on separate disks can improve file channel
peformance</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>checkpointDir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>backupCheckpointDir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>也尽量配置在不同硬盘对应的目录中，保证</span><span
lang=EN-US style='color:black'>checkpoint</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>坏掉后，可以快速使用</span><span lang=EN-US
style='color:black'>backupCheckpointDir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>恢复数据</span></p>

<h3><a name="_Toc10725190"></a><a name="_Toc181"><span lang=EN-US>4.4.6 HDFS Sink</span></a><span
lang=ZH-CN style='font-family:SimSun'>小文件处理</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>HDFS</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>存入大量小文件，有什么影响？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>元数据层面：</span></b><span
lang=ZH-CN style='font-family:SimSun;color:black'>每个小文件都有一份元数据，其中包括文件路径，文件名，所有者，所属组，权限，创建时间等，这些信息都保存在</span><span
lang=EN-US style='color:black'>Namenode</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>内存中。所以小文件过多，会占用</span><span lang=EN-US
style='color:black'>Namenode</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>服务器大量内存，影响</span><span lang=EN-US style='color:black'>Namenode</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>性能和使用寿命</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>计算层面：</span></b><span
lang=ZH-CN style='font-family:SimSun;color:black'>默认情况下</span><span lang=EN-US
style='color:black'>MR</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>会对每个小文件启用一个</span><span lang=EN-US style='color:black'>Map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>任务计算，非常影响计算性能。同时也影响磁盘寻址时间。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>HDFS</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>小文件处理</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>官方默认的这三个参数配置写入</span><span
lang=EN-US style='color:black'>HDFS</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>后会产生小文件，</span><span lang=EN-US style='color:black'>hdfs.rollInterval</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>hdfs.rollSize</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>hdfs.rollCount</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>基于以上</span><span lang=EN-US
style='color:black'>hdfs.rollInterval=3600</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>hdfs.rollSize=134217728</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>hdfs.rollCount =0</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，</span><span lang=EN-US style='color:black'>hdfs.roundValue=10</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>hdfs.roundUnit= second</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>几个参数综合作用，效果如下：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>tmp</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>文件在达到</span><span lang=EN-US
style='color:black'>128M</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>时会滚动生成正式文件</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>tmp</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>文件创建超</span><span lang=EN-US
style='color:black'>10</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>秒时会滚动生成正式文件</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>&nbsp;</span></p>

<h2><a name="_Toc12400"></a><a name="_Toc10725191"><span lang=EN-US>4.5 Kafka</span></a><span
lang=ZH-CN style='font-family:SimHei'>相关总结</span></h2>

<h3><a name="_Toc11021"></a><a name="_Toc10725192"><span lang=EN-US>4.5.1 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>架构</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=414 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image016.jpg"></span></p>

<h3><a name="_Toc13304"></a><a name="_Toc10725193"><span lang=EN-US>4.5.2 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>压测</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;color:black'>Kafka</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>官方自带压力测试脚本（</span><span
lang=EN-US style='line-height:150%;color:black'>kafka-consumer-perf-test.sh</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>、</span><span
lang=EN-US style='line-height:150%;color:black'>kafka-producer-perf-test.sh</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>）。</span><span
lang=EN-US style='line-height:150%;color:black'>Kafka</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>压测时，可以查看到哪个地方出现了瓶颈（</span><span
lang=EN-US style='line-height:150%;color:black'>CPU</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>，内存，网络</span><span
lang=EN-US style='line-height:150%;color:black'>IO</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>）。一般都是网络</span><span
lang=EN-US style='line-height:150%;color:black'>IO</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>达到瓶颈。</span></p>

<h3><a name="_Toc10725194"></a><a name="_Toc11366"><span lang=EN-US>4.5.3 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>的机器数量</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;color:black'>Kafka</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>机器数量</span><span
lang=EN-US style='line-height:150%;color:black'>=2*</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>（峰值生产速度</span><span
lang=EN-US style='line-height:150%;color:black'>*</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>副本数</span><span
lang=EN-US style='line-height:150%;color:black'>/100</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>）</span><span
lang=EN-US style='line-height:150%;color:black'>+1</span></p>

<h3><a name="_Toc10725195"></a><a name="_Toc20801"><span lang=EN-US>4.5.4 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>的日志保存时间</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;color:black'>7</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>天</span></p>

<h3><a name="_Toc8494"></a><a name="_Toc10725196"><span lang=EN-US>4.5.5 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>的硬盘大小</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>每天的数据量</span><span
lang=EN-US style='line-height:150%;color:black'>*7</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>天</span></p>

<h3><a name="_Toc31513"></a><a name="_Toc10725197"><span lang=EN-US>4.5.6 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>监控</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>公司自己开发的监控器；</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>开源的监控器：</span><span
lang=EN-US style='line-height:150%;color:black'>KafkaManager</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>、</span><span
lang=EN-US style='line-height:150%;color:black'>KafkaMonitor</span></p>

<h3><a name="_Toc16563"></a><a name="_Toc10725198"><span lang=EN-US>4.5.7 Kakfa</span></a><span
lang=ZH-CN style='font-family:SimSun'>分区数</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>分区数并不是越多越好，一般分区数不要超过集群机器数量。分区数越多占用内存越大（</span><span
lang=EN-US style='line-height:150%;color:black'>ISR</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>等），一个节点集中的分区也就越多，当它宕机的时候，对系统的影响也就越大。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>分区数一般设置为：</span><span
lang=EN-US style='line-height:150%;color:black'>3-10</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>个</span></p>

<h3><a name="_Toc10725199"></a><a name="_Toc9346"><span lang=EN-US>4.5.8 </span></a><span
lang=ZH-CN style='font-family:SimSun'>副本数设定</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>一般我们设置成</span><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个或</span><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>个，很多企业设置为</span><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个。</span></p>

<h3><a name="_Toc3888"></a><a name="_Toc10725200"><span lang=EN-US>4.5.9 </span></a><span
lang=ZH-CN style='font-family:SimSun'>多少个</span><span lang=EN-US>Topic</span></h3>

<p class=a1><span lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
color:black'>     </span><span lang=ZH-CN style='font-size:10.5pt;font-family:
SimSun;color:black'>通常情况：多少个日志类型就多少个</span><span lang=EN-US style='font-size:
10.5pt;font-family:"Times New Roman",serif;color:black'>Topic</span><span
lang=ZH-CN style='font-size:10.5pt;font-family:SimSun;color:black'>。也有对日志类型进行合并的。</span></p>

<h3><a name="_Toc12550"></a><a name="_Toc10725201"><span lang=EN-US>4.5.10
Kafka</span></a><span lang=ZH-CN style='font-family:SimSun'>丢不丢数据</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Ack=0</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，相当于异步发送，消息发送完毕即</span><span lang=EN-US style='color:black'>offset</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>增加，继续生产。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Ack=1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，</span><span lang=EN-US style='color:black'>leader</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>收到</span><span lang=EN-US
style='color:black'>leader replica </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>对一个消息的接受</span><span lang=EN-US style='color:black'>ack</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>才增加</span><span lang=EN-US
style='color:black'>offset</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，然后继续生产。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Ack=-1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，</span><span lang=EN-US style='color:black'>leader</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>收到所有</span><span lang=EN-US
style='color:black'>replica </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>对一个消息的接受</span><span lang=EN-US style='color:black'>ack</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>才增加</span><span lang=EN-US
style='color:black'>offset</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，然后继续生产。</span></p>

<h3><a name="_Toc10725202"></a><a name="_Toc31065"><span lang=EN-US>4.5.11
Kafka</span></a><span lang=ZH-CN style='font-family:SimSun'>的</span><span
lang=EN-US>ISR</span><span lang=ZH-CN style='font-family:SimSun'>副本同步队列</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>ISR</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>（</span><span lang=EN-US style='color:black'>In-Sync
Replicas</span><span lang=ZH-CN style='font-family:SimSun;color:black'>），副本同步队列。</span><span
lang=EN-US style='color:black'>ISR</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中包括</span><span lang=EN-US style='color:black'>Leader</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>Follower</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>。如果</span><span lang=EN-US style='color:black'>Leader</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>进程挂掉，会在</span><span
lang=EN-US style='color:black'>ISR</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>队列中选择一个服务作为新的</span><span lang=EN-US style='color:black'>Leader</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>。有</span><span lang=EN-US
style='color:black'>replica.lag.max.messages</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>（延迟条数）和</span><span lang=EN-US
style='color:black'>replica.lag.time.max.ms</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>（延迟时间）两个参数决定一台服务是否可以加入</span><span
lang=EN-US style='color:black'>ISR</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>副本队列，在</span><span lang=EN-US style='color:black'>0.10</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>版本移除了</span><span lang=EN-US
style='color:black'>replica.lag.max.messages</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>参数，防止服务频繁的进去队列。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>任意一个维度超过阈值都会把</span><span
lang=EN-US style='color:black'>Follower</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>剔除出</span><span lang=EN-US
style='color:black'>ISR</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，存入</span><span lang=EN-US style='color:black'>OSR</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>Outof-Sync Replicas</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）列表，新加入的</span><span lang=EN-US
style='color:black'>Follower</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>也会先存放在</span><span lang=EN-US style='color:black'>OSR</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>中。</span></p>

<h3><a name="_Toc10725203"></a><a name="_Toc23695"><span lang=EN-US>4.5.12
Kafka</span></a><span lang=ZH-CN style='font-family:SimSun'>分区分配策略</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>在</span><span lang=EN-US
style='color:black'>&nbsp;Kafka</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>内部存在两种默认的分区分配策略：</span><span lang=EN-US style='color:black'>Range</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>&nbsp;RoundRobin</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Range</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>是默认策略。</span><span lang=EN-US style='color:black'>Range</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>是对每个</span><span lang=EN-US
style='color:black'>Topic</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>而言的（即一个</span><span lang=EN-US style='color:black'>Topic</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>一个</span><span lang=EN-US
style='color:black'>Topic</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>分），首先对同一个</span><span lang=EN-US style='color:black'>Topic</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>里面的分区按照序号进行排序，并对消费者按照字母顺序进行排序。然后用</span><span
lang=EN-US style='color:black'>Partitions</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>分区的个数除以消费者线程的总数来决定每个消费者线程消费几个分区。如果除不尽，那么前面几个消费者线程将会多消费一个分区。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>例如：我们有</span><span
lang=EN-US style='color:black'>10</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个分区，两个消费者（</span><span lang=EN-US style='color:black'>C1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>C2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>），</span><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>个消费者线程，</span><span
lang=EN-US style='color:black'>10 / 3 = 3</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>而且除不尽。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>C1-0 </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>将消费</span><span lang=EN-US style='color:black'> 0, 1, 2, 3 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>分区</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>C2-0 </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>将消费</span><span lang=EN-US style='color:black'> 4, 5, 6 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>分区</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>C2-1 </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>将消费</span><span lang=EN-US style='color:black'> 7, 8, 9 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>分区</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>RoundRobin</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>：前提：同一个</span><span lang=EN-US
style='color:black'>Consumer Group</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>里面的所有消费者的</span><span lang=EN-US style='color:black'>num.streams</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（消费者消费线程数）必须相等；每个消费者订阅的主题必须相同。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>第一步：将所有主题分区组成</span><span
lang=EN-US style='color:black'>TopicAndPartition</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>列表，然后对</span><span lang=EN-US
style='color:black'>TopicAndPartition</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>列表按照</span><span lang=EN-US style='color:black'>hashCode</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>进行排序，最后按照轮询的方式发给每一个消费线程。</span></p>

<h3><a name="_Toc10725205"></a><a name="_Toc10725204"></a><a name="_Toc27983"><span
lang=EN-US>4.5.13 Kafka</span></a><span lang=ZH-CN style='font-family:SimSun'>中数据量计算</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>每天总数据量</span><span
lang=EN-US style='color:black'>100g</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，每天产生</span><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>亿条日志，</span><span lang=EN-US
style='color:black'> 10000</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>万</span><span lang=EN-US style='color:black'>/24/60/60=1150</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>条</span><span lang=EN-US
style='color:black'>/</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>每秒钟</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>平均每秒钟：</span><span
lang=EN-US style='color:black'>1150</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>条</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>低谷每秒钟：</span><span
lang=EN-US style='color:black'>400</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>条</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>高峰每秒钟：</span><span
lang=EN-US style='color:black'>1150</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>条</span><span lang=EN-US style='color:black'>*</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2-20</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>倍）</span><span lang=EN-US style='color:black'>=2300</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>条</span><span lang=EN-US
style='color:black'>-23000</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>条</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>每条日志大小：</span><span
lang=EN-US style='color:black'>0.5k-2k</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>每秒多少数据量：</span><span
lang=EN-US style='color:black'>2.3M-20MB</span></p>

<h3><a name="_Toc32533"><span lang=EN-US>4.5.14 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>挂掉</span></h3>

<p class=a1 style='margin-left:22.05pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Flume</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>记录</span></p>

<p class=a1 style='margin-left:22.05pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）日志有记录</span></p>

<p class=a1 style='margin-left:22.05pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）短期没事</span></p>

<h3><a name="_Toc25630"></a><a name="_Toc10725206"><span lang=EN-US>4.5.15 Kafka</span></a><span
lang=ZH-CN style='font-family:SimSun'>消息数据积压，</span><span lang=EN-US>Kafka</span><span
lang=ZH-CN style='font-family:SimSun'>消费能力不足怎么处理？</span><span lang=ZH-CN> </span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）如果是</span><span lang=EN-US style='color:black'>Kafka</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>消费能力不足，则可以考虑增加</span><span
lang=EN-US style='color:black'>Topic</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的分区数，并且同时提升消费组的消费者数量，消费者数</span><span lang=EN-US
style='color:black'>=</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>分区数。（两者缺一不可）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）如果是下游的数据处理不及时：提高每批次拉取的数量。批次拉取数据过少（拉取数据</span><span
lang=EN-US style='color:black'>/</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>处理时间</span><span lang=EN-US style='color:black'>&lt;</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>生产速度），使处理的数据小于生产的数据，也会造成数据积压。</span></p>

<h2><a name="_Toc29345"></a><a name="_Toc10725207"><span lang=EN-US>4.6 Hive</span></a><span
lang=ZH-CN style='font-family:SimHei'>总结</span></h2>

<h3><a name="_Toc10287"></a><a name="_Toc10725208"><span lang=EN-US>4.6.1 Hive</span></a><span
lang=ZH-CN style='font-family:SimSun'>的架构</span></h3>

<p class=a1 style='margin-left:12.0pt'><span lang=EN-US style='color:black'><img
border=0 width=236 height=182 id="Drawing 5" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image017.jpg"
alt=图片></span></p>

<h3><a name="_Toc22128"></a><a name="_Toc10725209"><span lang=EN-US>4.6.2 Hive</span></a><span
lang=ZH-CN style='font-family:SimSun'>和数据库比较</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive&nbsp;</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>和数据库除了拥有类似的查询语言，再无类似之处。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）数据存储位置</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive&nbsp;</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>存储在</span><span lang=EN-US
style='color:black'>&nbsp;HDFS&nbsp;</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>。数据库将数据保存在块设备或者本地文件系统中。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）数据更新</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中不建议对数据的改写。而数据库中的数据通常是需要经常进行修改的，</span><span lang=ZH-CN
style='color:black'> </span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）执行延迟</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive&nbsp;</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>执行延迟较高。数据库的执行延迟较低。当然，这个是有条件的，即数据规模较小，当数据规模大到超过数据库的处理能力的时候，</span><span
lang=EN-US style='color:black'>Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的并行计算显然能体现出优势。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>4</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）数据规模</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>支持很大规模的数据计算；数据库可以支持的数据规模较小。</span></p>

<h3><a name="_Toc10725210"></a><a name="_Toc18522"><span lang=EN-US>4.6.3 </span></a><span
lang=ZH-CN style='font-family:SimSun'>内部表和外部表</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）管理表：当我们删除一个管理表时，</span><span lang=EN-US style='color:black'>Hive</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>也会删除这个表中数据。管理表不适合和其他工具共享数据。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）外部表：删除该表并不会删除掉原始数据，删除的是表的元数据</span></p>

<h3><a name="_Toc10725211"></a><a name="_Toc69"><span lang=EN-US>4.6.4 4</span></a><span
lang=ZH-CN style='font-family:SimSun'>个</span><span lang=EN-US>By</span><span
lang=ZH-CN style='font-family:SimSun'>区别</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>Sort&nbsp;By</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：分区内有序；</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>Order By</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：全局排序，只有一个</span><span
lang=EN-US style='color:black'>Reducer</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>；</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>Distrbute By</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：类似</span><span lang=EN-US
style='color:black'>MR</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>中</span><span lang=EN-US style='color:black'>Partition</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，进行分区，结合</span><span
lang=EN-US style='color:black'>sort by</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>使用。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>4</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>&nbsp;Cluster
By</span><span lang=ZH-CN style='font-family:SimSun;color:black'>：当</span><span
lang=EN-US style='color:black'>Distribute by</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>Sorts by</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>字段相同时，可以使用</span><span lang=EN-US style='color:black'>Cluster by</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>方式。</span><span lang=EN-US
style='color:black'>Cluster by</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>除了具有</span><span lang=EN-US style='color:black'>Distribute by</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的功能外还兼具</span><span
lang=EN-US style='color:black'>Sort by</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的功能。但是排序只能是升序排序，不能指定排序规则为</span><span lang=EN-US
style='color:black'>ASC</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>或者</span><span lang=EN-US style='color:black'>DESC</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>。</span></p>

<h3><a name="_Toc10725212"></a><a name="_Toc25724"><span lang=EN-US>4.6.5 </span></a><span
lang=ZH-CN style='font-family:SimSun'>窗口函数</span></h3>

<p class=MsoNormal align=left style='margin-top:7.5pt;margin-right:0cm;
margin-bottom:7.5pt;margin-left:21.0pt;text-align:left;background:white'><span
lang=EN-US style='color:black'>RANK() </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>排序相同时会重复，总数不会变</span></p>

<p class=MsoNormal align=left style='margin-top:7.5pt;margin-right:0cm;
margin-bottom:7.5pt;margin-left:21.0pt;text-align:left;background:white'><span
lang=EN-US style='color:black'>DENSE_RANK() </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>排序相同时会重复，总数会减少</span></p>

<p class=MsoNormal align=left style='margin-top:7.5pt;margin-right:0cm;
margin-bottom:7.5pt;margin-left:21.0pt;text-align:left;background:white'><span
lang=EN-US style='color:black'>ROW_NUMBER() </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>会根据顺序计算</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>&nbsp;OVER()</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：指定分析函数工作的数据窗口大小，这个数据窗口大小可能会随着行的变而变化</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>CURRENT ROW</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：当前行</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>n&nbsp;PRECEDING</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：往前</span><span lang=EN-US
style='color:black'>n</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>行数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>4</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>&nbsp;n&nbsp;FOLLOWING</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：往后</span><span lang=EN-US
style='color:black'>n</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>行数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>UNBOUNDED</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：起点，</span><span lang=EN-US
style='color:black'>UNBOUNDED PRECEDING&nbsp;</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>表示从前面的起点，</span><span lang=EN-US
style='color:black'> UNBOUNDED&nbsp;FOLLOWING</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>表示到后面的终点</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>6</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>&nbsp;LAG(col,n)</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：往前第</span><span lang=EN-US
style='color:black'>n</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>行数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>7</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>LEAD(col,n)</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：往后第</span><span lang=EN-US
style='color:black'>n</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>行数据</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>8</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>&nbsp;NTILE(n)</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：把有序分区中的行分发到指定数据的组中，各个组有编号，编号从</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>开始，对于每一行，</span><span lang=EN-US style='color:black'>NTILE</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>返回此行所属的组的编号。注意：</span><span
lang=EN-US style='color:black'>n</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>必须为</span><span lang=EN-US style='color:black'>int</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>类型。</span></p>

<h3><a name="_Toc13604"></a><a name="_Toc10725213"><span lang=EN-US>4.6.6 </span></a><span
lang=ZH-CN style='font-family:SimSun'>自定义</span><span lang=EN-US>UDF</span><span
lang=ZH-CN style='font-family:SimSun'>、</span><span lang=EN-US>UDTF</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>在项目中是否自定义过</span><span
lang=EN-US style='color:black'>UDF</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>UDTF</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>函数，以及用他们处理了什么问题，及自定义步骤？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）自定义过。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）用</span><span lang=EN-US style='color:black'>UDF</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>函数解析公共字段；用</span><span
lang=EN-US style='color:black'>UDTF</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>函数解析事件字段。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span lang=EN-US
style='color:black'>UDF</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>：继承</span><span lang=EN-US style='color:black'>UDF</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，重写</span><span lang=EN-US
style='color:black'>evaluate</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span lang=EN-US
style='color:black'>UDTF</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>：继承自</span><span lang=EN-US style='color:black'>GenericUDTF</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，重写</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>个方法：</span><span lang=EN-US style='color:black'>initialize(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义输出的列名和类型</span><span
lang=EN-US style='color:black'>)</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，</span><span lang=EN-US style='color:black'>process</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（将结果返回</span><span
lang=EN-US style='color:black'>forward(result)</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>），</span><span lang=EN-US
style='color:black'>close</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>为什么要自定义</span><span
lang=EN-US style='color:black'>UDF/UDTF</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，因为自定义函数，可以自己埋点</span><span lang=EN-US
style='color:black'>Log</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>打印日志，出错或者数据异常，方便调试</span><span lang=EN-US style='color:black'>.</span></p>

<h3><a name="_Toc10167"></a><a name="_Toc10725214"><span lang=EN-US>4.6.7 Hive</span></a><span
lang=ZH-CN style='font-family:SimSun'>优化</span></h3>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><b><span
lang=EN-US style='color:black'>1</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>MapJoin</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>如果不指定</span><span lang=EN-US
style='color:black'>MapJoin</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>或者不符合</span><span lang=EN-US style='color:black'>MapJoin</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的条件，那么</span><span
lang=EN-US style='color:black'>Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>解析器会将</span><span lang=EN-US style='color:black'>Join</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>操作转换成</span><span lang=EN-US
style='color:black'>Common Join</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，即：在</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>阶段完成</span><span lang=EN-US
style='color:black'>join</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>。容易发生数据倾斜。可以用</span><span lang=EN-US style='color:black'>MapJoin</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>把小表全部加载到内存在</span><span
lang=EN-US style='color:black'>map</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>端进行</span><span lang=EN-US style='color:black'>join</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，避免</span><span lang=EN-US
style='color:black'>reducer</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>处理。</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><b><span
lang=EN-US style='color:black'>2</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>）行列过滤</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>列处理：在</span><span lang=EN-US
style='color:black'>SELECT</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>中，只拿需要的列，如果有，尽量使用分区过滤，少用</span><span lang=EN-US style='color:black'>SELECT
*</span><span lang=ZH-CN style='font-family:SimSun;color:black'>。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>行处理：在分区剪裁中，当使用外关联时，如果将副表的过滤条件写在</span><span
lang=EN-US style='color:black'>Where</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>后面，那么就会先全表关联，之后再过滤。</span><span lang=ZH-CN
style='color:black'> </span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><b><span
lang=EN-US style='color:black'>3</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>）采用分桶技术</span></b></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><b><span
lang=EN-US style='color:black'>4</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>）采用分区技术</span></b></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><a
name="_Toc374199304"><b><span lang=EN-US style='color:black'>5</span></b></a><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>）合理设置</span><span lang=EN-US
style='color:black'>Map</span></b><b><span lang=ZH-CN style='font-family:SimSun;
color:black'>数</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span></b><b><span lang=ZH-CN style='font-family:SimSun;
color:black'>）通常情况下，作业会通过</span><span lang=EN-US style='color:black'>input</span></b><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>的目录产生一个或者多个</span><span
lang=EN-US style='color:black'>map</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>任务。</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>主要的决定因素有：</span><span
lang=EN-US style='color:black'>input</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的文件总个数，</span><span lang=EN-US style='color:black'>input</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的文件大小，集群设置的文件块大小。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span></b><b><span lang=ZH-CN style='font-family:SimSun;
color:black'>）是不是</span><span lang=EN-US style='color:black'>map</span></b><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>数越多越好？</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>答案是否定的。如果一个任务有很多小文件（远远小于块大小</span><span
lang=EN-US style='color:black'>128m</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>），则每个小文件也会被当做一个块，用一个</span><span lang=EN-US
style='color:black'>map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>任务来完成，而一个</span><span lang=EN-US style='color:black'>map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>任务启动和初始化的时间远远大于逻辑处理的时间，就会造成很大的资源浪费。而且，同时可执行的</span><span
lang=EN-US style='color:black'>map</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>数是受限的。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span></b><b><span lang=ZH-CN style='font-family:SimSun;
color:black'>）是不是保证每个</span><span lang=EN-US style='color:black'>map</span></b><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>处理接近</span><span lang=EN-US
style='color:black'>128m</span></b><b><span lang=ZH-CN style='font-family:SimSun;
color:black'>的文件块，就高枕无忧了？</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>答案也是不一定。比如有一个</span><span
lang=EN-US style='color:black'>127m</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的文件，正常会用一个</span><span lang=EN-US style='color:black'>map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>去完成，但这个文件只有一个或者两个小字段，却有几千万的记录，如果</span><span
lang=EN-US style='color:black'>map</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>处理的逻辑比较复杂，用一个</span><span lang=EN-US style='color:black'>map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>任务去做，肯定也比较耗时。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>针对上面的问题</span><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>和</span><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，我们需要采取两种方式来解决：即减少</span><span
lang=EN-US style='color:black'>map</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>数和增加</span><span lang=EN-US style='color:black'>map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>数；</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><b><span
lang=EN-US style='color:black'>6</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>）小文件进行合并</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>在</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>执行前合并小文件，减少</span><span lang=EN-US style='color:black'>Map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>数：</span><span lang=EN-US
style='color:black'>CombineHiveInputFormat</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>具有对小文件进行合并的功能（系统默认的格式）。</span><span
lang=EN-US style='color:black'>HiveInputFormat</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>没有对小文件合并功能。</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><b><span
lang=EN-US style='color:black'>7</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>）合理设置</span><span lang=EN-US
style='color:black'>Reduce</span></b><b><span lang=ZH-CN style='font-family:
SimSun;color:black'>数</span></b></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个数并不是越多越好</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）过多的启动和初始化</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>也会消耗时间和资源；</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）另外，有多少个</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，就会有多少个输出文件，如果生成了很多个小文件，那么如果这些小文件作为下一个任务的输入，则也会出现小文件过多的问题；</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>在设置</span><span lang=EN-US
style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>个数的时候也需要考虑这两个原则：处理大数据量利用合适的</span><span lang=EN-US
style='color:black'>Reduce</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数；使单个</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>任务处理数据量大小要合适；</span></p>

<p class=MsoListParagraph style='margin-top:6.2pt;margin-right:0cm;margin-bottom:
0cm;margin-left:21.0pt;margin-bottom:.0001pt;text-indent:0cm;line-height:150%'><b><span
lang=EN-US style='color:black'>8</span></b><b><span lang=ZH-CN
style='font-family:SimSun;color:black'>）常用参数</span></b></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-family:DengXian;color:black'>// </span><span lang=ZH-CN
style='font-family:DengXian;color:black'>输出合并小文件</span></p>

<p class=a0><span lang=EN-US>SET hive.merge.mapfiles = true; -- </span><span
lang=ZH-CN style='font-family:SimSun'>默认</span><span lang=EN-US>true</span><span
lang=ZH-CN style='font-family:SimSun'>，在</span><span lang=EN-US>map-only</span><span
lang=ZH-CN style='font-family:SimSun'>任务结束时合并小文件</span></p>

<p class=a0><span lang=EN-US>SET hive.merge.mapredfiles = true; -- </span><span
lang=ZH-CN style='font-family:SimSun'>默认</span><span lang=EN-US>false</span><span
lang=ZH-CN style='font-family:SimSun'>，在</span><span lang=EN-US>map-reduce</span><span
lang=ZH-CN style='font-family:SimSun'>任务结束时合并小文件</span></p>

<p class=a0><span lang=EN-US>SET hive.merge.size.per.task = 268435456; -- </span><span
lang=ZH-CN style='font-family:SimSun'>默认</span><span lang=EN-US>256M</span></p>

<p class=a0><span lang=EN-US>SET hive.merge.smallfiles.avgsize = 16777216; -- </span><span
lang=ZH-CN style='font-family:SimSun'>当输出文件的平均大小小于该值时，启动一个独立的</span><span
lang=EN-US>map-reduce</span><span lang=ZH-CN style='font-family:SimSun'>任务进行文件</span><span
lang=EN-US>merge</span></p>

<h2><a name="_Toc19725"></a><a name="_Toc10725215"><span lang=EN-US>4.7 HBase</span></a><span
lang=ZH-CN style='font-family:SimHei'>总结</span></h2>

<h3><a name="_Toc9677"></a><a name="_Toc10725216"><span lang=EN-US>4.7.1 HBase</span></a><span
lang=ZH-CN style='font-family:SimSun'>存储结构</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=414 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image018.jpg"></span></p>

<h3><a name="_Toc16756"></a><a name="_Toc10725217"><span lang=EN-US>4.7.2 rowkey</span></a><span
lang=ZH-CN style='font-family:SimSun'>设计原则</span></h3>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>1</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span></b><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>rowkey</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>长度原则</span></b></p>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>2</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span></b><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>rowkey</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>散列原则</span></b></p>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>3</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span></b><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>rowkey</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>唯一原则</span></b></p>

<h3><a name="_Toc15413"></a><a name="_Toc10725218"><span lang=EN-US>4.7.3
RowKey</span></a><span lang=ZH-CN style='font-family:SimSun'>如何设计</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）生成随机数、</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>hash</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>、散列值</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）字符串反转</span></p>

<h3><a name="_Toc10725219"></a><a name="_Toc25733"><span lang=EN-US>4.7.4
Phoenix</span></a><span lang=ZH-CN style='font-family:SimSun'>二级索引</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><a
name="_MON_1613543761"></a><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>&nbsp;</span></p>

<h2><a name="_Toc23759"></a><a name="_Toc10725220"><span lang=EN-US>4.8 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimHei'>参数</span></h2>

<p class=a0><span lang=EN-US>/opt/module/sqoop/bin/sqoop import \</span></p>

<p class=a0><span lang=EN-US>--connect \</span></p>

<p class=a0><span lang=EN-US>--username \</span></p>

<p class=a0><span lang=EN-US>--password \</span></p>

<p class=a0><span lang=EN-US>--target-dir \</span></p>

<p class=a0><span lang=EN-US>--delete-target-dir \</span></p>

<p class=a0><span lang=EN-US>--num-mappers \</span></p>

<p class=a0><span lang=EN-US>--fields-terminated-by &nbsp; \</span></p>

<p class=a0><span lang=EN-US>--query &nbsp; &quot;$2&quot; ' and $CONDITIONS;'</span></p>

<h3><a name="_Toc12147"></a><a name="_Toc10725221"><span lang=EN-US>4.8.1 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>导入导出</span><span lang=EN-US>Null</span><span
lang=ZH-CN style='font-family:SimSun'>存储一致性问题</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中的</span><span lang=EN-US style='color:black'>Null</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>在底层是以“</span><span
lang=EN-US style='color:black'>\N</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>”来存储，而</span><span lang=EN-US style='color:black'>MySQL</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>中的</span><span lang=EN-US
style='color:black'>Null</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>在底层就是</span><span lang=EN-US style='color:black'>Null</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，为了保证数据两端的一致性。在导出数据时采用</span><span
lang=EN-US style='color:black'>--input-null-string</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>--input-null-non-string</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>两个参数。导入数据时采用</span><span lang=EN-US
style='color:black'>--null-string</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>和</span><span lang=EN-US style='color:black'>--null-non-string</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>。</span></p>

<h3><a name="_Toc10725222"></a><a name="_Toc6001"><span lang=EN-US>4.8.2 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>数据导出一致性问题</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）场景</span><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：如</span><span lang=EN-US
style='color:black'>Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>在导出到</span><span lang=EN-US style='color:black'>Mysql</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>时，使用</span><span lang=EN-US
style='color:black'>4</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>个</span><span lang=EN-US style='color:black'>Map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>任务，过程中有</span><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个任务失败，那此时</span><span lang=EN-US style='color:black'>MySQL</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>中存储了另外两个</span><span
lang=EN-US style='color:black'>Map</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>任务导入的数据，此时老板正好看到了这个报表数据。而开发工程师发现任务失败后，会调试问题并最终将全部数据正确的导入</span><span
lang=EN-US style='color:black'>MySQL</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，那后面老板再次看报表数据，发现本次看到的数据与之前的不一致，这在生产环境是不允许的。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>官网：</span><span lang=EN-US
style='color:black'>http://sqoop.apache.org/docs/1.4.6/SqoopUserGuide.html</span></p>

<p class=a0><span lang=EN-US>Since Sqoop breaks down export process into
multiple transactions, it is possible that a failed export job may result in
partial data being committed to the database. This can further lead to
subsequent jobs failing due to insert collisions in some cases, or lead to
duplicated data in others. You can overcome this problem by specifying a
staging table via the&nbsp;--staging-table&nbsp;option which acts as an
auxiliary table that is used to stage exported data. The staged data is finally
moved to the destination table in a single transaction.</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>–staging-table</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>方式</span></p>

<p class=a0><span lang=EN-US>sqoop export --connect jdbc:mysql://192.168.137.10:3306/user_behavior
--username root --password 123456 --table app_cource_study_report --columns
watch_video_cnt,complete_video_cnt,dt --fields-terminated-by &quot;\t&quot;
--export-dir &quot;/user/hive/warehouse/tmp.db/app_cource_study_analysis_${day}&quot;
--staging-table app_cource_study_report_tmp --clear-staging-table
--input-null-string '\N'</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）场景</span><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：设置</span><span lang=EN-US
style='color:black'>map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数量为</span><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>个（不推荐，面试官想要的答案不只这个）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>多个</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>任务时，采用</span><span lang=EN-US style='color:black'>–staging-table</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>方式，仍然可以解决数据一致性问题。</span></p>

<h3><a name="_Toc18536"></a><a name="_Toc10725223"><span lang=EN-US>4.8.3 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>底层运行的任务是什么</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>只有</span><span lang=EN-US
style='color:black'>Map</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>阶段，没有</span><span lang=EN-US style='color:black'>Reduce</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>阶段的任务。</span></p>

<h3><a name="_Toc8351"></a><a name="_Toc10725224"><span lang=EN-US>4.8.4 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>数据导出的时候一次执行多长时间</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Sqoop</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>任务</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>5</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>分钟</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>-2</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>个小时的都有。取决于数据量。</span></p>

<h2><a name="_Toc9426"></a><a name="_Toc10725225"><span lang=EN-US>4.9 Scala</span></a></h2>

<h3><a name="_Toc18214"></a><a name="_Toc10725226"><span lang=EN-US>4.9.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>元组</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）元组的创建</span></p>

<p class=a0><span lang=EN-US>val tuple1 = (1, 2, 3, &quot;heiheihei&quot;)</span></p>

<p class=a0><span lang=EN-US>println(tuple1)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）元组数据的访问，注意元组元素的访问有下划线，并且访问下标从</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>开始，而不是</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>0</span></p>

<p class=a0><span lang=EN-US>val value1 = tuple1._4</span></p>

<p class=a0><span lang=EN-US>println(value1)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）元组的遍历</span></p>

<p class=a0><span lang=ZH-CN style='font-family:SimSun'>方式</span><span
lang=EN-US>1</span><span lang=ZH-CN style='font-family:SimSun'>：</span></p>

<p class=a0><span lang=EN-US>for (elem &lt;- tuple1.productIterator  ) {</span></p>

<p class=a0><span lang=EN-US>   print(elem)</span></p>

<p class=a0><span lang=EN-US>}</span></p>

<p class=a0><span lang=EN-US>println()</span></p>

<p class=a0><span lang=ZH-CN style='font-family:SimSun'>方式</span><span
lang=EN-US>2</span><span lang=ZH-CN style='font-family:SimSun'>：</span></p>

<p class=a0><span lang=EN-US>tuple1.productIterator.foreach(i =&gt; println(i))</span></p>

<p class=a0><span lang=EN-US>tuple1.produIterator.foreach(print(_))</span></p>

<h3><a name="_Toc4884"></a><a name="_Toc10725227"><span lang=EN-US>4.9.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>隐式转换</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>隐式转换函数是以</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>implicit</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>关键字声明的带有单个参数的函数。这种函数将会自动应用，将值从一种类型转换为另一种类型。</span></p>

<p class=a0><span lang=EN-US>implicit def a(d: Double) = d.toInt</span></p>

<p class=a0><span lang=EN-US>//</span><span lang=ZH-CN style='font-family:SimSun'>不加上边这句你试试</span></p>

<p class=a0><span lang=EN-US>val i1: Int = 3.5</span></p>

<p class=a0><span lang=EN-US>println(i1)</span></p>

<h3><a name="_Toc6007"></a><a name="_Toc10725228"><span lang=EN-US>4.9.3 </span></a><span
lang=ZH-CN style='font-family:SimSun'>函数式编程理解</span></h3>

<p class=a1 style='margin-left:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Scala</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中函数的地位：一等公民</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>&nbsp;<br>
2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:
SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Scala</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中的匿名函数</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>(</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>函数字面量</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>)&nbsp;<br>
3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:
SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Scala</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中的高阶函数</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>&nbsp;<br>
4</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:
SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Scala</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中的闭包</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>&nbsp;<br>
5</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:
SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Scala</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中的柯里化函数</span></p>

<h3><a name="_Toc3830"></a><a name="_Toc10725229"><span lang=EN-US>4.9.4 </span></a><span
lang=ZH-CN style='font-family:SimSun'>样例类</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>case class Person(name:String,age:Int)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>一般使用在</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> ds=df.as[Person]</span></p>

<h3><a name="_Toc10725230"></a><a name="_Toc8948"><span lang=EN-US>4.9.5 </span></a><span
lang=ZH-CN style='font-family:SimSun'>柯里化</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>函数编程中，接受多个参数的函数都可以转化为接受单个参数的函数，这个转化过程就叫柯里化，柯里化就是证明了函数只需要一个参数而已。其实我们刚的学习过程中，已经涉及到了柯里化操作，所以这也印证了，柯里化就是以函数为主体这种思想发展的必然产生的结果。</span></p>

<p class=a1><span lang=EN-US style='font-size:10.5pt;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;font-family:SimSun;
color:black'>）柯里化的示例</span></p>

<p class=a0><span lang=EN-US>def mul(x: Int, y: Int) = x * y</span></p>

<p class=a0><span lang=EN-US>println(mul(10, 10))</span></p>

<p class=a0><span lang=EN-US>def mulCurry(x: Int) = (y: Int) =&gt; x * y</span></p>

<p class=a0><span lang=EN-US>println(mulCurry(10)(9))</span></p>

<p class=a0><span lang=EN-US>def mulCurry2(x: Int)(y:Int) = x * y</span></p>

<p class=a0><span lang=EN-US>println(mulCurry2(10)(8))</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>2</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）柯里化的应用</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>比较两个字符串在忽略大小写的情况下是否相等，注意，这里是两个任务：</span></p>

<p class=a1 style='margin-left:42.0pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:Wingdings;
color:black'>l<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>全部转大写（或小写）</span></p>

<p class=a1 style='margin-left:42.0pt;text-indent:-21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:Wingdings;
color:black'>l<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>比较是否相等</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>针对这两个操作，我们用一个函数去处理的思想，其实无意间也变成了两个函数处理的思想。示例如下：</span></p>

<p class=a0><span lang=EN-US>val a = Array(&quot;Hello&quot;,
&quot;World&quot;)</span></p>

<p class=a0><span lang=EN-US>val b = Array(&quot;hello&quot;,
&quot;world&quot;)</span></p>

<p class=a0><span lang=EN-US>println(a.corresponds(b)(_.equalsIgnoreCase(_)))</span></p>

<p class=a0><span lang=ZH-CN style='font-family:SimSun'>其中</span><span
lang=EN-US>corresponds</span><span lang=ZH-CN style='font-family:SimSun'>函数的源码如下：</span></p>

<p class=a0><span lang=EN-US>def corresponds[B](that: GenSeq[B])(p: (A,B) =&gt;
Boolean): Boolean = {</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>val i = this.iterator</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>val j = that.iterator</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>while (i.hasNext &amp;&amp; j.hasNex  t)</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>  if (!p(i.next(), j.next()    ))</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>    return fals</span></p>

<p class=a0><span lang=EN-US>!i.hasNext &amp;&amp; !j.hasNext</span></p>

<p class=a0><span lang=EN-US>}</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>尖叫提示：不要设立柯里化存在义这样的命题，柯里化，是面向函数思想的必然产生结果。</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;</span></p>

<h3><a name="_Toc7740"></a><a name="_Toc10725231"><span lang=EN-US>4.9.6 </span></a><span
lang=ZH-CN style='font-family:SimSun'>闭包</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>一个函数把外部的那些不属于自己的对象也包含</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>(</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>闭合</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>)</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进来。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>案例</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>：</span></p>

<p class=a0><span lang=EN-US>def minusxy(x: Int) = (y: Int) =&gt; x - y</span></p>

<p class=a0><span lang=ZH-CN style='font-family:SimSun'>这就是一个闭包：</span></p>

<p class=a0><span lang=EN-US>1) </span><span lang=ZH-CN style='font-family:
SimSun'>匿名函数</span><span lang=EN-US>(y: Int) =&gt; x -y</span><span lang=ZH-CN
style='font-family:SimSun'>嵌套在</span><span lang=EN-US>minusxy</span><span
lang=ZH-CN style='font-family:SimSun'>函数中。</span></p>

<p class=a0><span lang=EN-US>2) </span><span lang=ZH-CN style='font-family:
SimSun'>匿名函数</span><span lang=EN-US>(y: Int) =&gt; x -y</span><span lang=ZH-CN
style='font-family:SimSun'>使用了该匿名函数之外的变量</span><span lang=EN-US>x</span></p>

<p class=a0><span lang=EN-US>3) </span><span lang=ZH-CN style='font-family:
SimSun'>函数</span><span lang=EN-US>minusxy</span><span lang=ZH-CN
style='font-family:SimSun'>返回了引用了局部变量的匿名函数</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>案例</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span></p>

<p class=a0><span lang=EN-US>def minusxy(x: Int) = (y: Int) =&gt; x - y</span></p>

<p class=a0><span lang=EN-US>val f1 = minusxy(10)</span></p>

<p class=a0><span lang=EN-US>val f2 = minusxy(10)</span></p>

<p class=a0><span lang=EN-US>println(f1(3) + f2(3))</span></p>

<p class=a0><span lang=ZH-CN style='font-family:SimSun'>此处</span><span
lang=EN-US>f1,f2</span><span lang=ZH-CN style='font-family:SimSun'>这两个函数就叫闭包。</span></p>

<h3><a name="_Toc21133"></a><a name="_Toc10725232"><span lang=EN-US>4.9.7 Some</span></a><span
lang=ZH-CN style='font-family:SimSun'>、</span><span lang=EN-US>None</span><span
lang=ZH-CN style='font-family:SimSun'>、</span><span lang=EN-US>Option</span><span
lang=ZH-CN style='font-family:SimSun'>的正确使用</span></h3>

<p class=a0><span lang=EN-US>val map = Map(&quot;Tom&quot;-&gt; 23)</span></p>

<p class=a0><span lang=EN-US>map(&quot;Jack&quot;) // </span><span lang=ZH-CN
style='font-family:SimSun'>抛出异常</span><span lang=ZH-CN> </span><span
lang=EN-US>java.util.NoSuchElementException: key not found: Jack</span></p>

<p class=a0><span lang=EN-US>map.get(&quot;Jack&quot;) // None</span></p>

<p class=a0><span lang=EN-US>map(&quot;Tom&quot;) // 23</span></p>

<p class=a0><span lang=EN-US>map.get(&quot;Tom&quot;) // Some(23)</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=ZH-CN style='font-family:SimSun'>使用模式匹配取出最后结果</span></p>

<p class=a0><span lang=EN-US>val optionAge = map.get(&quot;Tom&quot;)</span></p>

<p class=a0><span lang=EN-US>val age = optionAge match {</span></p>

<p class=a0><span lang=EN-US> case Some(x) =&gt; optionAge.get</span></p>

<p class=a0><span lang=EN-US> case None =&gt; 0</span></p>

<p class=a0><span lang=EN-US>}</span></p>

<h2><a name="_Toc8013"></a><a name="_Toc10725233"><span lang=EN-US>4.10 Spark</span></a></h2>

<h3><a name="_Toc10080"></a><a name="_Toc10725234"><span lang=EN-US>4.10.1
Spark</span></a><span lang=ZH-CN style='font-family:SimSun'>有几种部署方式？请分别简要论述</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Local:</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>运行在一台机器上，通常是练手或者测试环境。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Standalone:</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>构建一个基于</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>Mster+Slaves</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的资源调度集群，</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Spark</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>任务提交给</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>Master</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>运行。是</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>Spark</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>自身的一个调度系统。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Yarn: Spark</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>客户端直接连接</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>Yarn</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，不需要额外构建</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Spark</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>集群。有</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>yarn-client</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>和</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>yarn-cluster</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>两种模式，主要区别在于：</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Driver</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>程序的运行节点。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>4</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Mesos</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：国内大环境比较少用。</span></p>

<h3><a name="_Toc477"></a><a name="_Toc10725235"><span lang=EN-US>4.10.2 Spark</span></a><span
lang=ZH-CN style='font-family:SimSun'>任务使用什么进行提交，</span><span lang=EN-US>javaEE</span><span
lang=ZH-CN style='font-family:SimSun'>界面还是脚本</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>Shell </span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>脚本。</span></p>

<h3><a name="_Toc8504"></a><a name="_Toc10725236"><span lang=EN-US>4.10.3 Spark</span></a><span
lang=ZH-CN style='font-family:SimSun'>提交作业参数（重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>参考答案：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>https://blog.csdn.net/gamer_gyt/article/details/79135118</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）在提交任务时的几个重要参数</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>executor-cores —— </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>每个</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>executor</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>使用的内核数，默认为</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>，官方建议</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>2-5</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>个，我们企业是</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>4</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>个</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>num-executors —— </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>启动</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>executors</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的数量，默认为</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>executor-memory —— executor</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>内存大小，默认</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1G</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>driver-cores —— driver</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>使用内核数，默认为</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>driver-memory —— driver</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>内存大小，默认</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>512M</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）边给一个提交任务的样式</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>spark-submit \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --master local[5]  \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --driver-cores 2   \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --driver-memory 8g \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --executor-cores 4 \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --num-executors 10 \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --executor-memory 8g \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --class PackageName.ClassName XXXX.jar \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  --name &quot;Spark Job Name&quot; \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  InputPath      \</span></p>

<p class=a1 style='margin-left:21.0pt;text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>  OutputPath</span></p>

<h3><a name="_Toc25059"></a><a name="_Toc10725237"><span lang=EN-US>4.10.4 </span></a><span
lang=ZH-CN style='font-family:SimSun'>简述</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>的架构与作业提交流程（画图讲解，注明各个部分的作用）（重点）</span></h3>

<p class=a1 style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=416 height=234 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image019.jpg"></span></p>

<h3><a name="_Toc10725238"></a><a name="_Toc541"><span lang=EN-US>4.10.5 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何理解</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>中的血统概念（</span><span lang=EN-US>RDD</span><span
lang=ZH-CN style='font-family:SimSun'>）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>在</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>Lineage</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>依赖方面分为两种</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Narrow
Dependencies</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>与</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Wide
Dependencies</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>用来解决数据容错时的高效性以及划分任务时候起到重要作用。</span></p>

<h3><a name="_Toc10725239"></a><a name="_Toc32627"><span lang=EN-US>4.10.6 </span></a><span
lang=ZH-CN style='font-family:SimSun'>简述</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>的宽窄依赖，以及</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>如何划分</span><span lang=EN-US>stage</span><span
lang=ZH-CN style='font-family:SimSun'>，每个</span><span lang=EN-US>stage</span><span
lang=ZH-CN style='font-family:SimSun'>又根据什么决定</span><span lang=EN-US>task</span><span
lang=ZH-CN style='font-family:SimSun'>个数</span><span lang=EN-US>? </span><span
lang=ZH-CN style='font-family:SimSun'>（笔试重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Stage</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>：根据</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>之间的依赖关系的不同将</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Job</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>划分成不同的</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Stage</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，遇到一个宽依赖则划分一个</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Stage</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Task</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>：</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>Stage</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>是一个</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>TaskSet</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，将</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>Stage</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>根据分区数划分成一个个的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Task</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>。</span></p>

<h3><a name="_Toc10725240"></a><a name="_Toc8021"><span lang=EN-US>4.10.7 </span></a><span
lang=ZH-CN style='font-family:SimSun'>请列举</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>的</span><span lang=EN-US>transformation</span><span
lang=ZH-CN style='font-family:SimSun'>算子（不少于</span><span lang=EN-US>8</span><span
lang=ZH-CN style='font-family:SimSun'>个），并简述功能（重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>map</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>func</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>）：返回一个新的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，该</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>由每一个输入元素经过</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>func</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>函数转换后组成</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>.</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>mapPartitions(func)</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：类似于</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>map</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，但独立地在</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>RDD</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的每一个分片上运行，因此在类型为</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>T</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>RD</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>上运行时，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>func</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的函数类型必须是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Iterator[T] =&gt; Iterator[U]</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>。假设有</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>N</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>个元素，有</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>M</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>个分区，那么</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>map</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的函数的将被调用</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>N</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>次</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>,</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>而</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>mapPartitions</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>被调用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>M</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>次</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>,</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>一个函数一次处理所有分区。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>reduceByKey</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>（</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>func</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>[numTask]</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）：在一个</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>(K,V)</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>RDD</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>上调用，返回一个</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>(K,V)</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>RDD</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>，使用定的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>reduce</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>函数，将相同</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>key</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的值聚合到一起，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>reduce</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>任务的个数可以通过第二个可选的参数来设置。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>4</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>aggregateByKey&nbsp;(zeroValue:U,[partitioner:&nbsp;Partitioner])&nbsp;(seqOp:
(U, V) =&gt; U,combOp: (U, U) =&gt; U:&nbsp;</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>在</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>kv</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>对的</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中，，按</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>key</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>将</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>value</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进行分组合并，合并时，将每个</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>value</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>和初始值作为</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>seq</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>函数的参数，进行计算，返回的结果作为一个新的</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>kv</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>对，然后再将结果按照</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>key</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进行合并，最后将每个分组的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>value</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>传递给</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>combine</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>函数进行计算（先将前两个</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>value</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进行计算，将返回结果和下一个</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>value</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>传给</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>combine</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>函数，以此类推），将</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>key</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>与计算结果作为一个新的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>kv</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>对输出。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> 5</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>combineByKey(createCombiner:
V=&gt;C, mergeValue: (C, V) =&gt;C, mergeCombiners: (C, C) =&gt;C):</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>对相同</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>K</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>，把</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>V</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>合并成一个集合。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1.createCombiner: combineByKey() </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>会遍历分区中的所有元素，因此每个元素的键要么还没有遇到过，要么就和之前的某个元素的键相同。如果这是一个新的元素</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>,combineByKey()</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>会使用一个叫作</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>createCombiner()</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的函数来创建那个键对应的累加器的初始值</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2.mergeValue:&nbsp;</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>如果这是一个在处理当前分区之前已经遇到的键，它会使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>mergeValue()</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法将该键的累加器对应的当前值与这个新的值进行合并</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3.mergeCombiners:&nbsp;</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>由于每个分区都是独立处理的，</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>因此对于同一个键可以有多个累加器。如果有两个或者更多的分区都有对应同一个键的累加器，</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>就需要使用用户提供的</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> mergeCombiners() </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法将各个分区的结果进行合并。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>…</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>根据自身情况选择比较熟悉的算子加以介绍。</span></p>

<h3><a name="_Toc10725241"></a><a name="_Toc8752"><span lang=EN-US>4.10.8 </span></a><span
lang=ZH-CN style='font-family:SimSun'>请列举</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>的</span><span lang=EN-US>action</span><span
lang=ZH-CN style='font-family:SimSun'>算子（不少于</span><span lang=EN-US>6</span><span
lang=ZH-CN style='font-family:SimSun'>个），并简述功能（重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>reduce</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>collect:</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>first</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>4</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>take</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>5</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>aggregate</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>6</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>countByKey</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>7</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>foreach</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>8</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>saveAsTextFile</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<h3><a name="_Toc10725242"></a><a name="_Toc13194"><span lang=EN-US>4.10.9 </span></a><span
lang=ZH-CN style='font-family:SimSun'>请列举会引起</span><span lang=EN-US>Shuffle</span><span
lang=ZH-CN style='font-family:SimSun'>过程的</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>算子，并简述功能。</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>reduceBykey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>groupByKey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>…ByKey:</span></p>

<h3><a name="_Toc10725243"></a><a name="_Toc11628"><span lang=EN-US>4.10.10 </span></a><span
lang=ZH-CN style='font-family:SimSun'>简述</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>的两种核心</span><span lang=EN-US>Shuffle</span><span
lang=ZH-CN style='font-family:SimSun'>（</span><span lang=EN-US>HashShuffle</span><span
lang=ZH-CN style='font-family:SimSun'>与</span><span lang=EN-US>SortShuffle</span><span
lang=ZH-CN style='font-family:SimSun'>）的工作流程（包括未优化的</span><span lang=EN-US>HashShuffle</span><span
lang=ZH-CN style='font-family:SimSun'>、优化的</span><span lang=EN-US>HashShuffle</span><span
lang=ZH-CN style='font-family:SimSun'>、普通的</span><span lang=EN-US>SortShuffle</span><span
lang=ZH-CN style='font-family:SimSun'>与</span><span lang=EN-US>bypass</span><span
lang=ZH-CN style='font-family:SimSun'>的</span><span lang=EN-US>SortShuffle</span><span
lang=ZH-CN style='font-family:SimSun'>）（重点）</span></h3>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;color:black'>未经优化的</span><span
lang=EN-US style='color:black'>HashShuffle</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>：</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=397 height=225 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image020.jpg"></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;color:black'>优化后的</span><span
lang=EN-US style='color:black'>Shuffle</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>：</span></p>

<p class=MsoNormal><span lang=ZH-CN style='color:black'><img border=0
width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image021.jpg"></span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;color:black'>普通的</span><span
lang=ZH-CN style='color:black'>SortShuffle</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='line-height:150%;color:black'><img border=0 width=419 height=240
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image022.jpg"></span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>当</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> shuffle read task </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>数</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'> </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>量</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'> </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>小</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>于</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'> </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>等</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'> </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>于</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> spark.shuffle.sort</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>bypassMergeThreshold
</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:
SimSun;color:black'>参数的值时（默认为</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'> 200</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>），就会启用</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'> bypass </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>机制。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=392 height=273 id="Drawing 9" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image023.jpg"
alt=图片></span></p>

<h3><a name="_Toc10725244"></a><a name="_Toc745"><span lang=EN-US>4.10.11 Spark</span></a><span
lang=ZH-CN style='font-family:SimSun'>常用算子</span><span lang=EN-US>reduceByKey</span><span
lang=ZH-CN style='font-family:SimSun'>与</span><span lang=EN-US>groupByKey</span><span
lang=ZH-CN style='font-family:SimSun'>的区别，哪一种更具优势？（重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>reduceByKey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>：按照</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>key</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>进行聚合，在</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>shuffle</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>之前有</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>combine</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>（预聚合）操作，返回结果是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD[k,v]</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>groupByKey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>：按照</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>key</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>进行分组，直接进行</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>shuffle</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>开发指导：</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>reduceByKey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>比</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>groupByKey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>，建议使用。但是需要注意是否会影响业务逻辑。</span></p>

<h3><a name="_Toc4661"></a><a name="_Toc10725245"><span lang=EN-US>4.10.12 Repartition</span></a><span
lang=ZH-CN style='font-family:SimSun'>和</span><span lang=EN-US>Coalesce</span><span
lang=ZH-CN style='font-family:SimSun'>关系与区别</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）关系：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>两者都是用来改变</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>partition</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>数量的，</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>repartition</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>底层调用的就是</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>coalesce</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>方法：</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>coalesce(numPartitions,
shuffle = true)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）区别：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>repartition</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>一定会发生</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>shuffle</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>coalesce</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>根据传入的参数来判断是否发生</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>shuffle</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>一般情况下增大</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>rdd</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>partition</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>数量使用</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>repartition</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，减少</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>partition</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>数量时使用</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>coalesce</span></p>

<h3><a name="_Toc10725246"></a><a name="_Toc27003"><span lang=EN-US>4.10.13 </span></a><span
lang=ZH-CN style='font-family:SimSun'>分别简述</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>中的缓存机制（</span><span lang=EN-US>cache</span><span
lang=ZH-CN style='font-family:SimSun'>和</span><span lang=EN-US>persist</span><span
lang=ZH-CN style='font-family:SimSun'>）与</span><span lang=EN-US>checkpoint</span><span
lang=ZH-CN style='font-family:SimSun'>机制，并指出两者的区别与联系</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>都是做</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>持久化的</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>cache:</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>内存，不会截断血缘关系，使用计算过程中的数据缓存。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>checkpoint</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>：磁盘，截断血缘关系，在</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>ck</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>之前必须没有任何任务提交才会生效，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>ck</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>过程会额外提交一次任务。</span></p>

<h3><a name="_Toc10725247"></a><a name="_Toc30429"><span lang=EN-US>4.10.14 </span></a><span
lang=ZH-CN style='font-family:SimSun'>简述</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>中共享变量（广播变量和累加器）的基本原理与用途。（重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>累加器（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>accumulator</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Spark</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中提供的一种分布式的变量机制，其原理类似于</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>mapreduce</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>，即分布式的改变，然后聚合这些改变。累加器的一个常见用途是在调试时对作业执行过程中的事件进行计数。而广播变量用来高效分发较大的对象。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>共享变量出现的原因：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>通常在向</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;Spark </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>传递函数时，比如使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> map() </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>函数或者用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> filter() </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>传条件时，可以使用驱动器程序中定义的变量，但是集群中运行的每个任务都会得到这些变量的一份新的副本，更新这些副本的值也不会影响驱动器中的对应变量。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Spark</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的两个共享变量，累加器与广播变量，分别为结果聚合与广播这两种常见的通信模式突破了这一限制。</span></p>

<h3><a name="_Toc27912"></a><a name="_Toc10725248"><span lang=EN-US>4.10.15 </span></a><span
lang=ZH-CN style='font-family:SimSun'>当</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>涉及到数据库的操作时，如何减少</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>运行中的数据库连接数？</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>foreachPartition</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>代替</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>foreach</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，在</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>foreachPartition</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>内获取数据库的连接。</span></p>

<h3><a name="_Toc26567"></a><a name="_Toc10725249"><span lang=EN-US>4.10.16 </span></a><span
lang=ZH-CN style='font-family:SimSun'>简述</span><span lang=EN-US>SparkSQL</span><span
lang=ZH-CN style='font-family:SimSun'>中</span><span lang=EN-US>RDD</span><span
lang=ZH-CN style='font-family:SimSun'>、</span><span lang=EN-US>DataFrame</span><span
lang=ZH-CN style='font-family:SimSun'>、</span><span lang=EN-US>DataSet</span><span
lang=ZH-CN style='font-family:SimSun'>三者的区别与联系</span><span lang=EN-US>? </span><span
lang=ZH-CN style='font-family:SimSun'>（笔试重点）</span></h3>

<p class=a1><b><span lang=EN-US style='font-size:10.5pt;font-family:SimSun;
color:black'>1</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
font-family:SimSun;color:black'>）</span></b><b><span lang=EN-US
style='font-size:10.5pt;font-family:SimSun;color:black'>RDD</span></b></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>优点</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>:</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>编译时类型安全</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>&nbsp;</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>编译时就能检查出类型错误</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>面向对象的编程风格</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>&nbsp;</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>直接通过类名点的方式来操作数据</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>缺点</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>:</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>序列化和反序列化的性能开销</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>&nbsp;</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>无论是集群间的通信</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>, </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>还是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>IO</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>操作都需要对对象的结构和数据进行序列化和反序列化。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>GC</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>的性能开销，频繁的创建和销毁对象</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>, </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>势必会增加</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>GC</span></p>

<p class=a1><b><span lang=EN-US style='font-size:10.5pt;font-family:SimSun;
color:black'>2</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
font-family:SimSun;color:black'>）</span></b><b><span lang=EN-US
style='font-size:10.5pt;font-family:SimSun;color:black'>DataFrame</span></b></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>DataFrame</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>引入了</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>schema</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>和</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>off-heap</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>schema : RDD</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>每一行的数据</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>, </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>结构都是一样的，这个结构就存储在</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>schema</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中。</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>&nbsp;Spark</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>通过</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>schema</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>就能够读懂数据</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>, </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>因此在通信和</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>IO</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>时就只需要序列化和反序列化数据</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>, </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>而结构的部分就可以省略了。</span></p>

<p class=a1><b><span lang=EN-US style='font-size:10.5pt;font-family:SimSun;
color:black'>3</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
font-family:SimSun;color:black'>）</span></b><b><span lang=EN-US
style='font-size:10.5pt;font-family:SimSun;color:black'>DataSet</span></b></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>DataSet</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>结合了</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>RDD</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>和</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>DataFrame</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的优点，并带来的一个新的概念</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Encoder</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>。</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>当序列化数据时，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Encoder</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>产生字节码与</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>off-heap</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进行交互，能够达到按需访问数据的效果，而不用反序列化整个对象。</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>Spark</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>还没有提供自定义</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>Encoder</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>API</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>，但是未来会加入。</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>三者之间的转换：</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=440 height=249 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image024.jpg"></span></p>

<h3><a name="_Toc10725250"></a><a name="_Toc30524"><span lang=EN-US>4.10.17
SparkSQL</span></a><span lang=ZH-CN style='font-family:SimSun'>中</span><span
lang=EN-US>join</span><span lang=ZH-CN style='font-family:SimSun'>操作与</span><span
lang=EN-US>left&nbsp;join</span><span lang=ZH-CN style='font-family:SimSun'>操作的区别？</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>join</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>和</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>sql</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中的</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>inner join</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>操作很相似，返回结果是前面一个集合和后面一个集合中匹配成功的，过滤掉关联不上的。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>leftJoin</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>类似于</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>SQL</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中的左外关联</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>left outer join</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>，返回结果以第一个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDD</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>为主，关联不上的记录为空。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>部分场景下可以使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>left semi join</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>替代</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>left join</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>因为</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> left semi join </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> in(keySet) </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的关系，<b>遇到右表重复记录，左表会跳过</b></span><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>,</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>性能更高</span></b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，而</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'> left join </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>则会一直遍历。但是</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>left semi
join </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>中最后</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>
select </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>的结果中只许出现左表中的列名，因为右表只有</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> join key </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>参与关联计算了</span></p>

<h3><a name="_Toc17268"></a><a name="_Toc10725251"><span lang=EN-US>4.10.18
SparkStreaming</span></a><span lang=ZH-CN style='font-family:SimSun'>有哪几种方式消费</span><span
lang=EN-US>Kafka</span><span lang=ZH-CN style='font-family:SimSun'>中的数据，它们之间的区别是什么？</span><span
lang=ZH-CN> </span></h3>

<p class=a1><b><span lang=ZH-CN style='font-size:10.5pt;font-family:SimSun;
color:black'>一、基于</span></b><b><span lang=EN-US style='font-size:10.5pt;
font-family:SimSun;color:black'>Receiver</span></b><b><span lang=ZH-CN
style='font-size:10.5pt;font-family:SimSun;color:black'>的方式</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>这种方式使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Receiver</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>来获取数据。</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>Receiver</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>是使用</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>的高层次</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Consumer API</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>来实现的。</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>receiver</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>从</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>中获取的数据都是存储在</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Spark Executor</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的内存中的（如果突然数据暴增，大量</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>batch</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>堆积，很容易出现内存溢出的问题），然后</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Spark Streaming</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>启动的</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>job</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>会去处理那些数据。 </span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>然而，在默认的配置下，这种方式可能会因为底层的失败而丢失数据。如果要启用高可靠机制，让数据零丢失，就必须启用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Spark Streaming</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的预写日志机制（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Write Ahead Log</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>WAL</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）。该机制会同步地将接收到的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>数据写入分布式文件系统（比如</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>HDFS</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>）上的预写日志中。所以，即使底层节点出现了失败，也可以使用预写日志中的数据进行恢复。</span></p>

<p class=a1><b><span lang=ZH-CN style='font-size:10.5pt;font-family:SimSun;
color:black'>二、基于</span></b><b><span lang=EN-US style='font-size:10.5pt;
font-family:SimSun;color:black'>Direct</span></b><b><span lang=ZH-CN
style='font-size:10.5pt;font-family:SimSun;color:black'>的方式</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>这种新的不基于</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Receiver</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的直接方式，是在</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Spark 1.3</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>中引入的，从而能够确保更加健壮的机制。替代掉使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Receiver</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>来接收数据后，这种方式会周期性地查询</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Kafka</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，来获得每个</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>topic+partition</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的最新的</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>offset</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>，从而定义每个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>batch</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>offset</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的范围。当处理数据的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>job</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>启动时，就会使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Kafka</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的简单</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>consumer
api</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:
SimSun;color:black'>来获取</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>指定</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>offset</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>范围的数据。 </span></p>

<p class=a1><b><span lang=ZH-CN style='font-size:10.5pt;font-family:SimSun;
color:black'>优点如下：</span></b><b><span lang=EN-US style='font-size:10.5pt;
font-family:SimSun;color:black'>&nbsp;</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>简化并行读取：</span></b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>如果要读取多个</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>partition</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>，不需要创建多个输入</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>DStream</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>然后对它们进行</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>union</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>操作。</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>Spark</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>会创建跟</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Kafka partition</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>一样多的</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>RDD
partition</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>，并且会并行从</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>Kafka</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中读取数据。所以在</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>Kafka partition</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>和</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>RDD partition</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>之间，有一个一对一的映射关系。
</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>高性能：</span></b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>如果要保证零数据丢失，在基于</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>receiver</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的方式中，需要开启</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>WAL</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>机制。这种方式其实效率低下，因为数据实际上被复制了两份，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Kafka</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>自己本身就有高可靠的机制，会对数据复制一份，而这里又会复制一份到</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>WAL</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中。而基于</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>direct</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的方式，不依赖</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>Receiver</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>，不需要开启</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>WAL</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>机制，只要</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>Kafka</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中作了数据的复制，那么就可以通过</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>的副本进行恢复。
</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>一次且仅一次的事务机制</span></b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>。</span></p>

<p class=a1><b><span lang=ZH-CN style='font-size:10.5pt;font-family:SimSun;
color:black'>三、对比：</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>基于</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>receiver</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的方式，是使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Kafka</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的高阶</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>API</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>来在</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>ZooKeeper</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>中保存消费过的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>offset</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的。这是消费</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>Kafka</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>数据的传统方式。这种方式配合着</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>WAL</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>机制可以保证数据零丢失的高可靠性，但是却无法保证数据被处理一次且仅一次，可能会处理两次。因为</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Spark</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>和</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>ZooKeeper</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>之间可能是不同步的。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>基于</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>direct</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的方式，使用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>kafka</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的简单</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>api</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Spark Streaming</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>自己就负责追踪消费的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>offset</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，并保存在</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>checkpoint</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中。</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>Spark</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>自己一定是同步的，因此可以保证数据是消费一次且仅消费一次。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>在实际生产环境中大都用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Direct</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>方式</span></p>

<h3><a name="_Toc10725252"></a><a name="_Toc16885"><span lang=EN-US>4.10.19 </span></a><span
lang=ZH-CN style='font-family:SimSun'>简述</span><span lang=EN-US>SparkStreaming</span><span
lang=ZH-CN style='font-family:SimSun'>窗口函数的原理（重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'> </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>窗口函数就是在原来定义的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>SparkStreaming</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>计算批次大小的基础上再次进行封装，每次计算多个批次的数据，同时还需要传递一个滑动步长的参数，用来设置当次计算任务完成之后下一次从什么地方开始计算。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>图中</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>time1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>就是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>SparkStreaming</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>计算批次大小，虚线框以及实线大框就是窗口的大小，必须为批次的整数倍。虚线框到大实线框的距离（相隔多少批次），就是滑动步长。</span></p>

<h3><a name="_Toc25642"></a><a name="_Toc10725253"><span lang=EN-US>4.10.20 </span></a><span
lang=ZH-CN style='font-family:SimSun'>请手写出</span><span lang=EN-US>wordcount</span><span
lang=ZH-CN style='font-family:SimSun'>的</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>代码实现（</span><span lang=EN-US>Scala</span><span
lang=ZH-CN style='font-family:SimSun'>）（手写代码重点）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;val conf: SparkConf = new
SparkConf().setMaster(&quot;local[*]&quot;).setAppName(&quot;WordCount&quot;)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> val sc = new SparkContext(conf)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'> sc.textFile(&quot;/input&quot;)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>.flatMap(_.split(&quot; &quot;))</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>.map((_,1))</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>.reduceByKey(_+_)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>.saveAsTextFile(&quot;/output&quot;)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;sc.stop()</span></p>

<h3><a name="_Toc10725254"></a><a name="_Toc3795"><span lang=EN-US>4.10.21 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何使用</span><span lang=EN-US>Spark</span><span
lang=ZH-CN style='font-family:SimSun'>实现</span><span lang=EN-US>topN</span><span
lang=ZH-CN style='font-family:SimSun'>的获取（描述思路或使用伪代码）（重点）</span></h3>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>1</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）按照</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>key</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>对数据进行聚合（</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>groupByKey</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）将</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>value</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>转换为数组，利用</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>scala</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>sortBy</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>或者</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>sortWith</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进行排序（</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>mapValues</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>）数据量太大，会</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>OOM</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>。</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>2</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）取出所有的</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>key</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）对</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>key</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进行迭代，每次取出一个</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>key</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>利用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>spark</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>的排序算子进行排序</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>3</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）自定义分区器，按照</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>key</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>进行分区，使不同的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>key</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>进到不同的分区</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）对每个分区运用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>spark</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的排序算子进行排序</span></p>

<h3><a name="_Toc23470"></a><a name="_Toc10725255"><span lang=EN-US>4.10.22 </span></a><span
lang=ZH-CN style='font-family:SimSun'>京东：调优之前与调优之后性能的详细对比（例如调整</span><span
lang=EN-US>map</span><span lang=ZH-CN style='font-family:SimSun'>个数，</span><span
lang=EN-US>map</span><span lang=ZH-CN style='font-family:SimSun'>个数之前多少、之后多少，有什么提升）</span></h3>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>这里举个例子。比如我们有几百个文件，会有几百个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>map</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>出现，读取之后进行</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>join</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>操作，会非常的慢。这个时候我们可以进行</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>coalesce</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>操作，比如</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>240</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>个</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>map</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，我们合成</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>60</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>个</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>map</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>，也就是窄依赖。这样再</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>shuffle</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，过程产生的文件数会大大减少。提高</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>join</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的时间性能。</span></p>

<h1><a name="_Toc10725256"></a><a name="_Toc19594"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>5</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=ZH-CN style='font-family:SimSun'>用户行为数据分析</span></h1>

<h2><a name="_Toc31201"></a><a name="_Toc10725257"><span lang=EN-US>5.1 </span></a><span
lang=ZH-CN style='font-family:SimHei'>数仓分层架构表</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=415 height=294 id="图片 22" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image025.jpg"></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>分层优点：复杂问题简单化、清晰数据结构</span><span
lang=EN-US style='color:black'>(</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>方便管理</span><span lang=EN-US style='color:black'>)</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、增加数据的复用性、隔离原始数据</span><span
lang=EN-US style='color:black'>(</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>解耦</span><span lang=EN-US style='color:black'>)</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>ods         </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>原始数据层</span><span lang=EN-US
style='color:black'>   </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>存放原始数据，保持原貌不做处理</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd        </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>明细数据层</span><span lang=EN-US
style='color:black'>   </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>对</span><span lang=EN-US style='color:black'>ods</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>层数据清洗（去除空值，脏数据，超过极限范围的数据）</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dws        </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>服务数据层</span><span lang=EN-US
style='color:black'>   </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>轻度聚合</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>ads         </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>应用数据层</span><span lang=EN-US
style='color:black'>   </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>具体需求</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>数仓中各层建的表都是外部表</span></p>

<h2><a name="_Toc10725258"></a><a name="_Toc8070"><span lang=EN-US>5.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>埋点行为数据基本格式</span><span lang=EN-US>(</span><span
lang=ZH-CN style='font-family:SimHei'>基本字段</span><span lang=EN-US>)</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>公共字段：基本所有安卓手机都包含的字段</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>业务字段：埋点上报的字段，有具体的业务类型</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>下面就是一个示例，表示业务字段的上传。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>行为数据启动日志</span><span lang=EN-US style='color:black'>/</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>事件日志表关键字段</span><span
lang=EN-US style='color:black'>: </span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>{</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>&quot;ap&quot;:&quot;xxxxx&quot;,//</span><span
lang=ZH-CN style='line-height:125%;font-family:SimSun;color:black'>项目数据来源</span><span
lang=EN-US style='line-height:125%;color:black'> app pc</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>&quot;cm&quot;:
{  //</span><span lang=ZH-CN style='line-height:125%;font-family:SimSun;
color:black'>公共字段</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>              &quot;mid&quot;:
&quot;&quot;,  // (String) </span><span lang=ZH-CN style='line-height:125%;
font-family:SimSun;color:black'>设备唯一标识</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>        &quot;uid&quot;:
&quot;&quot;,  // (String) </span><span lang=ZH-CN style='line-height:125%;
font-family:SimSun;color:black'>用户标识</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;vc&quot;: &quot;1&quot;,  // (String) versionCode</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>，程序版本号</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;vn&quot;: &quot;1.0&quot;,  // (String) versionName</span><span
lang=ZH-CN style='line-height:125%;font-family:SimSun;color:black'>，程序版本名</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;l&quot;: &quot;zh&quot;,  // (String) </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>系统语言</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;sr&quot;: &quot;&quot;,  // (String) </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>渠道号，应用从哪个渠道来的。</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;os&quot;: &quot;7.1.1&quot;,  // (String) Android</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>系统版本</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;ar&quot;: &quot;CN&quot;,  // (String) </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>区域</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;md&quot;: &quot;BBB100-1&quot;,  // (String) </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>手机型号</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;ba&quot;: &quot;blackberry&quot;,  // (String) </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>手机品牌</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;sv&quot;: &quot;V2.2.1&quot;,  // (String) sdkVersion</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;g&quot;: &quot;&quot;,  // (String) gmail</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;hw&quot;: &quot;1620x1080&quot;,  // (String) heightXwidth</span><span
lang=ZH-CN style='line-height:125%;font-family:SimSun;color:black'>，屏幕宽高</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;t&quot;: &quot;1506047606608&quot;,  // (String) </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>客户端日志产生时的时间</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;nw&quot;: &quot;WIFI&quot;,  // (String) </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>网络模式</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;ln&quot;: 0,  // (double) lng</span><span lang=ZH-CN style='line-height:
125%;font-family:SimSun;color:black'>经度</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
&quot;la&quot;: 0  // (double) lat </span><span lang=ZH-CN style='line-height:
125%;font-family:SimSun;color:black'>纬度</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>    },</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>&quot;et&quot;: 
[  //</span><span lang=ZH-CN style='line-height:125%;font-family:SimSun;
color:black'>事件</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>           
{</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>               
&quot;ett&quot;: &quot;1506047605364&quot;,  //</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>客户端事件产生时间</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>               
&quot;en&quot;: &quot;display&quot;,  //</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>事件名称</span><span
lang=EN-US style='line-height:125%;color:black'>  </span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>启动和事件日志是根据事件名称的不同</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>               
&quot;kv&quot;: {  //</span><span lang=ZH-CN style='line-height:125%;
font-family:SimSun;color:black'>事件结果，以</span><span lang=EN-US style='line-height:
125%;color:black'>key-value</span><span lang=ZH-CN style='line-height:125%;
font-family:SimSun;color:black'>形式自行定义</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>                   
&quot;goodsid&quot;: &quot;236&quot;,</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>                   
&quot;action&quot;: &quot;1&quot;,</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>                   
&quot;extend1&quot;: &quot;1&quot;,</span></p>

<p class=MsoNormal style='margin-left:84.0pt;text-indent:21.0pt'><span
lang=EN-US style='line-height:125%;color:black'>&quot;place&quot;:
&quot;2&quot;,</span></p>

<p class=MsoNormal style='margin-left:84.0pt;text-indent:21.0pt'><span
lang=EN-US style='line-height:125%;color:black'>&quot;category&quot;:
&quot;75&quot;</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>               
}</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>           
}</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>       
]</span></p>

<p class=MsoNormal><span lang=EN-US style='line-height:125%;color:black'>}</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun;color:black'>根据事件标签的不同可以分成不同的日志表</span></p>

<h2><a name="_Toc10725259"></a><a name="_Toc23881"><span lang=EN-US>5.3 </span></a><span
lang=ZH-CN style='font-family:SimHei'>项目经验总结</span></h2>

<h3><a name="_Toc10725260"></a><a name="_Toc12506"><span lang=EN-US>5.3.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>项目经验之元数据备份</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>元数据备份（重点，如数据损坏，可能整个集群无法运行，至少要保证每日零点之后备份到其它服务器两个复本）</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h3><a name="_Toc10725261"></a><a name="_Toc1221"><span lang=EN-US>5.3.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>日期处理函数</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>date_format</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>函数（根据格式整理日期）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>date_add</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>date_sub</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>函数（加减日期）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>next_day</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>函数</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>last_day</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>函数（求当月最后一天日期）</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>collect_set</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>函数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>6</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>get_json_object</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>解析</span><span lang=EN-US style='color:black'>json</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>函数</span></p>

<h3><a name="_Toc32157"></a><a name="_Toc10725262"><span lang=EN-US>5.3.3 Union</span></a><span
lang=ZH-CN style='font-family:SimSun'>与</span><span lang=EN-US>Union all</span><span
lang=ZH-CN style='font-family:SimSun'>区别</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>union</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>会将联合的结果集去重，效率较</span><span lang=EN-US style='color:black'>union
all</span><span lang=ZH-CN style='font-family:SimSun;color:black'>差</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>union all</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>不会对结果集去重，所以效率高</span></p>

<h3><a name="_Toc10725263"></a><a name="_Toc21501"><span lang=EN-US>5.3.4 Shell</span></a><span
lang=ZH-CN style='font-family:SimSun'>中单引号和双引号区别</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）在</span><span lang=EN-US
style='color:black'>/home/hadoop/bin</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>创建一个</span><span lang=EN-US style='color:black'>test.sh</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>文件</span></p>

<p class=a0><span lang=EN-US>[hadoop@node1 bin]$ vim test.sh </span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-size:10.0pt;line-height:150%;font-family:SimSun;
color:black;background:white'>在文件中添加如下内容</span></p>

<p class=a0><span lang=EN-US>#!/bin/bash</span></p>

<p class=a0><span lang=EN-US>do_date=$1</span></p>

<p class=a0><span lang=EN-US>&nbsp;</span></p>

<p class=a0><span lang=EN-US>echo '$do_date'</span></p>

<p class=a0><span lang=EN-US>echo &quot;$do_date&quot;</span></p>

<p class=a0><span lang=EN-US>echo &quot;'$do_date'&quot;</span></p>

<p class=a0><span lang=EN-US>echo '&quot;$do_date&quot;'</span></p>

<p class=a0><span lang=EN-US>echo `date`</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）查看执行结果</span></p>

<p class=a0><span lang=EN-US>[hadoop@node1 bin]$ sh test.sh 2019-02-10</span></p>

<p class=a0><span lang=EN-US>$do_date</span></p>

<p class=a0><span lang=EN-US>2019-02-10</span></p>

<p class=a0><span lang=EN-US>'2019-02-10'</span></p>

<p class=a0><span lang=EN-US>&quot;$do_date&quot;</span></p>

<p class=a0><span lang=EN-US>2019</span><span lang=ZH-CN style='font-family:
SimSun'>年</span><span lang=EN-US> 05</span><span lang=ZH-CN style='font-family:
SimSun'>月</span><span lang=EN-US> 02</span><span lang=ZH-CN style='font-family:
SimSun'>日</span><span lang=ZH-CN> </span><span lang=ZH-CN style='font-family:
SimSun'>星期四</span><span lang=EN-US> 21:02:08 CST</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）总结：</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）单引号不取变量值</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）双引号取变量值</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）反引号</span><span lang=EN-US style='color:black'>`</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，执行引号中命令</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>4</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）双引号内部嵌套单引号，取出变量值</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>5</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）单引号内部嵌套双引号，不取出变量值</span></p>

<h2><a name="_Toc10725265"></a><a name="_Toc29206"><span lang=EN-US>5.4 ods</span></a><span
lang=ZH-CN style='font-family:SimHei'>层</span></h2>

<p class=MsoNormal style='line-height:150%'><a name="_Toc18517"><span
lang=EN-US style='color:black'>1</span></a><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>ods_start_log </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>启动日志表</span><span lang=EN-US
style='color:black'>      </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>只有一个字段</span><span
lang=ZH-CN style='color:black'> </span><span lang=EN-US style='color:black'>line</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（保存着</span><span lang=EN-US
style='color:black'>json</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>），按照日期</span><span lang=EN-US style='color:black'>dt</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>分区，表的格式：</span><span
lang=EN-US style='color:black'>lzo</span></p>

<p class=MsoNormal style='line-height:150%'><a name="_Toc14185"><span
lang=EN-US style='color:black'>2</span></a><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>ods_event_log  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>事件日志表（格式同启动日志表）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>只有一个字段</span><span
lang=EN-US style='color:black'> line </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，按照日期</span><span lang=EN-US style='color:black'>dt </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>分区，表的格式：</span><span
lang=EN-US style='color:black'>lzo</span></p>

<h2><a name="_Toc19047"></a><a name="_Toc10725266"><span lang=EN-US>5.5 dwd</span></a><span
lang=ZH-CN style='font-family:SimHei'>层</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>dwd_start_log </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>启动表</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>关键字段：</span><span lang=EN-US
style='color:black'>mid_id</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，</span><span lang=EN-US style='color:black'>user_id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>dt(</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>分区字段，按照日期分区</span><span lang=EN-US style='color:black'>) </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（其实这是启动表和事件表的公共字段）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>从</span><span lang=EN-US
style='color:black'>ods_start_log</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中的</span><span lang=EN-US style='color:black'>line</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>用</span><span lang=EN-US
style='color:black'>get_json_object(line</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>'$.mid') mid_id</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的方式获取字段</span></p>

<h3><a name="_Toc10725267"></a><a name="_Toc4013"><span lang=EN-US>5.5.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>自定义</span><span lang=EN-US>UDF/UDTF</span><span
lang=ZH-CN style='font-family:SimSun'>（项目中的应用）</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span lang=EN-US
style='color:black'>UDF</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>函数（解析公共字段，一进一出）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span lang=EN-US
style='color:black'>UDTF</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>函数（解析具体事件字段，一进多出）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span lang=EN-US
style='color:black'>UDF</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>：继承</span><span lang=EN-US style='color:black'>UDF</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，重写</span><span lang=EN-US
style='color:black'>evaluate</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span lang=EN-US
style='color:black'>UDTF</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>：继承自</span><span lang=EN-US style='color:black'>GenericUDTF</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，重写</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>个方法：</span><span lang=EN-US style='color:black'>initialize(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义输出的列名和类型</span><span
lang=EN-US style='color:black'>)</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，</span><span lang=EN-US style='color:black'>process</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（将结果返回</span><span
lang=EN-US style='color:black'>forward(result)</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>），</span><span lang=EN-US
style='color:black'>close</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>为什么要自定义</span><span
lang=EN-US style='color:black'>UDF/UDTF</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，因为自定义函数，可以自己埋点</span><span lang=EN-US
style='color:black'>Log</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>打印日志，出错或者数据异常，方便调试。</span></p>

<h3><a name="_Toc10317"></a><a name="_Toc10725268"><span lang=EN-US>5.5.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>事件日志基础明细表</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>dwd_base_event_log
</span><span lang=ZH-CN style='font-family:SimSun;color:black'>事件日志基础明细表</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）关键字段：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>公共字段：</span><span lang=EN-US
style='color:black'>mid_id</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，</span><span lang=EN-US style='color:black'>user_id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>dt(</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>分区字段</span><span lang=EN-US style='color:black'>)</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>以及</span><span lang=EN-US
style='color:black'>event_name</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>event_json</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>server_time</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）从</span><span lang=EN-US
style='color:black'> ods_event_log</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的</span><span lang=EN-US style='color:black'>line </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>中用</span><span lang=EN-US
style='color:black'> UDF </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>获取</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>公共字段</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>和</span><span lang=EN-US style='color:black'> server_time</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，用</span><span lang=EN-US
style='color:black'>UDTF </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>获取</span><span lang=EN-US style='color:black'>  event_name ,
event_json    </span><span lang=ZH-CN style='font-family:SimSun;color:black'>。</span></p>

<h3><a name="_Toc10725269"></a><a name="_Toc15237"><span lang=EN-US>5.5.3 </span></a><span
lang=ZH-CN style='font-family:SimSun'>商品点击表</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>dwd_display_log
</span><span lang=ZH-CN style='font-family:SimSun;color:black'>商品点击表</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>关键字段：公共字段</span><span
lang=EN-US style='color:black'> + </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>特有字段</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>从</span><span lang=EN-US
style='color:black'>dwd_base_event_log</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中直接获取公共字段和</span><span lang=EN-US style='color:black'>server_time</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，从</span><span lang=EN-US
style='color:black'> dwd_base_event_log</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的</span><span lang=EN-US
style='color:black'> event_json</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>中获取特有字段，</span><span lang=EN-US style='color:black'>where
event_name = &quot;display&quot;</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       get_json_object(event_json,'$.kv.action')
action</span></p>

<h3><a name="_Toc10725270"></a><a name="_Toc26438"><span lang=EN-US>5.5.4 </span></a><span
lang=ZH-CN style='font-family:SimSun'>其他的具体事件明细表</span></h3>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>类似</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_newsdetail_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>商品详情页表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_loading_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>商品列表页表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_ad_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>广告表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_notification_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>消息通知表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_active_foreground_log </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>用户前台活跃表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_active_background_log </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>用户后台活跃表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_comment_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>评论表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_favorites_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>收藏表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_praise_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>点赞表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>dwd_error_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>错误日志表</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从一张事件基础明细表</span><span
lang=EN-US style='color:black'>dwd_base_event_log</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>一共可以获得</span><span lang=EN-US
style='color:black'>11</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>张具体事件明细表</span></p>

<h2><a name="_Toc10725271"></a><a name="_Toc32183"><span lang=EN-US>5.6 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求一：用户活跃主题</span></h2>

<h3><a name="_Toc20346"></a><a name="_Toc10725272"><span lang=EN-US>5.6.1 DWS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层日活明细表</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=411 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image026.jpg"></span></p>

<h3><a name="_Toc13404"></a><a name="_Toc10725273"><span lang=EN-US>5.6.2 DWS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层周活明细表</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=411 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image027.jpg"></span></p>

<h3><a name="_Toc10725274"></a><a name="_Toc27369"><span lang=EN-US>5.6.3 DWS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层月活明细表</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=415 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image028.jpg"></span></p>

<h3><a name="_Toc31892"></a><a name="_Toc10725275"><span lang=EN-US>5.6.4 ADS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层日周月活跃设备数表</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=415 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image029.jpg"></span></p>

<h2><a name="_Toc10725276"></a><a name="_Toc14540"><span lang=EN-US>5.7 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求二：用户新增主题</span></h2>

<h3><a name="_Toc15595"></a><a name="_Toc10725277"><span lang=EN-US>5.7.1 DWS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层日新增明细表</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=415 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image030.jpg"></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=415 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image031.jpg"></span></p>

<h3><a name="_Toc8424"></a><a name="_Toc10725278"><span lang=EN-US>5.7.2 ADS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层每日新增设备数表</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=414 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image032.jpg"></span></p>

<h2><a name="_Toc5072"></a><a name="_Toc10725279"><span lang=EN-US>5.8 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求三：用户留存主题</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=406 height=230 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image033.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=415 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image034.jpg"></span></p>

<h3><a name="_Toc20141"></a><a name="_Toc10725280"><span lang=EN-US>5.8.1 DWS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层日留存明细表</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=411 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image035.jpg"></span></p>

<h3><a name="_Toc10725281"></a><a name="_Toc21193"><span lang=EN-US>5.8.2 ADS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层留存用户数表</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image036.jpg"></span></p>

<h3><a name="_Toc6675"></a><a name="_Toc10725282"><span lang=EN-US>5.8.3 ADS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层留存用户率表</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=414 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image037.jpg"></span></p>

<h2><a name="_Toc13386"></a><a name="_Toc10725283"><span lang=EN-US>5.9 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求四：沉默用户</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image038.jpg"></span></p>

<h2><a name="_Toc5265"></a><a name="_Toc10725284"><span lang=EN-US>5.10 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求五：本周回流用户数</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image039.jpg"></span></p>

<h2><a name="_Toc10725285"></a><a name="_Toc10596"><span lang=EN-US>5.11 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求六：流失用户数</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image040.jpg"></span></p>

<h2><a name="_Toc17064"></a><a name="_Toc10725286"><span lang=EN-US>5.12 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求七：最近连续</span><span lang=EN-US>3</span><span
lang=ZH-CN style='font-family:SimHei'>周活跃用户数</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image041.jpg"></span></p>

<h2><a name="_Toc17814"></a><a name="_Toc10725287"><span lang=EN-US>5.13 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求八：最近七天内连续三天活跃用户数</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image042.jpg"></span></p>

<h2><a name="_Toc3790"></a><a name="_Toc10725288"><span lang=EN-US>5.14 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求逻辑</span></h2>

<h3><a name="_Toc10725289"></a><a name="_Toc17037"><span lang=EN-US>5.14.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析用户活跃？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>在启动日志中统计不同设备</span><span lang=EN-US style='color:black'>id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>出现次数。</span></p>

<h3><a name="_Toc10441"></a><a name="_Toc10725290"><span lang=EN-US>5.14.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析用户新增？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>用活跃用户表</span><span lang=EN-US style='color:black'> left
join </span><span lang=ZH-CN style='font-family:SimSun;color:black'>用户新增表，用户新增表中</span><span
lang=EN-US style='color:black'>mid</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>为空的即为用户新增。</span></p>

<h3><a name="_Toc8863"></a><a name="_Toc10725291"><span lang=EN-US>5.14.3 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析用户</span><span lang=EN-US>1</span><span
lang=ZH-CN style='font-family:SimSun'>天留存？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>留存用户</span><span lang=EN-US style='color:black'>=</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>前一天新增</span><span lang=EN-US
style='color:black'> join </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>今天活跃</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>用户留存率</span><span lang=EN-US style='color:black'>=</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>留存用户</span><span lang=EN-US
style='color:black'>/</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>前一天新增</span></p>

<h3><a name="_Toc23727"></a><a name="_Toc10725292"><span lang=EN-US>5.14.4 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析沉默用户？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>登录时间为</span><span lang=EN-US
style='color:black'>7</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>天前</span><span lang=EN-US style='color:black'>,</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>且只出现过一次</span><span
lang=EN-US style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>按照设备</span><span lang=EN-US style='color:black'>id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>对日活表分组，登录次数为</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，且是在一周前登录。</span></p>

<h3><a name="_Toc10725293"></a><a name="_Toc28727"><span lang=EN-US>5.14.5 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析本周回流用户？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>本周活跃</span><span lang=EN-US style='color:black'>left join</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>本周新增</span><span lang=EN-US
style='color:black'> left join</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>上周活跃，且本周新增</span><span lang=EN-US style='color:black'>id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和上周活跃</span><span lang=EN-US
style='color:black'>id</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>都为</span><span lang=EN-US style='color:black'>null</span></p>

<h3><a name="_Toc10725294"></a><a name="_Toc1836"><span lang=EN-US>5.14.6 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析流失用户？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>登录时间为</span><span lang=EN-US
style='color:black'>7</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>天前</span><span lang=EN-US style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>按照设备</span><span lang=EN-US style='color:black'>id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>对日活表分组，且七天内没有登录过。</span></p>

<h3><a name="_Toc18833"></a><a name="_Toc10725295"><span lang=EN-US>5.14.7 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析最近连续</span><span lang=EN-US>3</span><span
lang=ZH-CN style='font-family:SimSun'>周活跃用户数？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>按照设备</span><span lang=EN-US style='color:black'>id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>对周活进行分组，统计次数大于</span><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>次。</span></p>

<h3><a name="_Toc10725296"></a><a name="_Toc14531"><span lang=EN-US>5.14.8 </span></a><span
lang=ZH-CN style='font-family:SimSun'>如何分析最近七天内连续三天活跃用户数？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）查询出最近</span><span
lang=EN-US style='color:black'>7</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>天的活跃用户，并对用户活跃日期进行排名</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）计算用户活跃日期及排名之间的差值</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）对同用户及差值分组，统计差值个数</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）将差值相同个数大于等于</span><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的数据取出，然后去重</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>去的是什么重</span><span
lang=EN-US style='color:black'>???)</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，即为连续</span><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>天及以上活跃的用户</span></p>

<h1><a name="_Toc10725297"></a><a name="_Toc9083"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>6</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=ZH-CN style='font-family:SimSun'>业务交互数据分析</span></h1>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>第三份文档</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>电商业务数据的分析和处理</span><span
lang=EN-US style='color:black'>)</span></p>

<h2><a name="_Toc26645"></a><a name="_Toc10725298"><span lang=EN-US>6.1 </span></a><span
lang=ZH-CN style='font-family:SimHei'>电商常识</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>SKU</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：一台银色、</span><span
lang=EN-US style='color:black'>128G</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>内存的、支持联通网络的</span><span lang=EN-US style='color:black'>iPhoneX</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>SPU</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：</span><span lang=EN-US
style='color:black'>iPhoneX</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>Tm_id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>：品牌</span><span lang=EN-US
style='color:black'>Id</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>苹果，包括</span><span lang=EN-US style='color:black'>IPHONE</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，耳机，</span><span lang=EN-US
style='color:black'>mac</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>等</span></p>

<h2><a name="_Toc17142"></a><a name="_Toc10725299"><span lang=EN-US>6.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>电商业务流程</span></h2>

<p class=MsoNormal><span lang=EN-US><img border=0 width=407 height=230
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image043.jpg"></span></p>

<h2><a name="_Toc10725300"></a><a name="_Toc21371"><span lang=EN-US>6.3 </span></a><span
lang=ZH-CN style='font-family:SimHei'>业务表关键字段</span></h2>

<h3><a name="_Toc11488"></a><a name="_Toc10725301"><span lang=EN-US>6.3.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>订单表（</span><span lang=EN-US>order_info</span><span
lang=ZH-CN style='font-family:SimSun'>）</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>订单编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>total_amount</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>订单金额</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>order_status</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>订单状态</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>user_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>用户</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>payment_way</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>支付方式</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>out_trade_no</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>支付流水号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>create_time</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>创建时间</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>operate_time</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>操作时间</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<h3><a name="_Toc10725302"></a><a name="_Toc29825"></a><a name="_Toc10725304"><span
lang=EN-US>6.3.2 </span></a><span lang=ZH-CN style='font-family:SimSun'>用户表</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>用户</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>name</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>姓名</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>birthday</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>生日</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>gender</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>性别</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>email</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>邮箱</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>user_level</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>用户等级</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>create_time</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>创建时间</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<h3><a name="_Toc1055"><span lang=EN-US>6.3.3 </span></a><span lang=ZH-CN
style='font-family:SimSun'>订单详情表（</span><span lang=EN-US>order_detail</span><span
lang=ZH-CN style='font-family:SimSun'>）</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>订单编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>order_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>订单号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>user_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>用户</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>sku_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>商品</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>sku_name</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>商品名称</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>order_price</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>商品价格</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>sku_num</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>商品数量</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>create_time</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>创建时间</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<h3><a name="_Toc15348"></a><a name="_Toc10725303"><span lang=EN-US>6.3.4 </span></a><span
lang=ZH-CN style='font-family:SimSun'>商品表</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>skuId</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>spu_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>spuid</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>price</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>价格</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>sku_name</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>商品名称</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>sku_desc</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>商品描述</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>weight</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>重量</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>tm_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>品牌</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>category3_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>品类</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>create_time</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>创建时间</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<h3><a name="_Toc20954"></a><a name="_Toc10725305"><span lang=EN-US>6.3.5 </span></a><span
lang=ZH-CN style='font-family:SimSun'>商品一级分类表</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>name</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>名称</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<h3><a name="_Toc10725306"></a><a name="_Toc17316"><span lang=EN-US>6.3.6 </span></a><span
lang=ZH-CN style='font-family:SimSun'>商品二级分类表</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>name</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>名称</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>category1_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>一级品类</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<h3><a name="_Toc20677"></a><a name="_Toc10725307"><span lang=EN-US>6.3.7 </span></a><span
lang=ZH-CN style='font-family:SimSun'>商品三级分类表</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>name</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>名称</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>Category2_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>二级品类</span><span lang=EN-US style='font-size:
  9.0pt;line-height:125%;font-family:Consolas;color:black'>id</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<h3><a name="_Toc10725308"></a><a name="_Toc19218"><span lang=EN-US>6.3.8 </span></a><span
lang=ZH-CN style='font-family:SimSun'>支付流水表</span></h3>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=571
 style='border-collapse:collapse'>
 <tr>
  <td width=162 colspan=2 valign=top style='width:121.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>标签</span></p>
  </td>
  <td width=409 valign=top style='width:306.85pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>含义</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>out_trade_no</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>对外业务编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>order_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>订单编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>user_id</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>用户编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>alipay_trade_no</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>支付宝交易流水编号</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>total_amount</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>支付金额</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>subject</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>交易内容</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>payment_type</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>支付类型</span></p>
  </td>
 </tr>
 <tr>
  <td width=156 valign=top style='width:116.75pt;background:#E8E8E8;padding:
  0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=EN-US style='font-size:9.0pt;line-height:125%;
  font-family:Consolas;color:black'>payment_time</span></p>
  </td>
  <td width=416 colspan=2 valign=top style='width:11.0cm;background:#E8E8E8;
  padding:0cm 5.4pt 0cm 5.4pt'>
  <p class=MsoNormal><span lang=ZH-CN style='font-size:9.0pt;line-height:125%;
  font-family:SimSun;color:black'>支付时间</span></p>
  </td>
 </tr>
 <tr height=0>
  <td width=156 style='border:none'></td>
  <td width=7 style='border:none'></td>
  <td width=409 style='border:none'></td>
 </tr>
</table>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>订单表跟订单详情表有什么区别？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单表的订单状态会变化，订单详情表不会，因为没有订单状态。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单表记录</span><span lang=EN-US
style='color:black'>user_id</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，订单</span><span lang=EN-US style='color:black'>id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单编号，订单的总金额</span><span
lang=EN-US style='color:black'>order_status</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，支付方式，订单状态等。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单详情表记录</span><span
lang=EN-US style='color:black'>user_id</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>，商品</span><span lang=EN-US style='color:black'>sku_id ,</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>具体的商品信息（商品名称</span><span
lang=EN-US style='color:black'>sku_name</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，价格</span><span lang=EN-US
style='color:black'>order_price</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，数量</span><span lang=EN-US style='color:black'>sku_num</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span></p>

<h2><a name="_Toc23440"></a><a name="_Toc10725309"><span lang=EN-US>6.4 MySql</span></a><span
lang=ZH-CN style='font-family:SimHei'>中表的分类</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>实体表，维度表，事务型事实表，周期性事实表</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>其实最终可以把事务型事实表，周期性事实表统称实体表，实体表，维度表统称维度表</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>订单表（</span><span lang=EN-US style='color:black'>order_info</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）（周期型事实表）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>订单详情表（</span><span lang=EN-US style='color:black'>order_detail</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>(</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>事务型事实表</span><span lang=EN-US style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>商品表</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>实体表</span><span lang=EN-US
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>用户表</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>实体表</span><span lang=EN-US
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>商品一级分类表</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>维度表</span><span lang=EN-US
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>商品二级分类表</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>维度表</span><span lang=EN-US
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>商品三级分类表</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>维度表</span><span lang=EN-US
style='color:black'>)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>支付流水表</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>事务型实体表</span><span
lang=EN-US style='color:black'>)</span></p>

<h2><a name="_Toc16022"></a><a name="_Toc10725310"><span lang=EN-US>6.5 </span></a><span
lang=ZH-CN style='font-family:SimHei'>同步策略</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=388 height=251 id="图片 20" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image044.jpg"></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>实体表，维度表统称维度表，每日全量或者每月（更长时间）全量</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>事务型事实表：每日增量</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>周期性事实表：拉链表</span></p>

<h2><a name="_Toc10725311"></a><a name="_Toc24560"><span lang=EN-US>6.6 </span></a><span
lang=ZH-CN style='font-family:SimHei'>关系型数据库范式理论</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>1NF</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>：属性不可再分割（例如不能存在</span><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>台电脑的属性，坏处：表都没法用）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>2NF</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>：不能存在部分函数依赖（例如主键（学号</span><span lang=EN-US
style='color:black'>+</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>课名）</span><span lang=EN-US style='color:black'>--&gt;</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>成绩，姓名，但学号</span><span
lang=EN-US style='color:black'>--</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>》姓名，所以姓名部分依赖于主键（学号</span><span lang=EN-US style='color:
black'>+</span><span lang=ZH-CN style='font-family:SimSun;color:black'>课名），所以要去除，坏处：数据冗余）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>3NF</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>：不能存在传递函数依赖（学号</span><span lang=EN-US style='color:black'>--</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>》宿舍种类</span><span lang=EN-US
style='color:black'>--</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>》价钱，坏处：数据冗余和增删异常）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Mysql</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>关系模型：关系模型主要应用与</span><span lang=EN-US style='color:black'>OLTP</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>系统中，为了保证数据的一致性以及避免冗余，所以大部分业务系统的表都是遵循第三范式的。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>维度模型：维度模型主要应用于</span><span lang=EN-US style='color:black'>OLAP</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>系统中，因为关系模型虽然冗余少，</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>但是在大规模数据，跨表分析统计查询过程中，会造成多表关联，这会大大降低执行效率。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>所以</span><span lang=EN-US style='color:black'>HIVE</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>把相关各种表整理成两种：事实表和维度表两种。所有维度表围绕着事实表进行解释。</span></p>

<h2><a name="_Toc17614"></a><a name="_Toc10725312"><span lang=EN-US>6.7 </span></a><span
lang=ZH-CN style='font-family:SimHei'>数据模型</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>雪花模型、星型模型和星座模型</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（在维度建模的基础上又分为三种模型：星型模型、雪花模型、星座模型。）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>星型模型（一级维度表），雪花（多级维度），星座模型（星型模型</span><span
lang=EN-US style='color:black'>+</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>多个事实表）</span></p>

<h2><a name="_Toc10725313"></a><a name="_Toc738"><span lang=EN-US>6.8 </span></a><span
lang=ZH-CN style='font-family:SimHei'>业务数据数仓搭建</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>sqoop</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>导数据的原理是</span><span
lang=EN-US style='color:black'>mapreduce,</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>import     </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>把数据从关系型数据库</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>导到</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>数据仓库，自定义</span><span
lang=EN-US style='color:black'>InputFormat</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>export     </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>把数据从数据仓库</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>导到</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>关系型数据库，自定义</span><span
lang=EN-US style='color:black'>OutputFormat</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>用</span><span lang=EN-US
style='color:black'>sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>从</span><span lang=EN-US style='color:black'>mysql</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>中将八张表的数据导入数仓的</span><span
lang=EN-US style='color:black'>ods</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>原始数据层</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>全量无条件，增量按照创建时间，增量</span><span
lang=EN-US style='color:black'>+</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>变化按照创建时间或操作时间。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>origin_data</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>sku_info</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>商品表（每日导全量）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>user_info</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>用户表（每日导全量）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>base_category1</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>商品一级分类表（每日导全量）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>base_category2</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>商品二级分类表（每日导全量）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>base_category3</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>商品三级分类表（每日导全量）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>order_detail</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>订单详情表（每日导增量）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>payment_info</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>支付流水表（每日导增量）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>order_info</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>订单表（每日导增量</span><span lang=EN-US
style='color:black'>+</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>变化）</span></p>

<h3><a name="_Toc10725314"></a><a name="_Toc27722"><span lang=EN-US>6.8.1 ods</span></a><span
lang=ZH-CN style='font-family:SimSun'>层</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（八张表，表名，字段跟</span><span
lang=EN-US style='color:black'>mysql</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>完全相同）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从</span><span lang=EN-US
style='color:black'>origin_data</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>把数据导入到</span><span lang=EN-US style='color:black'>ods</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>层，表名在原表名前加</span><span
lang=EN-US style='color:black'>ods_</span></p>

<h3><a name="_Toc18456"></a><a name="_Toc10725315"><span lang=EN-US>6.8.2 dwd</span></a><span
lang=ZH-CN style='font-family:SimSun'>层</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>对</span><span lang=EN-US
style='color:black'>ODS</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>层数据进行判空过滤。对商品分类表进行维度退化</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>降维</span><span lang=EN-US
style='color:black'>)</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>。其他数据跟</span><span lang=EN-US style='color:black'>ods</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>层一模一样</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单表</span><span lang=EN-US
style='color:black'> dwd_order_info</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单详情表</span><span lang=EN-US
style='color:black'> dwd_order_detail</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>用户表</span><span lang=EN-US
style='color:black'> dwd_user_info</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>支付流水表</span><span lang=EN-US
style='color:black'> dwd_payment_info</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>商品表</span><span lang=EN-US
style='color:black'> dwd_sku_info</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>       </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>其他表字段不变，唯独商品表，通过关联</span><span lang=EN-US style='color:
black'>3</span><span lang=ZH-CN style='font-family:SimSun;color:black'>张分类表，增加了</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              category2_id`
string COMMENT '2id',  </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              `category1_id`
string COMMENT '3id',  </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              `category3_name`
string COMMENT '3',  </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              `category2_name`
string COMMENT '2',  </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              `category1_name`
string COMMENT '1',  </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>小结：</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）维度退化要付出什么代价？或者说会造成什么样的需求处理不了？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>如果被退化的维度，还有其他业务表使用，退化后处理起来就麻烦些。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
</span><span lang=ZH-CN style='font-family:SimSun;color:black'>还有如果要删除数据，对应的维度可能也会被永久删除。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）想想在实际业务中还有那些维度表可以退化</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>城市的三级分类（省、市、县）等</span></p>

<h3><a name="_Toc9169"></a><a name="_Toc10725316"><span lang=EN-US>6.8.3 dws</span></a><span
lang=ZH-CN style='font-family:SimSun'>层</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:"Verdana",sans-serif;color:black'><img border=0 width=411
height=234 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image045.jpg"></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从订单表</span><span lang=EN-US
style='color:black'> dwd_order_info </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中获取</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>下单次数</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>和</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>下单总金额</span><span lang=ZH-CN
style='color:black'> </span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从支付流水表</span><span
lang=EN-US style='color:black'> dwd_payment_info </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>中获取</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付次数</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付总金额</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从事件日志评论表</span><span
lang=EN-US style='color:black'> dwd_comment_log </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>中获取评论次数</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>最终按照</span><span lang=EN-US
style='color:black'>user_id</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>聚合，获得明细，跟之前的</span><span lang=EN-US style='color:black'>mid_id</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>聚合不同</span></p>

<h2><a name="_Toc10725317"></a><a name="_Toc23979"><span lang=EN-US>6.9 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求一：</span><span lang=EN-US>GMV</span><span
lang=ZH-CN style='font-family:SimHei'>成交总额</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=413 height=236 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image046.jpg"></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从用户行为宽表中</span><span
lang=EN-US style='color:black'>dws_user_action</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，根据统计日期分组，聚合，直接</span><span lang=EN-US
style='color:black'>sum</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>就可以了。</span></p>

<h2><a name="_Toc14783"></a><a name="_Toc10725318"><span lang=EN-US>6.10 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求二：转化率</span></h2>

<h3><a name="_Toc10725319"></a><a name="_Toc30346"><span lang=EN-US>6.10.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>新增用户占日活跃用户比率表</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=411 height=234 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image047.jpg"></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从日活跃数表</span><span
lang=EN-US style='color:black'> ads_uv_count </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>和</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>日新增设备数表</span><span lang=EN-US style='color:black'>
ads_new_mid_count </span><span lang=ZH-CN style='font-family:SimSun;color:black'>中取即可。</span></p>

<h3><a name="_Toc10725320"></a><a name="_Toc17217"><span lang=EN-US>6.10.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>用户行为转化率表</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=414 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image048.jpg"></span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从用户行为宽表</span><span
lang=EN-US style='color:black'>dws_user_action</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>中取，下单人数（只要下单次数</span><span lang=EN-US
style='color:black'>&gt;0</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>,</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>支付人数（只要支付次数</span><span
lang=EN-US style='color:black'>&gt;0</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从日活跃数表</span><span
lang=EN-US style='color:black'> ads_uv_count </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>中取活跃人数，然后对应的相除就可以了。</span></p>

<h2><a name="_Toc10725321"></a><a name="_Toc12611"><span lang=EN-US>6.11 </span></a><span
lang=ZH-CN style='font-family:SimHei'>需求三：品牌复购率</span></h2>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>需求：以月为单位统计，购买</span><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>次以上商品的用户</span></p>

<h3><a name="_Toc10725322"></a><a name="_Toc4730"><span lang=EN-US>6.11.1 </span></a><span
lang=ZH-CN style='font-family:SimSun'>用户购买商品明细表（宽表）</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=410 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image049.jpg"></span></p>

<h3><a name="_Toc13838"></a><a name="_Toc10725323"><span lang=EN-US>6.11.2 </span></a><span
lang=ZH-CN style='font-family:SimSun'>品牌复购率表</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=414 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image050.jpg"></span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>从用户购买商品明细宽表</span><span
lang=EN-US style='color:black'>dws_sale_detail_daycount</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>中，根据品牌</span><span lang=EN-US
style='color:black'>id--sku_tm_id</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>聚合，计算每个品牌购买的总次数，购买人数</span><span lang=EN-US
style='color:black'>a=</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>购买次数</span><span lang=EN-US style='color:black'>&gt;=1,</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>两次及以上购买人数</span><span
lang=EN-US style='color:black'>b=</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>购买次数</span><span lang=EN-US style='color:black'>&gt;=2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，三次及以上购买人数</span><span
lang=EN-US style='color:black'>c=</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>购买次数</span><span lang=EN-US style='color:black'>&gt;=3,</span></p>

<p class=MsoNormal style='margin-left:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>单次复购率</span><span lang=EN-US
style='color:black'>=b/a</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，多次复购率</span><span lang=EN-US style='color:black'>=c/a</span></p>

<h2><a name="_Toc10725324"></a><a name="_Toc23259"><span lang=EN-US>6.12 </span></a><span
lang=ZH-CN style='font-family:SimHei'>项目中有多少张宽表</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>宽表要</span><span lang=EN-US
style='color:black'>3-5</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>张，用户行为宽表，用户购买商品明细行为宽表，商品宽表，购物车宽表，物流宽表、登录注册、售后等。</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:150%;
text-autospace:none'><span lang=EN-US style='line-height:150%;font-family:"Verdana",sans-serif;
color:black'>1</span><span lang=ZH-CN style='line-height:150%;font-family:SimSun;
color:black'>）为什么要建宽表</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:21.0pt;
line-height:150%;text-autospace:none'><span lang=ZH-CN style='line-height:150%;
font-family:SimSun;color:black'>需求目标，把每个用户单日的行为聚合起来组成一张多列宽表，以便之后关联用户维度信息后进行，不同角度的统计分析。</span></p>

<h2><a name="_Toc10725325"></a><a name="_Toc20041"><span lang=EN-US>6.13 </span></a><span
lang=ZH-CN style='font-family:SimHei'>拉链表</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=414 height=233 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image051.jpg" alt=1572859809453></span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>订单表拉链表</span><span lang=EN-US style='color:black'>
dwd_order_info_his</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       `id`
string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;color:black'>订单编号</span><span
lang=EN-US style='color:black'>',</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`total_amount` decimal(10,2) COMMENT '</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>订单金额</span><span lang=EN-US style='color:black'>', </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`order_status` string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>订单状态</span><span lang=EN-US style='color:black'>', </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`user_id` string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>用户</span><span lang=EN-US style='color:black'>id' ,</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`payment_way` string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付方式</span><span lang=EN-US style='color:black'>',  </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`out_trade_no` string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付流水号</span><span lang=EN-US style='color:black'>',  </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`create_time` string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>创建时间</span><span lang=EN-US style='color:black'>',  </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`operate_time` string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>操作时间</span><span lang=EN-US style='color:black'>' ,</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`start_date`  string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>有效开始日期</span><span lang=EN-US style='color:black'>',</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>   
`end_date`  string COMMENT '</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>有效结束日期</span><span lang=EN-US style='color:black'>'</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）创建订单表拉链表，字段跟拉链表一样，只增加了有效开始日期和有效结束日期</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>初始日期，从订单变化表</span><span lang=EN-US style='color:black'>ods_order_info</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>导入数据，且让有效开始时间</span><span
lang=EN-US style='color:black'>=</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>当前日期，有效结束日期</span><span lang=EN-US style='color:black'>=9999-99-99</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>（从</span><span lang=EN-US style='color:black'>mysql</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>导入数仓的时候就只导了新增的和变化的数据</span><span
lang=EN-US style='color:black'>ods_order_info</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>dwd_order_info</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>跟</span><span lang=EN-US style='color:black'>ods_order_info</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>基本一样，只多了一个</span><span
lang=EN-US style='color:black'>id</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的判空处理）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）建一张拉链临时表</span><span
lang=EN-US style='color:black'>dwd_order_info_his_tmp</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，字段跟拉链表完全一致</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）新的拉链表中应该有这几部分数据，</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）增加订单变化表</span><span lang=EN-US style='color:black'>dwd_order_info</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的全部数据</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）更新旧的拉链表左关联订单变化表</span><span lang=EN-US style='color:black'>dwd_order_info</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，关联字段：订单</span><span
lang=EN-US style='color:black'>id, where </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>过滤出</span><span lang=EN-US
style='color:black'>end_date</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>只等于</span><span lang=EN-US style='color:black'>9999-99-99</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的数据，如果旧的拉链表中的</span><span
lang=EN-US style='color:black'>end_date</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>不等于</span><span lang=EN-US
style='color:black'>9999-99-99</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，说明已经是终态了，不需要再更新</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>如果</span><span lang=EN-US
style='color:black'>dwd_order_info.id is null , </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>没关联上，说明数据状态没变，让</span><span lang=EN-US
style='color:black'>end_date</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>还等于旧的</span><span lang=EN-US style='color:black'>end_date</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>如果</span><span lang=EN-US
style='color:black'>dwd_order_info.id is not null , </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>关联上了，说明数据状态变了，让</span><span lang=EN-US
style='color:black'>end_date</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>等于当前日期</span><span lang=EN-US style='color:black'>-1</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>把查询结果插入到拉链临时表中</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）把拉链临时表覆盖到旧的拉链表中</span></p>

<h1><a name="_Toc10725327"></a><a name="_Toc23859"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>7</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=ZH-CN style='font-family:SimSun'>项目中遇到过哪些问题</span></h1>

<h2><a name="_Toc2247"></a><a name="_Toc10725328"><span lang=EN-US>7.1 Hadoop</span></a><span
lang=ZH-CN style='font-family:SimHei'>宕机</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='font-family:SimSun;color:black'>1</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）如果</span><span lang=EN-US
style='font-family:SimSun;color:black'>MR</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>造成系统宕机。此时要控制</span><span lang=EN-US
style='font-family:SimSun;color:black'>Yarn</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>同时运行的任务数，和每个任务申请的最大内存。调整参数：</span><span
lang=EN-US style='font-family:SimSun;color:black'>yarn.scheduler.maximum-allocation-mb</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（单个任务可申请的最多物理内存量，默认是</span><span
lang=EN-US style='font-family:SimSun;color:black'>8192MB</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='font-family:SimSun;color:black'>2</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）如果写入文件过量造成</span><span lang=EN-US
style='font-family:SimSun;color:black'>NameNode</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>宕机。那么调高</span><span lang=EN-US
style='font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的存储大小，控制从</span><span lang=EN-US
style='font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>到</span><span lang=EN-US
style='font-family:SimSun;color:black'>HDFS</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的写入速度。高峰期的时候用</span><span lang=EN-US
style='font-family:SimSun;color:black'>Kafka</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>进行缓存，高峰期过去数据同步会自动跟上。</span></p>

<h2><a name="_Toc322"></a><a name="_Toc10725330"><span lang=EN-US>7.2 Flume</span></a><span
lang=ZH-CN style='font-family:SimHei'>小文件</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='font-family:SimSun;color:black'>Flume</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>上传文件到</span><span lang=EN-US
style='font-family:SimSun;color:black'>HDFS</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>时参数大量小文件</span><span lang=EN-US
style='font-family:SimSun;color:black'>?</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>调整</span><span lang=EN-US
style='color:black'>hdfs.rollInterval</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>hdfs.rollSize</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>hdfs.rollCount</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>这三个参数的值。</span></p>

<h2><a name="_Toc22943"></a><a name="_Toc10725331"><span lang=EN-US>7.3 Kafka</span></a><span
lang=ZH-CN style='font-family:SimHei'>挂掉</span></h2>

<p class=a1 style='margin-left:22.05pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>Flume</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>记录</span></p>

<p class=a1 style='margin-left:22.05pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）日志有记录</span></p>

<p class=a1 style='margin-left:22.05pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>）短期没事</span></p>

<h2><a name="_Toc10725332"></a><a name="_Toc12495"><span lang=EN-US>7.4 Kafka</span></a><span
lang=ZH-CN style='font-family:SimHei'>消息数据积压，</span><span lang=EN-US>Kafka</span><span
lang=ZH-CN style='font-family:SimHei'>消费能力不足怎么处理？</span><span lang=ZH-CN> </span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）如果是</span><span lang=EN-US style='color:black'>Kafka</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>消费能力不足，则可以考虑增加</span><span
lang=EN-US style='color:black'>Topic</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的分区数，并且同时提升消费组的消费者数量，消费者数</span><span lang=EN-US
style='color:black'>=</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>分区数。（两者缺一不可）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）如果是下游的数据处理不及时：提高每批次拉取的数量。批次拉取数据过少（拉取数据</span><span lang=EN-US
style='color:black'>/</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>处理时间</span><span lang=EN-US style='color:black'>&lt;</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>生产速度），使处理的数据小于生产的数据，也会造成数据积压。</span></p>

<h2><a name="_Toc10725333"></a><a name="_Toc22874"><span lang=EN-US>7.5 Kafka</span></a><span
lang=ZH-CN style='font-family:SimHei'>数据重复</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>在下一级消费者中去重。（</span><span
lang=EN-US style='color:black'>redis</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>SparkStreaming</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span></p>

<h2><a name="_Toc10390"></a><a name="_Toc10725334"><span lang=EN-US>7.6 Mysql</span></a><span
lang=ZH-CN style='font-family:SimHei'>高可用</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Hive</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的</span><span lang=EN-US style='color:black'>metadata</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>存储在</span><span lang=EN-US
style='color:black'>MySql</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>中（配置</span><span lang=EN-US style='color:black'>MySql</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的高可用（主从复制和读写分离和故障转移））</span></p>

<h2><a name="_Toc9909"></a><a name="_Toc10725335"><span lang=EN-US>7.7 </span></a><span
lang=ZH-CN style='font-family:SimHei'>自定义</span><span lang=EN-US>UDF</span><span
lang=ZH-CN style='font-family:SimHei'>和</span><span lang=EN-US>UDTF</span><span
lang=ZH-CN style='font-family:SimHei'>解析和调试复杂字段</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span lang=EN-US
style='color:black'>UDF</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>（</span><span lang=EN-US style='color:black'>extends UDF </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>实现</span><span lang=EN-US
style='color:black'>evaluate</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法）</span><span lang=ZH-CN style='color:black'> </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>解析公共字段</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>自定义</span><span
lang=EN-US style='color:black'>UDTF(extends Genertic UDTF-&gt;</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>实现三个方法</span><span
lang=EN-US style='color:black'>init(</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>指定返回值的名称和类型</span><span lang=EN-US style='color:black'>)</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>process(</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>处理字段一进多出</span><span lang=EN-US style='color:black'>)</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>close</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法</span><span lang=EN-US style='color:black'>) -&gt; </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>更加灵活以及方便定义</span><span
lang=EN-US style='color:black'>bug</span></p>

<h2><a name="_Toc21902"></a><a name="_Toc10725336"><span lang=EN-US>7.8 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimHei'>数据导出</span><span lang=EN-US>Parquet</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Ads</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>层数据用</span><span lang=EN-US style='color:black'>Sqoop</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>往</span><span lang=EN-US
style='color:black'>MySql</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>中导入数据的时候，如果用了</span><span lang=EN-US style='color:black'>orc</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>Parquet</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）不能导入，需转化成</span><span lang=EN-US style='color:black'>text</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>格式</span></p>

<h2><a name="_Toc10725337"></a><a name="_Toc18259"><span lang=EN-US>7.9 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimHei'>数据导出控制</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>Sqoop</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中导入导出</span><span lang=EN-US style='color:black'>Null</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>存储一致性问题：</span><span
lang=EN-US style='color:black'>    </span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=EN-US style='color:black'>Hive</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>中的</span><span lang=EN-US
style='color:black'>Null</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>在底层是以“</span><span lang=EN-US style='color:black'>\N</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>”来存储，而</span><span
lang=EN-US style='color:black'>MySQL</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中的</span><span lang=EN-US style='color:black'>Null</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>在底层就是</span><span lang=EN-US
style='color:black'>Null</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，为了保证数据两端的一致性。在导出数据时采用</span><span lang=EN-US style='color:black'>--input-null-string</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>--input-null-non-string</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>两个参数。导入数据时采用</span><span lang=EN-US
style='color:black'>--null-string</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>和</span><span lang=EN-US style='color:black'>--null-non-string</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>。</span></p>

<h2><a name="_Toc10725338"></a><a name="_Toc18761"><span lang=EN-US>7.10 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimHei'>数据导出一致性问题</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>当</span><span lang=EN-US
style='color:black'>Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>导出数据到</span><span lang=EN-US style='color:black'>MySql</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>时，使用</span><span lang=EN-US
style='color:black'>4</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>个</span><span lang=EN-US style='color:black'>map</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>怎么保证数据的一致性</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>因为在导出数据的过程中</span><span
lang=EN-US style='color:black'>map</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>任务可能会失败，可以使用</span><span lang=EN-US style='color:black'>—staging-table 
–clear-staging</span></p>

<p class=MsoNormal align=left style='margin-left:21.0pt;text-align:left;
line-height:150%;layout-grid-mode:char;background:#E0E0E0;punctuation-trim:
leading'><span lang=EN-US style='line-height:150%;font-family:"Courier New";
color:black'>sqoop export --connect
jdbc:mysql://192.168.137.10:3306/user_behavior --username root --password
123456 --table <i>app_cource_study_repor</i>t --columns watch_video_cnt,complete_video_cnt,dt
--fields-terminated-by &quot;\t&quot; --export-dir
&quot;/user/hive/warehouse/tmp.db/app_cource_study_analysis_${day}&quot;
--staging-table app_cource_study_report_tmp --clear-staging-table
--input-null-string '\N'</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>任务执行成功首先在</span><span
lang=EN-US style='color:black'>tmp</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>临时表中，然后将</span><span lang=EN-US style='color:black'>tmp</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>表中的数据复制到目标表中（这个时候可以使用事务，保证事务的一致性）</span></p>

<h2><a name="_Toc1803"></a><a name="_Toc10725339"><span lang=EN-US>7.11 SparkStreaming</span></a><span
lang=ZH-CN style='font-family:SimHei'>优雅关闭</span></h2>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>如何优雅的关闭</span><span
lang=EN-US style='color:black'>SparkStreaming</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>任务（将写好的代码打包，</span><span lang=EN-US
style='color:black'>Spark-Submit</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=EN-US style='color:black'>Kill -9 xxx ?</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>开启另外一个线程每</span><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>秒监听</span><span lang=EN-US style='color:black'>HDFS</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>上一个文件是否存在。如果检测到存在，调用</span><span
lang=EN-US style='color:black'>ssc.stop()</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>方法关闭</span><span lang=EN-US
style='color:black'>SparkStreaming</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>任务（当你要关闭任务时，可以创建你自定义监控的文件目录）</span></p>

<h2><a name="_Toc26246"></a><a name="_Toc10725340"><span lang=EN-US>7.12 Spark
OOM</span></a><span lang=ZH-CN style='font-family:SimHei'>、数据倾斜解决</span></h2>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'><img
border=0 width=201 height=235 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image052.jpg"><img border=0
width=210 height=235 id="图片 5" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image053.jpg"></span></p>

<h1><a name="_Toc4804"></a><a name="_Toc10725341"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>9</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=ZH-CN style='font-family:SimSun'>项目经验</span></h1>

<h2><a name="_Toc12078"></a><a name="_Toc10725342"><span lang=EN-US>9.1 </span></a><span
lang=ZH-CN style='font-family:SimHei'>框架经验</span></h2>

<h3><a name="_Toc10725343"></a><a name="_Toc13041"><span lang=EN-US>9.1.1
Hadoop</span></a></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Hadoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>集群基准测试（</span><span lang=EN-US style='color:black'>HDFS</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的读写性能、</span><span
lang=EN-US style='color:black'>MapReduce</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>的计算能力测试）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）一台服务器一般都有很多个硬盘插槽（插了几个插槽）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>如果不配置</span><span lang=EN-US
style='color:black'>datanode.data.dir</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>多目录，每次插入一块新的硬盘都需要重启服务器</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>配置了即插即用</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Hdfs</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>参数调优</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=EN-US style='color:black'>Namenode</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>有一个工作线程池，用来处理与</span><span lang=EN-US
style='color:black'>datanode</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>的心跳（报告自身的健康状况和文件恢复请求）和元数据请求</span><span lang=ZH-CN
style='color:black'> </span><span lang=EN-US style='color:black'>   dfs.namenode.handler.count=20
* log2(Cluster Size)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）编辑日志存储路径</span><span
lang=EN-US style='color:black'>dfs.namenode.edits.dir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>设置与镜像文件存储路径</span><span lang=EN-US
style='color:black'>dfs.namenode.name.dir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>尽量分开，达到最低写入延迟（提高写入的吞吐量）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>YARN</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>参数调优</span><span lang=EN-US style='color:black'>yarn-site.xml</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）服务器</span><span lang=ZH-CN style='font-family:SimSun;color:black'>节点上</span><span
lang=EN-US style='font-family:SimSun;color:black'>YARN</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>可使用的物理内存总量，默认是</span><span lang=EN-US
style='font-family:SimSun;color:black'>8192</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='font-family:SimSun;color:black'>MB</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='font-family:SimSun;color:black'>2</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）单个任务可申请的最多物理内存量，默认是</span><span
lang=EN-US style='font-family:SimSun;color:black'>8192</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='font-family:SimSun;color:black'>MB</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>）。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='font-family:
SimSun;color:black'>6</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='font-family:SimSun;color:black'>HDFS</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>和硬盘空闲控制在</span><span
lang=EN-US style='font-family:SimSun;color:black'>70%</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>以下。</span></p>

<h3><a name="_Toc10064"></a><a name="_Toc10725344"><span lang=EN-US>9.1.2 Flume</span></a></h3>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>1)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>Flume</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>内存配置为</span><span lang=EN-US style='color:black'>4G</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>flume-env.sh</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>修改）</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>2)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>FileChannel</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>优化</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>通过配置</span><span lang=EN-US
style='color:black'>dataDirs</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>指向多个路径，每个路径对应不同的硬盘，增大</span><span lang=EN-US style='color:black'>Flume</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>吞吐量。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>checkpointDir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>和</span><span lang=EN-US
style='color:black'>backupCheckpointDir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>也尽量配置在不同硬盘对应的目录中，保证</span><span
lang=EN-US style='color:black'>checkpoint</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>坏掉后，可以快速使用</span><span lang=EN-US
style='color:black'>backupCheckpointDir</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>恢复数据</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>3)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>Sink</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>：</span><span lang=EN-US style='color:black'>HDFS Sink</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>小文件处理</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>这三个参数配置写入</span><span
lang=EN-US style='color:black'>HDFS</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>后会产生小文件，</span><span lang=EN-US style='color:black'>hdfs.rollInterval</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>hdfs.rollSize</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>hdfs.rollCount</span></p>

<h3><a name="_Toc27438"></a><a name="_Toc10725345"><span lang=EN-US>9.1.3 Kafka</span></a></h3>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>1)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的吞吐量测试（测试生产速度和消费速度）</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>2)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>内存为</span><span lang=EN-US style='color:black'>6G</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（不能超过</span><span lang=EN-US
style='color:black'>6G</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>3)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>数量确定：</span><span lang=EN-US style='color:black'>2 * </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>峰值生产速度（</span><span
lang=EN-US style='color:black'>m/s</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）</span><span lang=EN-US style='color:black'>* </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>副本数</span><span lang=ZH-CN
style='color:black'> </span><span lang=EN-US style='color:black'>/ 100  + 1 = ?</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>4)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中的数据量计算</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>每天数据总量</span><span
lang=EN-US style='color:black'>100g(1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>亿条</span><span lang=EN-US style='color:black'>)   10000</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>万</span><span lang=EN-US
style='color:black'>/24/60/60 = 1150</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>条</span><span lang=EN-US style='color:black'>/s</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>平均每秒钟：</span><span
lang=EN-US style='color:black'>1150</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>条</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>低谷每秒：</span><span
lang=EN-US style='color:black'>400</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>条</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>高峰每秒钟：</span><span
lang=EN-US style='color:black'>1150 * 10 = 11000 </span><span lang=ZH-CN
style='font-family:SimSun;color:black'>条</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>每条日志大小：</span><span
lang=ZH-CN style='color:black'> </span><span lang=EN-US style='color:black'>1K</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>左右</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>每秒多少数据量：</span><span
lang=EN-US style='color:black'>20MB</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt;
line-height:150%'><span lang=EN-US style='color:black'>5)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
lang=EN-US style='color:black'>Kafka</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>消息数据积压，</span><span lang=EN-US style='color:black'>Kafka</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>消费能力不足怎么处理？</span><span
lang=ZH-CN style='color:black'> </span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）如果是</span><span lang=EN-US style='color:black'>Kafka</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>消费能力不足，则可以考虑增加</span><span
lang=EN-US style='color:black'>Topic</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的分区数，并且同时提升消费组的消费者数量，消费者数</span><span lang=EN-US
style='color:black'>=</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>分区数。（两者缺一不可）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）如果是下游的数据处理不及时：提高每批次拉取的数量。批次拉取数据过少（拉取数据</span><span lang=EN-US
style='color:black'>/</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>处理时间</span><span lang=EN-US style='color:black'>&lt;</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>生产速度），使处理的数据小于生产的数据，也会造成数据积压。</span></p>

<h3><a name="_Toc7379"></a><a name="_Toc10725346"><span lang=EN-US>9.1.4 MySql</span></a><span
lang=ZH-CN style='font-family:SimSun'>之元数据备份</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>元数据备份（重点，如数据损坏，可能整个集群无法运行，至少要保证每日零点之后备份到其它服务器两个复本）</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h3><a name="_Toc12178"></a><a name="_Toc10725348"><span lang=EN-US>9.1.5 Sqoop</span></a><span
lang=ZH-CN style='font-family:SimSun'>参数</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>导入导出</span><span lang=EN-US style='color:black'>Null</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>存储一致性问题</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数据导出一致性问题</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>–staging-table</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>方式</span><span lang=ZH-CN
style='color:black'> </span><span lang=EN-US style='line-height:150%;
color:black'>--clear-staging</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数据导出的时候一次执行多长时间</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Sqoop</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>任务</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>5</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>分钟</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>-2</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>个小时的都有。取决于数据量。</span></p>

<h3><a name="_Toc25089"></a><a name="_Toc10725349"><span lang=EN-US>9.1.6
Azkaban</span></a><span lang=ZH-CN style='font-family:SimSun'>每天执行多少个任务</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）每天集群运行多少</span><span lang=EN-US style='color:black'>job?</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）多个指标（</span><span lang=EN-US style='color:black'>200</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>*6=1200</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>（</span><span lang=EN-US style='color:black'>1000-2000</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>个</span><span lang=EN-US
style='color:black'>job</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）每天集群运行多少个</span><span lang=EN-US style='color:black'>task? 1000*</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>5-8</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>=5000</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>多个</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span
lang=EN-US style='color:black'>4</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）任务挂了怎么办？运行成功或者失败都会发邮件</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=EN-US style='color:black'>Zip a.job b.job c.job   job.zip  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>把压缩的</span><span lang=EN-US
style='color:black'>zip</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>包放到</span><span lang=EN-US style='color:black'>azkaban</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的</span><span lang=EN-US
style='color:black'>web</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>界面上提交（指定</span><span lang=EN-US style='color:black'>sechduler</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span></p>

<h2><a name="_Toc9637"></a><a name="_Toc10725350"><span lang=EN-US>9.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>业务经验</span></h2>

<h3><a name="_Toc10725351"></a><a name="_Toc14609"><span lang=EN-US>9.2.1 ODS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层采用什么压缩方式和存储格式？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>压缩采用</span><span lang=EN-US style='color:black'>Snappy</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，存储采用</span><span lang=EN-US
style='color:black'>orc</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，压缩比是</span><span lang=EN-US style='color:black'>100g</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>数据压缩完</span><span lang=EN-US
style='color:black'>10g</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>左右。</span></p>

<h3><a name="_Toc10725352"></a><a name="_Toc22064"><span lang=EN-US>9.2.2 DWD</span></a><span
lang=ZH-CN style='font-family:SimSun'>层做了哪些事？</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）数据清洗</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）空值去除</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span
lang=EN-US style='color:black'>2</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）过滤核心字段无意义的数据，比如订单表中订单</span><span lang=EN-US
style='color:black'>id</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>为</span><span lang=EN-US style='color:black'>null</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，支付表中支付</span><span
lang=EN-US style='color:black'>id</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>为空</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span
lang=EN-US style='color:black'>3</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）对手机号、身份证号等敏感数据脱敏</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span
lang=EN-US style='color:black'>4</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）对业务数据传过来的表进行维度退化和降维。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>）将用户行为宽表和业务表进行数据一致性处理</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>select case when a is null then b else a end as
JZR,</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>    ...</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>from A</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）清洗的手段</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       Sql</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>mr</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>rdd</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>kettle</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>Python</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（项目中采用</span><span
lang=EN-US style='color:black'>sql</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>进行清除）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）清洗掉多少数据算合理</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>万条数据清洗掉</span><span
lang=EN-US style='color:black'>1</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>条。</span></p>

<h3><a name="_Toc24923"></a><a name="_Toc10725353"><span lang=EN-US>9.2.3 DWS</span></a><span
lang=ZH-CN style='font-family:SimSun'>层做了哪些事？</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>DWS</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>层有</span><span lang=EN-US style='color:black'>3-5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>张宽表（处理</span><span
lang=EN-US style='color:black'>100-200</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个指标</span><span lang=ZH-CN style='color:black'> </span><span
lang=EN-US style='color:black'>  70%</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>以上的需求）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>具体宽表名称：用户行为宽表，用户购买商品明细行为宽表，商品宽表，购物车宽表，物流宽表、登录注册、售后等。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）哪个宽表最宽？大概有多少个字段？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>最宽的是用户行为宽表。大概有</span><span
lang=EN-US style='color:black'>60-100</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>个字段</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）具体用户行为宽表字段名称</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>评论、打赏、收藏、关注</span><span
lang=EN-US style='color:black'>--</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>商品、关注</span><span lang=EN-US style='color:black'>--</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>人、点赞、分享、好价爆料、文章发布、活跃、签到、补签卡、幸运屋、礼品、金币、电商点击、</span><span
lang=EN-US style='color:black'>gmv</span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>CREATE
TABLE `app_usr_interact`(</span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`stat_dt` date COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>互动日期</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`user_id` string COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>用户</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>id', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`nickname` string COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>用户昵称</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`register_date` string COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>注册日期</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`register_from` string COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>注册来源</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`remark` string COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>细分渠道</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`province` string COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>注册省份</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`pl_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>评论次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`ds_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>打赏次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`sc_add` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>添加收藏</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`sc_cancel` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>取消收藏</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gzg_add` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>关注商品</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gzg_cancel` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>取消关注商品</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gzp_add` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>关注人</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gzp_cancel` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>取消关注人</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`buzhi_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>点不值次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`zhi_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>点值次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`zan_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>点赞次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`share_cnts` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>分享次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`bl_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>爆料数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`fb_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>好价发布数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`online_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>活跃次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`checkin_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>签到次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`fix_checkin` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>补签次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`house_point` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>幸运屋金币抽奖次数</span><span
lang=EN-US style='font-size:9.0pt;line-height:125%;font-family:Consolas;
color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`house_gold` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>幸运屋积分抽奖次数</span><span
lang=EN-US style='font-size:9.0pt;line-height:125%;font-family:Consolas;
color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`pack_cnt` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>礼品兑换次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gold_add` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>获取金币</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gold_cancel` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>支出金币</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`surplus_gold` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>剩余金币</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`event` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>电商点击次数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gmv_amount` bigint COMMENT 'gmv', </span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'> 
`gmv_sales` bigint COMMENT '</span><span lang=ZH-CN style='font-size:9.0pt;
line-height:125%;font-family:SimSun;color:black'>订单数</span><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>')</span></p>

<p class=MsoNormal style='margin-left:21.0pt'><span lang=EN-US
style='font-size:9.0pt;line-height:125%;font-family:Consolas;color:black'>PARTITIONED
BY (  `dt` string)</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）商品详情</span><span lang=ZH-CN
style='color:black'>  </span><span lang=EN-US style='color:black'>-----  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>购物车</span><span lang=ZH-CN
style='color:black'>  </span><span lang=EN-US style='color:black'>----- </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单</span><span lang=ZH-CN
style='color:black'>  </span><span lang=EN-US style='color:black'>------ </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>付款的转换比率</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:0cm;line-height:
150%'><span lang=EN-US style='color:black'>       5%          30%        70% </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>6</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）每天的</span><span lang=EN-US
style='color:black'>GMV</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>是多少，哪个商品卖的最好？每天下单量多少？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>1</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）</span><span lang=EN-US style='color:black'>100</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>万的日活每天大概有</span><span
lang=EN-US style='color:black'>10</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>万人购买，平均每人消费</span><span lang=EN-US style='color:black'>100</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>元，一天的</span><span lang=EN-US
style='color:black'>GMV</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>在</span><span lang=EN-US style='color:black'>1000</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>万</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>2</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）面膜，每天销售</span><span lang=EN-US style='color:black'>5000</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>个</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>（</span><span lang=EN-US
style='color:black'>3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>）每天下单量在</span><span lang=EN-US style='color:black'>10</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>万左右</span></p>

<h3><a name="_Toc7728"></a><a name="_Toc10725354"><span lang=EN-US>9.2.4 </span></a><span
lang=ZH-CN style='font-family:SimSun'>分析过哪些指标（一分钟至少说出</span><span lang=EN-US>30</span><span
lang=ZH-CN style='font-family:SimSun'>个指标）</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'>1 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>离线指标</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>网站流量指标</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>独立访问数</span><span lang=EN-US style='color:black'>UV  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>页面访客数</span><span lang=EN-US
style='color:black'>PV</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>流量质量指标类</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>跳出率</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>平均页面访问时长</span><span
lang=ZH-CN style='color:black'> </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>人均页面访问数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>2 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>购物车类指标</span><span
lang=ZH-CN style='color:black'>  </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>加入购物车次数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>加入购物车买家次数</span><span
lang=ZH-CN style='color:black'>  </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>加入购物车商品数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>                </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>购物车支付转化率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>3 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>下单类指标</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>下单笔数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>下单金额</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>下单买家数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>浏览下单转化率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>4 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>支付类指标</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付金额</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>支付买家数</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付商品数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>浏览</span><span lang=EN-US
style='color:black'>-</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付买家转化率</span><span lang=ZH-CN style='color:black'> </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>下单</span><span lang=EN-US
style='color:black'>-</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付金额转化率</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>下单</span><span lang=EN-US
style='color:black'>-</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>支付买家数转换率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>5 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>交易类指标</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>交易成功订单数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>交易成功金额</span><span
lang=ZH-CN style='color:black'>  </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>交易成功买家数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>交易成功商品数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>交易失败订单数</span><span
lang=ZH-CN style='color:black'>  </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>交易失败订单金额</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>交易失败买家数</span><span
lang=ZH-CN style='color:black'>  </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>交易失败商品数</span><span
lang=ZH-CN style='color:black'>  </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>退款总订单量</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>退款金额</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>退款率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>6 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>市场营销活动指标</span><span
lang=ZH-CN style='color:black'> </span><span lang=EN-US style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>新增访问人数</span><span
lang=ZH-CN style='color:black'> </span><span lang=EN-US style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>新增注册人数</span><span
lang=ZH-CN style='color:black'>  </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>广告投资回报率</span><span lang=ZH-CN style='color:black'>  </span><span
lang=EN-US style='color:black'>UV</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>订单转化率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>7 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>风控类指标</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>买家评价数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>买家上传图片数</span><span
lang=ZH-CN style='color:black'>  </span><span lang=ZH-CN style='font-family:
SimSun;color:black'>买家评价率</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>买家好评率</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>买家差评率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>物流平均配送时间</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>8 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>投诉类指标</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>发起投诉数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>投诉率</span><span lang=ZH-CN
style='color:black'> </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>撤销投诉</span><span lang=EN-US style='color:black'>(</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>申诉数</span><span lang=EN-US
style='color:black'>)</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>9 </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>商品类指标</span><span lang=ZH-CN
style='color:black'>  </span><span lang=ZH-CN style='font-family:SimSun;
color:black'>产品总数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=EN-US style='color:black'>SKU</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=EN-US style='color:black'>SPU</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>数</span><span lang=ZH-CN style='color:black'>  </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>              </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>上架商品</span><span lang=EN-US
style='color:black'>SKU</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>上架商品</span><span lang=EN-US
style='color:black'>SPU</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数</span><span lang=ZH-CN style='color:black'>  </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>上架商品数</span><span lang=ZH-CN
style='color:black'>  </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=416 height=565 id="图片 3" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image054.jpg"></span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>日活跃用户，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>月活跃用户，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>各区域</span><span lang=EN-US
style='color:black'>Top10</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>商品统计，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>季度商品品类点击率</span><span lang=EN-US
style='color:black'>top10</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>用户留存，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>月</span><span lang=EN-US
style='color:black'>APP</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>的用户增长人数，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>广告区域点击数</span><span lang=EN-US
style='color:black'>top3</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>活跃用户每天在线时长，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>投诉人数占比，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>沉默用户占比，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>用户的新鲜度，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>商品上架的</span><span lang=EN-US
style='color:black'>sku</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>数，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>同种品类的交易额排名，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>统计买家的评价率，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>用户浏览时长，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>统计下单的数量，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>统计支付的数量，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>统计退货的数量，</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>用户的（日活、月活、周活），</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun;color:black'>统计流失人数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<p class=MsoNormal><span lang=ZH-CN style='line-height:125%;font-family:SimSun;
color:black'>日活，周活，月活，沉默用户占比，增长人数，活跃用户占比，在线时长统计，歌曲访问数，歌曲访问时长，各地区</span><span
lang=EN-US style='line-height:125%;color:black'>Top10</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>歌曲统计</span><span
lang=ZH-CN style='line-height:125%;color:black'> </span><span lang=EN-US
style='line-height:125%;color:black'>,</span><span lang=ZH-CN style='line-height:
125%;font-family:SimSun;color:black'>投诉人数占比，投诉回应时长，留存率，月留存率，转化率，</span><span
lang=EN-US style='line-height:125%;color:black'>GMV</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>，复购</span><span
lang=EN-US style='line-height:125%;color:black'>vip</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>率，</span><span
lang=EN-US style='line-height:125%;color:black'>vip</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>人数，歌榜，挽回率，粉丝榜，打赏次数，打赏金额，发布歌曲榜单，歌曲热度榜单，歌手榜单，用户年龄组，</span><span
lang=EN-US style='line-height:125%;color:black'>vip</span><span lang=ZH-CN
style='line-height:125%;font-family:SimSun;color:black'>年龄组占比，收藏数榜单，评论数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    1.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>用户活跃数统计（日活，月活，周活）</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    2.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>某段时间的新增用户</span><span
lang=EN-US style='color:black'>/</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>活跃用户数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    3.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>页面单跳转化率统计</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    4.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>活跃人数占比（占总用户比例）</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='color:black'>5.</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>在线时长统计（活跃用户每天在线时长）</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=EN-US
style='color:black'>12.</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>统计本月的人均在线时长</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    6.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>订单产生效率（下单的次数与访问次数比）</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    7.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>页面访问时长（单个页面访问时长）</span><span
lang=EN-US style='color:black'>    </span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    8.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计本季度付款订单</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    9.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计某广告的区城点击数</span><span
lang=EN-US style='color:black'>top3</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    10.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计本月用户的流失人数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    11.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计本月流失人数占用户人数的比例</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    13.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计本月</span><span lang=EN-US
style='color:black'>APP</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>的用户增长人数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    14.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计本月的沉默用户</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    15.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计某时段的登录人数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    16.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计本日用户登录的次数平均值</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    17.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计用户在某类型商品中的浏览深度（页面转跳率）</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    18.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计用户从下单开始到交易成功的平均时长</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    19.Top10</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>热门商品的统计</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    20.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计下单的数量</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    21.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计支付的数量</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    22.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计退货的数量</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    23.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计动销率（有销量的商品</span><span
lang=EN-US style='color:black'>/</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>在线销售的宝贝）</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    24.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计支付转化率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    25.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计用户的消费频率</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    26.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计商品上架的</span><span
lang=EN-US style='color:black'>SKU</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>数</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    27.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计同种品类的交易额排名</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    28.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计按下单退款排序的</span><span
lang=EN-US style='color:black'>top10</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>的商品</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    29.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>统计本</span><span lang=EN-US
style='color:black'>APP</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>的投诉人数占用户人数的比例</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>    30.</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>用户收藏商品</span></p>

<h3><a name="_Toc31457"></a><a name="_Toc10725355"><span lang=EN-US>9.2.5 </span></a><span
lang=ZH-CN style='font-family:SimSun'>分析过最难的两个指标，现场手写</span></h3>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image055.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=410 height=232 src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image056.jpg"></span></p>

<h3><a name="_Toc24753"></a><a name="_Toc10725356"><span lang=EN-US>9.2.6 </span></a><span
lang=ZH-CN style='font-family:SimSun'>数据仓库每天跑多少张表，大概什么时候运行，运行多久？</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>基本一个项目建一个库，表格个数为初始的原始数据表格加上统计结果表格的总数。（一般</span><span
lang=EN-US style='color:black'>70-100</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>张表格）</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>每天</span><span lang=EN-US
style='color:black'>0</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>：</span><span lang=EN-US style='color:black'>30</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>开始运行。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>所有离线数据报表控制在</span><span
lang=EN-US style='color:black'>8</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>小时之内</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>大数据实时处理部分控制在</span><span
lang=EN-US style='color:black'>5</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>分钟之内。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='color:black'>&nbsp;</span></p>

<h3><a name="_Toc10725357"></a><a name="_Toc23365"><span lang=EN-US>9.2.7 </span></a><span
lang=ZH-CN style='font-family:SimSun'>数仓中使用的哪种文件存储格式</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>常用的包括：</span><span
lang=EN-US style='color:black'>textFile</span><span lang=ZH-CN
style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>rcFile</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，</span><span lang=EN-US style='color:black'>ORC</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，</span><span lang=EN-US
style='color:black'>Parquet</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，一般企业里使用</span><span lang=EN-US style='color:black'>ORC</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>或者</span><span lang=EN-US
style='color:black'>Parquet</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>，因为是列式存储，且压缩比非常高，所以相比于</span><span lang=EN-US style='color:black'>textFile</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>，查询速度快，占用硬盘空间少</span></p>

<h3><a name="_Toc10725358"></a><a name="_Toc18543"><span lang=EN-US>9.2.8 </span></a><span
lang=ZH-CN style='font-family:SimSun'>数仓中用到过哪些</span><span lang=EN-US>Shell</span><span
lang=ZH-CN style='font-family:SimSun'>脚本及具体功能</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）集群启动停止脚本（</span><span
lang=EN-US style='color:black'>Hadoop</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>、</span><span lang=EN-US style='color:black'>Flume</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>、</span><span lang=EN-US
style='color:black'>Kafka</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>、</span><span lang=EN-US style='color:black'>Zookeeper</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Sqoop</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>和数仓之间的导入导出脚本</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）数仓层级之间的数据导入脚本。</span></p>

<h3><a name="_Toc1905"></a><a name="_Toc10725359"><span lang=EN-US>9.2.9 </span></a><span
lang=ZH-CN style='font-family:SimSun'>项目中用过的报表工具</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>Echarts</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>、</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>kibana</span></p>

<h3><a name="_Toc8027"></a><a name="_Toc10725360"><span lang=EN-US>9.2.10 </span></a><span
lang=ZH-CN style='font-family:SimSun'>测试相关</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）公司有多少台测试服务器？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>测试服务器一般三台</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）测试数据哪来的？</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>一部分自己写</span><span
lang=EN-US style='color:black'>Java</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>程序自己造，一部分从生产环境上取一部分。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）如何保证写的</span><span
lang=EN-US style='color:black'>sql</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>正确性</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>需要造一些特定的测试数据，测试。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>       </span><span
lang=ZH-CN style='font-family:SimSun;color:black'>离线数据和实时数据分析的结果比较。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>4</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）测试环境什么样？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>测试环境的配置是生产的一半</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='color:black'>5</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）测试之后如何上线？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='font-family:SimSun;color:black'>上线的时候，将脚本打包，提交</span><span
lang=EN-US style='color:black'>git</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>。先发邮件抄送经理和总监，运维。通过之后跟运维一起上线。</span></p>

<h3><a name="_Toc24441"></a><a name="_Toc10725361"><span lang=EN-US>9.2.11 </span></a><span
lang=ZH-CN style='font-family:SimSun'>项目实际工作流程</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>1</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>）先与产品讨论，看报表的各个数据从哪些埋点中取</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>2</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>）将取得逻辑过程设计好，与产品确定后开始开发</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>3</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>）开发出报表</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>SQL</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>脚本，并且跑几天的历史数据，观察结果</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>4</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>）将报表放入调度任务中，第二天给产品看结果。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>5</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>）周期性将表结果导出或是导入后台数据库，生成可视化报表</span></p>

<h3><a name="_Toc10725362"></a><a name="_Toc13184"><span lang=EN-US>9.2.12 </span></a><span
lang=ZH-CN style='font-family:SimSun'>项目中实现一个需求大概多长时间</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>刚入职第一个需求大概需要</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>7</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>天左右。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>对业务熟悉后，平均一天一个需求。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=ZH-CN style='font-family:
SimSun;color:black'>影响时间的因素：开会讨论需求、表的权限申请、测试等</span></p>

<h3><a name="_Toc10725363"></a><a name="_Toc13944"><span lang=EN-US>9.2.13 </span></a><span
lang=ZH-CN style='font-family:SimSun'>项目在</span><span lang=EN-US>3</span><span
lang=ZH-CN style='font-family:SimSun'>年内迭代次数，每一个项目具体是如何迭代的。</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>差不多一个月会迭代一次。就产品或我们提出优化需求，然后评估时间。每周我们都会开会做下周计划和本周总结。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>有时候也会去预研一些新技术。</span></p>

<h3><a name="_Toc15324"></a><a name="_Toc10725364"><span lang=EN-US>9.2.14 </span></a><span
lang=ZH-CN style='font-family:SimSun'>项目开发中每天做什么事</span></h3>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>新需求比如埋点或是报表来了之后，需要设计做的方案，设计完成之后跟产品讨论，再开发。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>数仓的任何步骤出现问题，需要查看问题，比如日活，月活下降等。</span></p>

<h1><a name="_Toc7805"></a><a name="_Toc10725365"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>10</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=EN-US>JavaSE</span><span lang=ZH-CN style='font-family:SimSun'>（答案精简）</span></h1>

<h2><a name="_Toc10725366"></a><a name="_Toc1314"><span lang=EN-US>10.1 hashMap</span></a><span
lang=ZH-CN style='font-family:SimHei'>底层源码，数据结构</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'>hashMap</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>的底层结构在</span><span
lang=EN-US style='color:black'>jdk1.7</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中由数组</span><span lang=EN-US style='color:black'>+</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>链表实现，在</span><span
lang=EN-US style='color:black'>jdk1.8</span><span lang=ZH-CN style='font-family:
SimSun;color:black'>中由数组</span><span lang=EN-US style='color:black'>+</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>链表</span><span lang=EN-US
style='color:black'>+</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>红黑树实现，以数组</span><span lang=EN-US style='color:black'>+</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>链表的结构为例。</span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=415 height=159 id="图片 7"
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image057.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=415 height=229 id="图片 8"
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image058.jpg"></span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>JDK1.8</span></b><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>之前</span><span lang=EN-US
style='color:black'>Put</span></b><b><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法：</span></b></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=389 height=431
id="图片 10" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image059.jpg"></span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>JDK1.8</span></b><b><span
lang=ZH-CN style='font-family:SimSun;color:black'>之后</span><span lang=EN-US
style='color:black'>Put</span></b><b><span lang=ZH-CN style='font-family:SimSun;
color:black'>方法：</span></b></p>

<p class=MsoNormal><span lang=EN-US><img border=0 width=411 height=506 id="图片 4"
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image060.jpg"></span></p>

<p class=MsoNormal><b><span lang=EN-US style='color:black'>&nbsp;</span></b></p>

<h2><a name="_Toc12486"></a><a name="_Toc10725367"><span lang=EN-US>10.2 Java</span></a><span
lang=ZH-CN style='font-family:SimHei'>自带有哪几种线程池？</span></h2>

<p class=a1 style='margin-left:21.0pt;line-height:150%'><b><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）</span></b><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>newCachedThreadPool</span></b></p>

<p class=a1 style='text-indent:20.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>创建一个可缓存线程池，如果线程池长度超过处理需要，可灵活回收空闲线程，若无可回收，则新建线程。这种类型的线程池特点是：</span></p>

<p class=a1 style='text-indent:20.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>工作线程的创建数量几乎没有限制</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>(</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>其实也有限制的</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>,</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>数目为</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>Interger.
MAX_VALUE), </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>这样可灵活的往线程池中添加线程。</span></p>

<p class=a1 style='text-indent:20.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>如果长时间没有往线程池中提交任务，即如果工作线程空闲了指定的时间</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>(</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>默认为</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>1</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>分钟</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>)</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>，则该工作线程将自动终止。终止后，如果你又提交了新的任务，则线程池重新创建一个工作线程。</span></p>

<p class=a1 style='text-indent:20.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>在使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>CachedThreadPool</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>时，一定要注意控制任务的数量，否则，由于大量线程同时运行，很有会造成系统瘫痪。</span></p>

<p class=a1 style='margin-left:21.0pt;line-height:150%'><b><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）</span></b><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>newFixedThreadPool</span></b></p>

<p class=a1 style='text-indent:20.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>创建一个指定工作线程数量的线程池。每当提交一个任务就创建一个工作线程，如果工作线程数量达到线程池初始的最大数，则将提交的任务存入到池队列中。</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>FixedThreadPool</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>是一个典型且优秀的线程池，它具有线程池提高程序效率和节省创建线程时所耗的开销的优点。但是，在线程池空闲时，即线程池中没有可运行任务时，它不会释放工作线程，还会占用一定的系统资源。</span></p>

<p class=a1 style='margin-left:21.0pt;line-height:150%'><b><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）</span></b><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>newSingleThreadExecutor</span></b></p>

<p class=a1 style='text-indent:20.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>创建一个单线程化的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Executor</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>，即只创建唯一的工作者线程来执行任务，它只会用唯一的工作线程来执行任务，保证所有任务按照指定顺序</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>(FIFO, LIFO, </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>优先级</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>)</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>执行。如果这个线程异常结束，会有另一个取代它，保证顺序执行。单工作线程最大的特点是可保证顺序地执行各个任务，并且在任意给定的时间不会有多个线程是活动的。</span></p>

<p class=a1 style='margin-left:21.0pt;line-height:150%'><b><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>4</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）</span></b><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>newScheduleThreadPool</span></b></p>

<p class=a1 style='text-indent:20.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>创建一个定长的线程池，而且支持定时的以及周期性的任务执行，支持定时及周期性任务执行。延迟</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>秒执行。</span></p>

<h2><a name="_Toc11661"></a><a name="_Toc10725368"><span lang=EN-US>10.3
HashMap</span></a><span lang=ZH-CN style='font-family:SimHei'>和</span><span
lang=EN-US>HashTable</span><span lang=ZH-CN style='font-family:SimHei'>区别</span></h2>

<p class=a1 style='margin-left:42.0pt;text-indent:-21.0pt;line-height:150%'><a
name="_Toc7380"><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>线程安全性不同</span></a></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashMap</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>是线程不安全的，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashTable</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>是线程安全的，其中的方法是</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Synchronize</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的，在多线程并发的情况下，可以直接使用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashTabl</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>，但是使用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashMap</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>时必须自己增加同步处理。</span></p>

<p class=a1 style='margin-left:42.0pt;text-indent:-21.0pt;line-height:150%'><a
name="_Toc12315"><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>是否提供</span></a><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>contains</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashMap</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>只有</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>containsValue</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>和</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>containsKey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法；</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashTable</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>有</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>contains</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>、</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>containsKey</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>和</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>containsValue</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>三个方法，其中</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>contains</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>和</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>containsValue</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法功能相同。</span></p>

<p class=a1 style='margin-left:42.0pt;text-indent:-21.0pt;line-height:150%'><a
name="_Toc23839"><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>key</span></a><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>和</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>value</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>是否允许</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>null</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>值</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Hashtable</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>中，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>key</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>和</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>value</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>都不允许出现</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>null</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>值。</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>HashMap</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中，</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>null</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>可以作为键，这样的键只有一个；可以有一个或多个键所对应的值为</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>null</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>。</span></p>

<p class=a1 style='margin-left:42.0pt;text-indent:-21.0pt;line-height:150%'><a
name="_Toc17143"><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>4)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>数组初始化和扩容机制</span></a></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;HashTable</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>在不指定容量的情况下的默认容量为</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>11</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，而</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashMap</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>为</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>16</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>Hashtable</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>不要求底层数组的容量一定要为</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>2</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的整数次幂，而</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>HashMap</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>则要求一定为</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>2</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>的整数次幂。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;Hashtable</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>扩容时，将容量变为原来的</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>倍加</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>1</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，而</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>HashMap</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>扩容时，将容量变为原来的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>2</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>倍。</span></p>

<h2><a name="_Toc9845"></a><a name="_Toc10725369"><span lang=EN-US>10.4 TreeSet</span></a><span
lang=ZH-CN style='font-family:SimHei'>和</span><span lang=EN-US>HashSet</span><span
lang=ZH-CN style='font-family:SimHei'>区别</span></h2>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>HashSet</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>是采用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>hash</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>表来实现的。其中的元素没有按顺序排列，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>add()</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>、</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>remove()</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>以及</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>contains()</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>等方法都是复杂度为</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>O(1)</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的方法。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>TreeSet</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>是采用树结构实现</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>(</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>红黑树算法</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>)</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>。元素是按顺序进行排列，但是</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>add()</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>、</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'>remove()</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>以及</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>contains()</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>等方法都是复杂度为</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>O(log (n))</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>的方法。它还提供了一些方法来处理排序的</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>set</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>，如</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:"Times New Roman",serif;color:black'>first(), last(),
headSet(), tailSet()</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>等等。</span></p>

<h2><a name="_Toc10725370"></a><a name="_Toc27096"><span lang=EN-US>10.5 String
buffer</span></a><span lang=ZH-CN style='font-family:SimHei'>和</span><span
lang=EN-US>String build</span><span lang=ZH-CN style='font-family:SimHei'>区别</span></h2>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>、</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>StringBuffer </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>与</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:"Times New Roman",serif;color:black'> StringBuilder </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>中的方法和功能完全是等价的，</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>、只是</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:"Times New Roman",serif;color:black'>StringBuffer
</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:
SimSun;color:black'>中的方法大都采用了</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>&nbsp;synchronized&nbsp;</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>关键字进行修饰，因此是线程安全的，而</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:"Times New Roman",serif;color:black'>
StringBuilder </span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>没有这个修饰，可以被认为是线程不安全的。</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>、在单线程程序下，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>StringBuilder</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>效率更快，因为它不需要加锁，不具备多线程安全而</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>StringBuffer</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>则每次都需要判断锁，效率相对更低</span></p>

<h2><a name="_Toc3913"></a><a name="_Toc10725371"><span lang=EN-US>10.6 Final</span></a><span
lang=ZH-CN style='font-family:SimHei'>、</span><span lang=EN-US>Finally</span><span
lang=ZH-CN style='font-family:SimHei'>、</span><span lang=EN-US>Finalize</span></h2>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>final</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>：修饰符（关键字）有三种用法：修饰类、变量和方法。修饰类时，意味着它不能再派生出新的子类，即不能被继承，因此它和</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>abstract</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>是反义词。修饰变量时，该变量使用中不被改变，必须在声明时给定初值，在引用中只能读取不可修改，即为常量。修饰方法时，也同样只能使用，不能在子类中被重写。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>finally</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>：通常放在</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>try…catch</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>的后面构造最终执行代码块，这就意味着程序无论正常执行还是发生异常，这里的代码只要</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>JVM</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>不关闭都能执行，可以将释放外部资源的代码写在</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>finally</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>块中。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>finalize</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>：</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Object</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>类中定义的方法，</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Java</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中允许使用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>finalize() </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法在垃圾收集器将对象从内存中清除出去之前做必要的清理工作。这个方法是由垃圾收集器在销毁对象时调用的，通过重写</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>finalize() </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>方法可以整理系统资源或者执行其他清理工作。</span></p>

<h2><a name="_Toc10725372"></a><a name="_Toc25751"><span lang=EN-US>10.7 ==</span></a><span
lang=ZH-CN style='font-family:SimHei'>和</span><span lang=EN-US>Equals</span><span
lang=ZH-CN style='font-family:SimHei'>区别</span></h2>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;== : </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>如果比较的是基本数据类型，那么比较的是变量的值</span></p>

<p class=a1 style='text-indent:42.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>如果比较的是引用数据类型，那么比较的是地址值（两个对象是否指向同一块内存）</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;equals:</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>如果没重写</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>equals</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>方法比较的是两个对象的地址值。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>如果重写了</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>equals</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>方法后我们往往比较的是对象中的属性的内容</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>equals</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>方法是从</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Object</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>类中继承的，默认的实现就是使用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>==</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'><img border=0 width=321 height=50 id="图片 47"
src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image061.jpg"></span></p>

<h1><a name="_Toc5756"></a><a name="_Toc10725373"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>11</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=EN-US>Redis</span><span lang=ZH-CN style='font-family:SimSun'>（答案精简）</span></h1>

<h2><a name="_Toc9044"></a><a name="_Toc10725374"><span lang=EN-US>11.1 </span></a><span
lang=ZH-CN style='font-family:SimHei'>缓存穿透</span><span lang=ZH-CN
style='font-family:SimHei'>、缓存雪崩、缓存击穿</span></h2>

<p class=MsoNormal><span lang=EN-US>1</span><span lang=ZH-CN style='font-family:
SimSun'>）缓存穿透是指查询一个一定不存在的数据。由于缓存命不中时会去查询数据库，查不到数据则不写入缓存，这将导致这个不存在的数据每次请求都要到数据库去查询，造成缓存穿透。</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>解决方案：</span></p>

<p class=MsoListParagraph style='margin-left:39.0pt;text-indent:-18.0pt'><span
lang=EN-US>①<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>是将空对象也缓存起来，并给它设置一个很短的过期时间，最长不超过</span><span
lang=EN-US>5</span><span lang=ZH-CN style='font-family:SimSun'>分钟</span></p>

<p class=MsoNormal style='text-indent:21.0pt'><span lang=ZH-CN
style='font-family:SimSun'>②</span><span lang=ZH-CN> </span><span lang=ZH-CN
style='font-family:SimSun'>采用布隆过滤器，将所有可能存在的数据哈希到一个足够大的</span><span lang=EN-US>bitmap</span><span
lang=ZH-CN style='font-family:SimSun'>中，一个一定不存在的数据会被这个</span><span lang=EN-US>bitmap</span><span
lang=ZH-CN style='font-family:SimSun'>拦截掉，从而避免了对底层存储系统的查询压力</span></p>

<p class=MsoNormal><span lang=EN-US>2</span><span lang=ZH-CN style='font-family:
SimSun'>）如果缓存集中在一段时间内失效，发生大量的缓存穿透，所有的查询都落在数据库上，就会造成缓存雪崩。</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>解决方案：</span></p>

<p class=MsoNormal><span lang=EN-US>       </span><span lang=ZH-CN
style='font-family:SimSun'>尽量让失效的时间点不分布在同一个时间点</span></p>

<p class=MsoNormal><span lang=EN-US>3</span><span lang=ZH-CN style='font-family:
SimSun'>）缓存击穿，是指一个</span><span lang=EN-US>key</span><span lang=ZH-CN
style='font-family:SimSun'>非常热点，在不停的扛着大并发，当这个</span><span lang=EN-US>key</span><span
lang=ZH-CN style='font-family:SimSun'>在失效的瞬间，持续的大并发就穿破缓存，直接请求数据库，就像在一个屏障上凿开了一个洞。</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>解决方案：</span></p>

<p class=MsoNormal><span lang=EN-US>       </span><span lang=ZH-CN
style='font-family:SimSun'>可以设置</span><span lang=EN-US>key</span><span
lang=ZH-CN style='font-family:SimSun'>永不过期</span></p>

<h2><a name="_Toc11620"></a><a name="_Toc10725375"><span lang=EN-US>11.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>哨兵模式</span></h2>

<p class=MsoNormal><span lang=EN-US>       </span><span lang=ZH-CN
style='font-family:SimSun'>主从复制中反客为主的自动版，如果主机</span><span lang=EN-US>Down</span><span
lang=ZH-CN style='font-family:SimSun'>掉，哨兵会从从机中选择一台作为主机，并将它设置为其他从机的主机，而且如果原来的主机再次启动的话也会成为从机。</span></p>

<h2><a name="_Toc29918"></a><a name="_Toc10725376"><span lang=EN-US>11.3 </span></a><span
lang=ZH-CN style='font-family:SimHei'>数据类型</span></h2>

<table class=MsoNormalTable border=1 cellspacing=0 cellpadding=0 align=left
 width=550 style='width:412.7pt;border-collapse:collapse;border:none;
 margin-left:6.75pt;margin-right:6.75pt'>
 <tr style='height:22.5pt'>
  <td width=124 valign=top style='width:93.1pt;border:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
  style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
  color:black'>string</span></p>
  </td>
  <td width=426 valign=top style='width:319.6pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
  style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>字符串</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=124 valign=top style='width:93.1pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
  style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
  color:black'>list</span></p>
  </td>
  <td width=426 valign=top style='width:319.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
  style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>可以重复的集合</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=124 valign=top style='width:93.1pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
  style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
  color:black'>set</span></p>
  </td>
  <td width=426 valign=top style='width:319.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
  style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>不可以重复的集合</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=124 valign=top style='width:93.1pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
  style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
  color:black'>hash</span></p>
  </td>
  <td width=426 valign=top style='width:319.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
  style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>类似于</span><span
  lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
  color:black'>Map&lt;String,String&gt;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=124 valign=top style='width:93.1pt;border:solid windowtext 1.0pt;
  border-top:none;padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
  style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
  color:black'>zset(sorted set</span><span lang=ZH-CN style='font-size:10.5pt;
  line-height:150%;font-family:SimSun;color:black'>）</span></p>
  </td>
  <td width=426 valign=top style='width:319.6pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0cm .5pt 0cm .5pt;height:22.5pt'>
  <p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
  style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>带分数的</span><span
  lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
  color:black'>set</span></p>
  </td>
 </tr>
</table>

<h2><a name="_Toc18208"></a><a name="_Toc10725377"><span lang=EN-US>11.4 </span></a><span
lang=ZH-CN style='font-family:SimHei'>持久化</span></h2>

<p class=a1><b><span lang=EN-US style='font-size:10.0pt;color:black'>1</span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>）</span></b><b><span
lang=EN-US style='font-size:10.0pt;color:black'>RDB</span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>持久化：</span></b></p>

<p class=a1 style='margin-left:39.0pt;text-indent:-18.0pt'><b><span lang=EN-US
style='font-size:10.0pt;color:black'>①<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span></b><b><span lang=ZH-CN style='font-size:10.0pt;color:black'>在指定的时间间隔内持久化</span></b></p>

<p class=a1 style='margin-left:0cm;text-indent:21.0pt'><b><span lang=EN-US
style='font-size:10.0pt;color:black'>②<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><b><span lang=ZH-CN style='font-size:10.0pt;color:black'>服务</span></b><b><span
lang=EN-US style='font-size:10.0pt;color:black'>shutdown</span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>会自动持久化</span></b></p>

<p class=a1><b><span lang=EN-US style='font-size:10.0pt;color:black'>       </span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>③</span></b><b><span
lang=EN-US style='font-size:10.0pt;color:black'>  </span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>输入</span></b><b><span
lang=EN-US style='font-size:10.0pt;color:black'>bgsave</span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>也会持久化</span></b></p>

<p class=a1><b><span lang=EN-US style='font-size:10.0pt;color:black'>2</span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>）</span></b><b><span
lang=EN-US style='font-size:10.0pt;color:black'>AOF :  </span></b><b><span
lang=ZH-CN style='font-size:10.0pt;color:black'>以日志形式记录每个更新操作</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Redis</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>重新启动时读取这个文件，重新执行新建、修改数据的命令恢复数据。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>保存策略：</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>推荐（并且也是默认）的措施为每秒持久化一次，这种策略可以兼顾速度和安全性。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>缺点：</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>1  </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>比起</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDB</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>占用更多的磁盘空间</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>2 </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>恢复备份速度要慢</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>3 </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>每次读写都同步的话，有一定的性能压力</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>4 </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>存在个别</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Bug</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，造成恢复不能</span></p>

<p class=a1><b><span lang=ZH-CN style='font-size:10.0pt;color:black'>选择策略：</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>官方推荐：</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>如果对数据不敏感，可以选单独用</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>RDB</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>；不建议单独用</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>AOF</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，因为可能出现</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Bug;</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>如果只是做纯内存缓存，可以都不用</span></p>

<h2><a name="_Toc10725378"></a><a name="_Toc2363"><span lang=EN-US>11.5 </span></a><span
lang=ZH-CN style='font-family:SimHei'>悲观锁</span></h2>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>执行操作前假设当前的操作肯定（或有很大几率）会被打断（悲观）。基于这个假设，我们在做操作前就会把相关资源锁定，不允许自己执行期间有其他操作干扰。</span></p>

<h2><a name="_Toc16250"></a><a name="_Toc10725379"><span lang=EN-US>11.6 </span></a><span
lang=ZH-CN style='font-family:SimHei'>乐观锁</span></h2>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>执行操作前假设当前操作不会被打断（乐观）。基于这个假设，我们在做操作前不会锁定资源，万一发生了其他操作的干扰，那么本次操作将被放弃。</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>Redis</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>使用的就是乐观锁。</span></p>

<h1><a name="_Toc29052"></a><a name="_Toc10725380"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>12</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=EN-US>MySql</span></h1>

<h2><a name="_Toc15845"></a><a name="_Toc10725381"><span lang=EN-US>12.1 </span></a><span
lang=EN-US>MyISAM</span><span lang=ZH-CN style='font-family:SimHei'>与</span><span
lang=EN-US>InnoDB</span><span lang=ZH-CN style='font-family:SimHei'>的区别</span></h2>

<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0
 style='margin-left:-.25pt;border-collapse:collapse'>
 <tr>
  <td width=70 valign=top style='width:52.15pt;border:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>对比项</span></b></p>
  </td>
  <td width=190 valign=top style='width:142.6pt;border:solid black 1.0pt;
  border-left:none;padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=EN-US>MyISAM</span></b></p>
  </td>
  <td width=199 valign=top style='width:149.55pt;border:solid black 1.0pt;
  border-left:none;padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=EN-US>InnoDB</span></b></p>
  </td>
 </tr>
 <tr style='height:27.75pt'>
  <td width=70 valign=top style='width:52.15pt;border:solid black 1.0pt;
  border-top:none;padding:4.5pt 4.5pt 4.5pt 4.5pt;height:27.75pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>外键</span></b></p>
  </td>
  <td width=190 valign=top style='width:142.6pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt;height:27.75pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>不支持</span></b></p>
  </td>
  <td width=199 valign=top style='width:149.55pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt;height:27.75pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>支持</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=70 valign=top style='width:52.15pt;border:solid black 1.0pt;
  border-top:none;padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>事务</span></b></p>
  </td>
  <td width=190 valign=top style='width:142.6pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>不支持</span></b></p>
  </td>
  <td width=199 valign=top style='width:149.55pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>支持</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=70 valign=top style='width:52.15pt;border:solid black 1.0pt;
  border-top:none;padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>行表锁</span></b></p>
  </td>
  <td width=190 valign=top style='width:142.6pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>表锁，即使操作一条记录也会锁住整个表，不适合高并发的操作</span></b></p>
  </td>
  <td width=199 valign=top style='width:149.55pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>行锁</span><span
  lang=EN-US>,</span></b><b><span lang=ZH-CN style='font-family:SimSun'>操作时只锁某一行，不对其它行有影响，</span></b></p>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>适合高并发的操作</span></b></p>
  </td>
 </tr>
 <tr>
  <td width=70 valign=top style='width:52.15pt;border:solid black 1.0pt;
  border-top:none;padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>缓存</span></b></p>
  </td>
  <td width=190 valign=top style='width:142.6pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>只缓存索引，不缓存真实数据</span></b></p>
  </td>
  <td width=199 valign=top style='width:149.55pt;border-top:none;border-left:
  none;border-bottom:solid black 1.0pt;border-right:solid black 1.0pt;
  padding:4.5pt 4.5pt 4.5pt 4.5pt'>
  <p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>不仅缓存索引还要缓存真实数据，对内存要求较高，而且内存大小对性能有决定性的影响</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc10725382"></a><a name="_Toc20302"><span lang=EN-US>12.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>索引</span></h2>

<p class=a1 style='line-height:150%'><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>数据结构：</span></b><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>B+Tree</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>一般来说能够达到</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>range</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>就可以算是优化了</span></p>

<p class=a1 style='line-height:150%'><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>口诀（两个法则加</span></b><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>6</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>种索引失效的情况）</span></b></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>全值匹配我最爱，最左前缀要遵守；</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>带头大哥不能死，中间兄弟不能断；</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>索引列上少计算，范围之后全失效；</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>LIKE</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>百分写最右，覆盖索引不写</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>*</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>；</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>不等空值还有</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>OR</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，索引影响要注意；</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>VAR</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>引号不可丢，</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>SQL</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>优化有诀窍。</span></p>

<h2><a name="_Toc7511"><span lang=EN-US>12.3 b-tree</span></a><span lang=ZH-CN
style='font-family:SimHei'>和</span><span lang=EN-US>b+tree</span><span
lang=ZH-CN style='font-family:SimHei'>的区别</span></h2>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>1) B-</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>树的关键字和记录是放在一起的，叶子节点可以看作外部节点，不包含任何信息；</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>B+</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>树的非叶子节点中只有关键字和指向下一个节点的索引，记录只放在叶子节点中。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>2)</span><span lang=EN-US
style='font-family:"Lucida Grande",sans-serif;color:black'> </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>在</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>B-</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>树中，越靠近根节点的记录查找时间越快，只要找到关键字即可确定记录的存在；而</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>B+</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>树中每个记录的查找时间基本是一样的，都需要从根节点走到叶子节点，而且在叶子节点中还要再比较关键字。</span></p>

<h2><a name="_Toc14814"><span lang=EN-US>12.4 redis</span></a><span lang=ZH-CN
style='font-family:SimHei'>是单线程的，为什么那么快</span></h2>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>1)</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>完全基于内存，绝大部分请求是纯粹的内存操作，非常快速。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>2)</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>数据结构简单，对数据操作也简单，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Redis</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>中的数据结构是专门进行设计的</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>3)</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>采用单线程，避免了不必要的上下文切换和竞争条件，也不存在多进程或者多线程导致的切换而消耗</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'> CPU</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>，不用去考虑各种锁的问题，不存在加锁释放锁操作，没有因为可能出现死锁而导致的性能消耗</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>4)</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>使用多路</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>I/O</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>复用模型，非阻塞</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>IO</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>5)</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>使用底层模型不同，它们之间底层实现方式以及与客户端之间通信的应用协议不一样，</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Redis</span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>直接自己构建了</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>VM </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>机制 ，因为一般的系统调用系统函数的话，会浪费一定的时间去移动和请求</span></p>

<h2><a name="_Toc26642"><span lang=EN-US>12.5 MySQL</span></a><span lang=ZH-CN
style='font-family:SimHei'>的事务</span></h2>

<p class=a1 style='line-height:150%'><a name="_Toc19209"><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>一、事务的基本要素（</span></b></a><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>ACID</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）</span></b></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>1</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>、原子性（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Atomicity</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）：事务开始后所有操作，要么全部做完，要么全部不做，不可能停滞在中间环节。事务执行过程中出错，会回滚到事务开始前的状态，所有的操作就像没有发生一样。也就是说事务是一个不可分割的整体，就像化学中学过的原子，是物质构成的基本单位</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>2</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>、一致性（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Consistency</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）：事务开始前和结束后，数据库的完整性约束没有被破坏 。比如</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>向</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>B</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>转账，不可能</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>扣了钱，</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>B</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>却没收到。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>3</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>、隔离性（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Isolation</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）：同一时间，只允许一个事务请求同一数据，不同的事务之间彼此没有任何干扰。比如</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>正在从一张银行卡中取钱，在</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>A</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>取钱的过程结束前，</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>B</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>不能向这张卡转账。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>4</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>、持久性（</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Durability</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>）：事务完成后，事务对数据库的所有更新将被保存到数据库，不能回滚。</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>&nbsp;</span></p>

<p class=a1 style='line-height:150%'><a name="_Toc11931"><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>二、事务的并发问题</span></b></a></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>1</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>、脏读：事务</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>读取了事务</span><span lang=EN-US style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>B</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>更新的数据，然后</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>B</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>回滚操作，那么</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>读取到的数据是脏数据</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>2</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>、不可重复读：事务</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'> A </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>多次读取同一数据，事务</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'> B </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>在事务</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>A</span><span lang=ZH-CN style='font-size:
10.5pt;line-height:150%;font-family:SimSun;color:black'>多次读取的过程中，对数据作了更新并提交，导致事务</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>多次读取同一数据时，结果 不一致</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>3</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>、幻读：系统管理员</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>将数据库中所有学生的成绩从具体分数改为</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>ABCDE</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>等级，但是系统管理员</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>B</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>就在这个时候插入了一条具体分数的记录，当系统管理员</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>A</span><span lang=ZH-CN style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>改结束后发现还有一条记录没有改过来，就好像发生了幻觉一样，这就叫幻读。</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>小结：不可重复读的和幻读很容易混淆，不可重复读侧重于修改，幻读侧重于新增或删除。解决不可重复读的问题只需锁住满足条件的行，解决幻读需要锁表</span></p>

<p class=a1 style='line-height:150%'><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>&nbsp;</span></p>

<p class=a1 style='line-height:150%'><a name="_Toc7925"><b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>三、</span></b></a><b><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>MySQL</span></b><b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>事务隔离级别</span></b></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>事务隔离级别</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>                     </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>脏读</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>       </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>不可重复读</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>     </span><span lang=ZH-CN style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>幻读</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>读未提交（</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>read-uncommitted</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>       </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>是</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>         </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>            </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>是</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>不可重复读（</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>read-committed</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>       </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>否</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>         </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>是</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>            </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>是</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>可重复读（</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>repeatable-read</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>        </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>否</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>         </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>否</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>            </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>是</span></p>

<p class=a1 style='line-height:150%'><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>串行化（</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>serializable</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）</span><span lang=EN-US style='font-size:10.5pt;line-height:150%;
font-family:SimSun;color:black'>            </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>否</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>         </span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>否</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>            </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>否</span></p>

<h2><a name="_Toc10725383"></a><a name="_Toc31590"><span lang=EN-US>12.6 </span></a><span
lang=ZH-CN style='font-family:SimHei'>常见面试</span><span lang=EN-US>sql</span></h2>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>1.</span><span lang=ZH-CN style='font-size:12.0pt;font-family:
SimSun;color:black'>用一条</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>SQL</span><span lang=ZH-CN style='font-size:
12.0pt;font-family:SimSun;color:black'>语句查询出每门课都大于</span><span lang=EN-US
style='font-size:12.0pt;font-family:SimSun;color:black'>80</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>分的学生姓名</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>name&nbsp;&nbsp; kecheng&nbsp;&nbsp; fenshu<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>张三</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>语文</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;81<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>张三</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>数学</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;75<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>李四</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>语文</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;76<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>李四</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>数学</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;
 90<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>王五</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>语文</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;81<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>王五</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>数学</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;100<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>王五</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>英语</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;&nbsp;90<br>
<br>
A: select distinct name from table where name not in (select distinct name from
table where fenshu&lt;=80)<br>
B</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>：</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>select name
from table group by name having min(fenshu)&gt;80</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'><br>
2.&nbsp;</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>学生表 如下</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>:<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>自动编号</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>学号</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>姓名 课程编号 课程名称
分数</span><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'><br>
1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2005001&nbsp;</span><span lang=ZH-CN
style='font-size:12.0pt;font-family:SimSun;color:black'>张三</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;  0001&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>数学</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;
69<br>
2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2005002&nbsp;</span><span lang=ZH-CN
style='font-size:12.0pt;font-family:SimSun;color:black'>李四</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;  0001&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>数学</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;
89<br>
3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2005001&nbsp;</span><span lang=ZH-CN
style='font-size:12.0pt;font-family:SimSun;color:black'>张三  </span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;0001&nbsp;&nbsp;&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>数学</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>&nbsp;&nbsp;
69<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>删除除了自动编号不同</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>,&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>其他都相同的学生冗余信息</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'><br>
<br>
A: delete tablename where&nbsp;</span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>自动编号</span><span lang=EN-US style='font-size:
12.0pt;font-family:SimSun;color:black'>&nbsp;not in(select min(</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>自动编号</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>) from
tablename group by</span><span lang=ZH-CN style='font-size:12.0pt;font-family:
SimSun;color:black'>学号</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>,&nbsp;</span><span lang=ZH-CN
style='font-size:12.0pt;font-family:SimSun;color:black'>姓名</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>,&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>课程编号</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>,&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>课程名称</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>,&nbsp;</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>分数</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>)</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:18.0pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>3.</span><span lang=ZH-CN style='font-size:12.0pt;font-family:
SimSun;color:black'>一个叫</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>team</span><span lang=ZH-CN style='font-size:
12.0pt;font-family:SimSun;color:black'>的表，里面只有一个字段</span><span lang=EN-US
style='font-size:12.0pt;font-family:SimSun;color:black'>name,</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>一共有</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>4</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>条纪录，分别是</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>a,b,c,d,</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>对应四个球队，现在四个球队进行比赛，用一条</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>sql</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>语句显示所有可能的比赛组合</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>.<br>
<br>
</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>答：</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>select a.name, b.name<br>
from team a, team b&nbsp;<br>
where a.name &lt; b.name</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>4.</span><span lang=ZH-CN style='font-size:12.0pt;font-family:
SimSun;color:black'>面试题：怎么把这样一个</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'><br>
year&nbsp;&nbsp; month amount<br>
1991&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp; 1.1<br>
1991&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp; 1.2<br>
1991&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp; 1.3<br>
1991&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp; 1.4<br>
1992&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp; 2.1<br>
1992&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp; 2.2<br>
1992&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp; 2.3<br>
1992&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp; 2.4<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>查成这样一个结果</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'><br>
year m1 &nbsp;m2&nbsp; m3   m4<br>
1991 1.1 1.2 1.3 1.4<br>
1992 2.1 2.2 2.3 2.4&nbsp;<br>
<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>答案</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'><br>
select year,&nbsp;<br>
(select amount from&nbsp;aaa m where month=1&nbsp;and m.year=aaa.year) as m1,<br>
(select amount from&nbsp;aaa m where month=2&nbsp;and m.year=aaa.year) as m2,<br>
(select amount from&nbsp;aaa m where month=3&nbsp;and m.year=aaa.year) as m3,<br>
(select amount from  aaa m where month=4&nbsp;and m.year=aaa.year) as m4<br>
from aaa&nbsp;group by year</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>*********************************************************************<i><br>
</i>5.</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>说明：复制表</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>(</span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>只复制结构</span><span lang=EN-US style='font-size:
12.0pt;font-family:SimSun;color:black'>,</span><span lang=ZH-CN
style='font-size:12.0pt;font-family:SimSun;color:black'>源表名：</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>a</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>新表名：</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>b)&nbsp;<br>
<br>
SQL: select * into b from a where 1&lt;&gt;1 (where1=1</span><span lang=ZH-CN
style='font-size:12.0pt;font-family:SimSun;color:black'>，拷贝表结构和数据内容</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>)<br>
ORACLE:create table b</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:42.0pt;
line-height:19.5pt;background:white'><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>As</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:42.0pt;
line-height:19.5pt;background:white'><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>Select * from a where 1=2</span></p>

<p class=MsoNormal align=left style='text-align:left;text-indent:42.0pt;
line-height:19.5pt;background:white'><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left;background:white'><span
lang=EN-US style='font-size:12.0pt;line-height:125%;font-family:SimSun;
color:black'>[&lt;&gt;</span><span lang=ZH-CN style='font-size:12.0pt;
line-height:125%;font-family:SimSun;color:black'>（不等于）</span><span lang=EN-US
style='font-size:12.0pt;line-height:125%;font-family:SimSun;color:black'>(SQL
Server Compact)</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>比较两个表达式。 当使用此运算符比较非空表达式时，如果左操作数不等于右操作数，则结果为</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'> TRUE</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>。 否则，结果为</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'> FALSE</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>。</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>]</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>&nbsp;</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>6. </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>原表</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>:<br>
courseid coursename score<br>
-------------------------------------<br>
1 java 70<br>
2 oracle 90<br>
3 xml 40<br>
4 jsp 30<br>
5 servlet 80<br>
-------------------------------------<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>为了便于阅读</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>,</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>查询此表后的结果显式如下</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>(</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>及格分数为</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>60):<br>
courseid coursename score mark<br>
---------------------------------------------------<br>
1 java 70 pass<br>
2 oracle 90 pass<br>
3 xml 40 fail<br>
4 jsp 30 fail<br>
5 servlet 80 pass<br>
---------------------------------------------------<br>
</span><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>写出此查询语句</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'><br>
select courseid, coursename ,score ,if(score&gt;=60,
&quot;pass&quot;,&quot;fail&quot;)  as mark from course</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>7.</span><span lang=ZH-CN style='font-size:12.0pt;font-family:
SimSun;color:black'>表名：购物信息</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>购物人</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>      </span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>商品名称</span><span lang=EN-US style='font-size:
12.0pt;font-family:SimSun;color:black'>     </span><span lang=ZH-CN
style='font-size:12.0pt;font-family:SimSun;color:black'>数量</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>A            </span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>甲</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>          2</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>B            </span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>乙</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>          4</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>C            </span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>丙</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>          1</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>A            </span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>丁</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>          2</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>B            </span><span lang=ZH-CN style='font-size:12.0pt;
font-family:SimSun;color:black'>丙</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>          5</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>……</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'> </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>给出所有购入商品为两种或两种以上的购物人记录</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'> </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>答：</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>select * from </span><span lang=ZH-CN style='font-size:
12.0pt;font-family:SimSun;color:black'>购物信息</span><span lang=EN-US
style='font-size:12.0pt;font-family:SimSun;color:black'> where </span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>购物人</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'> in (select </span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>购物人</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'> from </span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>购物信息</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'> group by </span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>购物人</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'> having
count(*) &gt;= 2);</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>8.</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>info </span><span lang=ZH-CN style='font-size:12.0pt;font-family:
SimSun;color:black'>表</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>date result</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-09 win</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-09 lose </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-09 lose </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-09 lose </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-10 win </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-10 lose </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-10 lose </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>如果要生成下列结果</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>, </span><span lang=ZH-CN style='font-size:
12.0pt;font-family:SimSun;color:black'>该如何写</span><span lang=EN-US
style='font-size:12.0pt;font-family:SimSun;color:black'>sql</span><span
lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;color:black'>语句</span><span
lang=EN-US style='font-size:12.0pt;font-family:SimSun;color:black'>? </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>   </span><span lang=ZH-CN style='font-size:12.0pt;font-family:
SimSun;color:black'>　　</span><span lang=EN-US style='font-size:12.0pt;
font-family:SimSun;color:black'>    win lose</span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-09  2   2 </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>2005-05-10  1   2 </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>答案： </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>(1) select date, sum(case when result = &quot;win&quot; then 1
else 0 end) as &quot;win&quot;, sum(case when result = &quot;lose&quot; then 1
else 0 end) as &quot;lose&quot; from info group by date; </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=EN-US style='font-size:12.0pt;font-family:SimSun;
color:black'>(2) select a.date, a.result as win, b.result as lose </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>　　</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>from </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>　　</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>(select date, count(result) as result from info where
result = &quot;win&quot; group by date) as a </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>　　</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>join </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>　　</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>(select date, count(result) as result from info where
result = &quot;lose&quot; group by date) as b </span></p>

<p class=MsoNormal align=left style='text-align:left;line-height:19.5pt;
background:white'><span lang=ZH-CN style='font-size:12.0pt;font-family:SimSun;
color:black'>　　</span><span lang=EN-US style='font-size:12.0pt;font-family:
SimSun;color:black'>on a.date = b.date;</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h1><a name="_Toc10725384"></a><a name="_Toc8579"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>13</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=EN-US>JVM</span></h1>

<h2><a name="_Toc28941"></a><a name="_Toc10725385"><span lang=EN-US>13.1 JVM</span></a><span
lang=ZH-CN style='font-family:SimHei'>内存分哪几个区，每个区的作用是什么</span><span lang=EN-US>?</span></h2>

<p class=MsoNormal><span lang=EN-US style='color:black'><img border=0
width=393 height=355 id="图片 1" src="http://kflys.gitee.io/upic/2020/03/22/uPic/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E4%B9%8B%E9%AB%98%E9%A2%91%E9%9D%A2%E8%AF%95%E9%A2%98.fld/image062.jpg"></span></p>

<p class=MsoNormal><span lang=EN-US>java</span><span lang=ZH-CN
style='font-family:SimSun'>虚拟机主要分为以下几个区</span><span lang=EN-US>:</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>方法区</span></b><span
lang=ZH-CN style='font-family:SimSun'>：</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>a.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>有时候也成为永久代，在该区内很少发生垃圾回收，但是并不代表不发生</span><span
lang=EN-US>GC</span><span lang=ZH-CN style='font-family:SimSun'>，在这里进行的</span><span
lang=EN-US>GC</span><span lang=ZH-CN style='font-family:SimSun'>主要是对方法区里的常量池和对类型的卸载</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun'>方法区主要用来存储已被虚拟机加载的类的信息、常量、静态变量和即时编译器编译后的代码等数据。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>c.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>该区域是被线程共享的。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun'>方法区里有一个运行时常量池，用于存放静态编译产生的字面量和符号引用。该常量池具有动态性，也就是说常量并不一定是编译时确定，运行时生成的常量也会存在这个常量池中。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>虚拟机栈</span></b><span
lang=EN-US>: </span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>a.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>虚拟机栈也就是我们平常所称的栈内存</span><span lang=EN-US>,</span><span
lang=ZH-CN style='font-family:SimSun'>它为</span><span lang=EN-US>java</span><span
lang=ZH-CN style='font-family:SimSun'>方法服务，每个方法在执行的时候都会创建一个栈帧，用于存储局部变量表、操作数栈、动态链接和方法出口等信息。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun'>虚拟机栈是线程私有的，它的生命周期与线程相同。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>c.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>局部变量表里存储的是基本数据类型、</span><span lang=EN-US>returnAddress</span><span
lang=ZH-CN style='font-family:SimSun'>类型（指向一条字节码指令的地址）和对象引用，这个对象引用有可能是指向对象起始地址的一个指针，也有可能是代表对象的句柄或者与对象相关联的位置。局部变量所需的内存空间在编译器间确定</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun'>操作数栈的作用主要用来存储运算结果以及运算的操作数，它不同于局部变量表通过索引来访问，而是压栈和出栈的方式</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>e.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>每个栈帧都包含一个指向运行时常量池中该栈帧所属方法的引用，持有这个引用是为了支持方法调用过程中的动态连接</span><span
lang=EN-US>.</span><span lang=ZH-CN style='font-family:SimSun'>动态链接就是将常量池中的符号引用在运行期转化为直接引用。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>本地方法栈</span></b><span
lang=ZH-CN style='font-family:SimSun'>：</span><span lang=EN-US><br>
</span><span lang=ZH-CN style='font-family:SimSun'>本地方法栈和虚拟机栈类似，只不过本地方法栈为</span><span
lang=EN-US>Native</span><span lang=ZH-CN style='font-family:SimSun'>方法服务。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>4)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>堆</span></b><span
lang=ZH-CN style='font-family:SimSun'>：</span></p>

<p class=MsoNormal><span lang=EN-US>java</span><span lang=ZH-CN
style='font-family:SimSun'>堆是所有线程所共享的一块内存，在虚拟机启动时创建，几乎所有的对象实例都在这里创建，因此该区域经常发生垃圾回收操作。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><b><span
lang=EN-US>5)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b><b><span lang=ZH-CN style='font-family:SimSun'>程序计数器：</span></b></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>内存空间小，字节码解释器工作时通过改变这个计数值可以选取下一条需要执行的字节码指令，分支、循环、跳转、异常处理和线程恢复等功能都需要依赖这个计数器完成。该内存区域是唯一一个</span><span
lang=EN-US>java</span><span lang=ZH-CN style='font-family:SimSun'>虚拟机规范没有规定任何</span><span
lang=EN-US>OOM</span><span lang=ZH-CN style='font-family:SimSun'>情况的区域。</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:"Times New Roman",serif;
color:black'>&nbsp;</span></p>

<h2><a name="_Toc8250"></a><a name="_Toc10725386"><span lang=EN-US>13.2 Java</span></a><span
lang=ZH-CN style='font-family:SimHei'>类加载过程</span><span lang=EN-US>?</span></h2>

<p class=MsoNormal><span lang=EN-US>Java</span><span lang=ZH-CN
style='font-family:SimSun'>类加载需要经历一下几个过程：</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><a
name="_Toc20231"><span lang=EN-US>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>加载</span></a></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>加载时类加载的第一个过程，在这个阶段，将完成一下三件事情：</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>a.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>通过一个类的全限定名获取该类的二进制流。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun'>将该二进制流中的静态存储结构转化为方法去运行时数据结构。</span><span lang=EN-US>&nbsp;</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>c.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>在内存中生成该类的</span><span lang=EN-US>Class</span><span
lang=ZH-CN style='font-family:SimSun'>对象，作为该类的数据访问入口。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><a
name="_Toc3223"><span lang=EN-US>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>验证</span></a></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>验证的目的是为了确保</span><span
lang=EN-US>Class</span><span lang=ZH-CN style='font-family:SimSun'>文件的字节流中的信息不回危害到虚拟机</span><span
lang=EN-US>.</span><span lang=ZH-CN style='font-family:SimSun'>在该阶段主要完成以下四钟验证</span><span
lang=EN-US>: </span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>a.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>文件格式验证：验证字节流是否符合</span><span lang=EN-US>Class</span><span
lang=ZH-CN style='font-family:SimSun'>文件的规范，如主次版本号是否在当前虚拟机范围内，常量池中的常量是否有不被支持的类型</span><span
lang=EN-US>. </span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>b.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun'>元数据验证</span><span lang=EN-US>:</span><span
lang=ZH-CN style='font-family:SimSun'>对字节码描述的信息进行语义分析，如这个类是否有父类，是否集成了不被继承的类等。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>c.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>字节码验证：是整个验证过程中最复杂的一个阶段，通过验证数据流和控制流的分析，确定程序语义是否正确，主要针对方法体的验证。如：方法中的类型转换是否正确，跳转指令是否正确等。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span>d.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span lang=ZH-CN
style='font-family:SimSun'>符号引用验证：这个动作在后面的解析过程中发生，主要是为了确保解析动作能正确执行。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>e.<span style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
lang=ZH-CN style='font-family:SimSun'>准备</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>准备阶段是为类的静态变量分配内存并将其初始化为默认值，这些内存都将在方法区中进行分配。准备阶段不分配类中的实例变量的内存，实例变量将会在对象实例化时随着对象一起分配在</span><span
lang=EN-US>Java</span><span lang=ZH-CN style='font-family:SimSun'>堆中。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><a
name="_Toc14642"><span lang=EN-US>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>解析</span></a></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>该阶段主要完成符号引用到直接引用的转换动作。解析动作并不一定在初始化动作完成之前，也有可能在初始化之后。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><a
name="_Toc31215"><span lang=EN-US>4)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>初始化</span></a></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>初始化时类加载的最后一步，前面的类加载过程，除了在加载阶段用户应用程序可以通过自定义类加载器参与之外，其余动作完全由虚拟机主导和控制。到了初始化阶段，才真正开始执行类中定义的</span><span
lang=EN-US>Java</span><span lang=ZH-CN style='font-family:SimSun'>程序代码。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<h2><a name="_Toc10725387"></a><a name="_Toc16571"><span lang=EN-US>13.3 java</span></a><span
lang=ZH-CN style='font-family:SimHei'>中垃圾收集的方法有哪些</span><span lang=EN-US>?</span></h2>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>1</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）引用计数法</span></b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'> &nbsp; </span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>应用于：微软的</span><span lang=EN-US style='font-size:10.5pt;line-height:
150%;font-family:SimSun;color:black'>COM/ActionScrip3/Python</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>等</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>a)&nbsp;</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>如果对象没有被引用，就会被回收，缺点：需要维护一个引用计算器</span></p>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>2</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）复制算法</span></b><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>  </span></b><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>年轻代中使用的是</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Minor GC</span><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>，这种</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>GC</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>算法采用的是复制算法</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>(Copying)</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>a)&nbsp;</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>效率高，缺点：需要内存容量大，比较耗内存</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>b)&nbsp;</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>使用在占空间比较小、刷新次数多的新生区</span></p>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>3</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）标记清除</span></b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>  </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>老年代一般是由标记清除或者是标记清除与标记整理的混合实现</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>a)&nbsp;</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>效率比较低，会差生碎片。</span></p>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>4</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）标记压缩</span></b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>  </span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>老年代一般是由标记清除或者是标记清除与标记整理的混合实现</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>a)&nbsp;</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>效率低速度慢，需要移动对象，但不会产生碎片。</span></p>

<p class=a1 style='line-height:150%'><b><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>5</span></b><b><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>）标记清除压缩</span></b><span lang=ZH-CN style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>标记清除</span><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>-</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>标记压缩的集合，多次</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>GC</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>后才</span><span
lang=EN-US style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>Compact</span></p>

<p class=a1 style='text-indent:21.0pt;line-height:150%'><span lang=EN-US
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>a)&nbsp;</span><span
lang=ZH-CN style='font-size:10.5pt;line-height:150%;font-family:SimSun;
color:black'>使用于占空间大刷新次数少的养老区，是</span><span lang=EN-US style='font-size:10.5pt;
line-height:150%;font-family:SimSun;color:black'>3 4</span><span lang=ZH-CN
style='font-size:10.5pt;line-height:150%;font-family:SimSun;color:black'>的集合体</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h2><a name="_Toc31553"></a><a name="_Toc10725388"><span lang=EN-US>13.4 </span></a><span
lang=ZH-CN style='font-family:SimHei'>如何判断一个对象是否存活</span><span lang=EN-US>?(</span><span
lang=ZH-CN style='font-family:SimHei'>或者</span><span lang=EN-US>GC</span><span
lang=ZH-CN style='font-family:SimHei'>对象的判定方法</span><span lang=EN-US>)</span></h2>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>判断一个对象是否存活有两种方法</span><span
lang=EN-US>: </span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>引用计数法</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>可达性算法</span><span
lang=EN-US>(</span><span lang=ZH-CN style='font-family:SimSun'>引用链法</span><span
lang=EN-US>)</span></p>

<h2><a name="_Toc24863"></a><a name="_Toc10725389"><span lang=EN-US>13.5 </span></a><span
lang=ZH-CN style='font-family:SimHei'>什么是类加载器，类加载器有哪些</span><span lang=EN-US>?</span></h2>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>实现通过类的权限定名获取该类的二进制字节流的代码块叫做类加载器。</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>主要有一下四种类加载器</span><span
lang=EN-US>: </span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>启动类加载器</span><span
lang=EN-US>(Bootstrap ClassLoader)</span><span lang=ZH-CN style='font-family:
SimSun'>用来加载</span><span lang=EN-US>java</span><span lang=ZH-CN
style='font-family:SimSun'>核心类库，无法被</span><span lang=EN-US>java</span><span
lang=ZH-CN style='font-family:SimSun'>程序直接引用。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>扩展类加载器</span><span
lang=EN-US>(extensions class loader):</span><span lang=ZH-CN style='font-family:
SimSun'>它用来加载</span><span lang=EN-US> Java </span><span lang=ZH-CN
style='font-family:SimSun'>的扩展库。</span><span lang=EN-US>Java </span><span
lang=ZH-CN style='font-family:SimSun'>虚拟机的实现会提供一个扩展库目录。该类加载器在此目录里面查找并加载</span><span
lang=EN-US> Java </span><span lang=ZH-CN style='font-family:SimSun'>类。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>系统类加载器（</span><span
lang=EN-US>system class loader</span><span lang=ZH-CN style='font-family:SimSun'>）也叫应用类加载器：它根据</span><span
lang=ZH-CN> </span><span lang=EN-US>Java </span><span lang=ZH-CN
style='font-family:SimSun'>应用的类路径（</span><span lang=EN-US>CLASSPATH</span><span
lang=ZH-CN style='font-family:SimSun'>）来加载</span><span lang=EN-US> Java </span><span
lang=ZH-CN style='font-family:SimSun'>类。一般来说，</span><span lang=EN-US>Java </span><span
lang=ZH-CN style='font-family:SimSun'>应用的类都是由它来完成加载的。可以通过</span><span
lang=EN-US> ClassLoader.getSystemClassLoader()</span><span lang=ZH-CN
style='font-family:SimSun'>来获取它。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>4)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>用户自定义类加载器，通过继承</span><span
lang=EN-US> java.lang.ClassLoader</span><span lang=ZH-CN style='font-family:
SimSun'>类的方式实现。</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>&nbsp;</span></p>

<h2><a name="_Toc10725390"></a><a name="_Toc26791"><span lang=EN-US>13.6 </span></a><span
lang=ZH-CN style='font-family:SimHei'>简述</span><span lang=EN-US>Java</span><span
lang=ZH-CN style='font-family:SimHei'>内存分配与回收策略以及</span><span lang=EN-US>Minor
GC</span><span lang=ZH-CN style='font-family:SimHei'>和</span><span lang=EN-US>Major
GC</span><span lang=ZH-CN style='font-family:SimHei'>（</span><span lang=EN-US>full
GC</span><span lang=ZH-CN style='font-family:SimHei'>）</span></h2>

<p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>内存分配：</span></b></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>栈区</span></b><span
lang=ZH-CN style='font-family:SimSun'>：栈分为</span><span lang=EN-US>java</span><span
lang=ZH-CN style='font-family:SimSun'>虚拟机栈和本地方法栈</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>堆区</span></b><span
lang=ZH-CN style='font-family:SimSun'>：堆被所有线程共享区域，在虚拟机启动时创建，唯一目的存放对象实例。堆区是</span><span
lang=EN-US>gc</span><span lang=ZH-CN style='font-family:SimSun'>的主要区域，通常情况下分为两个区块年轻代和年老代。更细一点年轻代又分为</span><span
lang=EN-US>Eden</span><span lang=ZH-CN style='font-family:SimSun'>区，主要放新创建对象，</span><span
lang=EN-US>From survivor </span><span lang=ZH-CN style='font-family:SimSun'>和</span><span
lang=EN-US> To survivor </span><span lang=ZH-CN style='font-family:SimSun'>保存</span><span
lang=EN-US>gc</span><span lang=ZH-CN style='font-family:SimSun'>后幸存下的对象，默认情况下各自占比</span><span
lang=EN-US> 8:1:1</span><span lang=ZH-CN style='font-family:SimSun'>。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>方法区</span></b><span
lang=ZH-CN style='font-family:SimSun'>：被所有线程共享区域，用于存放已被虚拟机加载的类信息，常量，静态变量等数据。被</span><span
lang=EN-US>Java</span><span lang=ZH-CN style='font-family:SimSun'>虚拟机描述为堆的一个逻辑部分。习惯是也叫它永久代（</span><span
lang=EN-US>permanment generation</span><span lang=ZH-CN style='font-family:
SimSun'>）</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>4)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b><span lang=ZH-CN style='font-family:SimSun'>程序计数器</span></b><span
lang=ZH-CN style='font-family:SimSun'>：当前线程所执行的行号指示器。通过改变计数器的值来确定下一条指令，比如循环，分支，跳转，异常处理，线程恢复等都是依赖计数器来完成。线程私有的。</span></p>

<p class=MsoNormal><span lang=EN-US>&nbsp;</span></p>

<p class=MsoNormal><b><span lang=ZH-CN style='font-family:SimSun'>回收策略以及</span><span
lang=EN-US>Minor GC</span></b><b><span lang=ZH-CN style='font-family:SimSun'>和</span><span
lang=EN-US>Major GC</span></b><b><span lang=ZH-CN style='font-family:SimSun'>：</span></b></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>对象优先在堆的</span><span
lang=EN-US>Eden</span><span lang=ZH-CN style='font-family:SimSun'>区分配。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>2)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>大对象直接进入老年代。</span></p>

<p class=MsoListParagraph style='margin-left:21.0pt;text-indent:-21.0pt'><span
lang=EN-US>3)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span lang=ZH-CN style='font-family:SimSun'>长期存活的对象将直接进入老年代。</span></p>

<p class=MsoNormal><span lang=ZH-CN style='font-family:SimSun'>当</span><span
lang=EN-US>Eden</span><span lang=ZH-CN style='font-family:SimSun'>区没有足够的空间进行分配时，虚拟机会执行一次</span><span
lang=EN-US>Minor GC.Minor GC</span><span lang=ZH-CN style='font-family:SimSun'>通常发生在新生代的</span><span
lang=EN-US>Eden</span><span lang=ZH-CN style='font-family:SimSun'>区，在这个区的对象生存期短，往往发生</span><span
lang=EN-US>GC</span><span lang=ZH-CN style='font-family:SimSun'>的频率较高，回收速度比较快</span><span
lang=EN-US>;Full Gc/Major GC </span><span lang=ZH-CN style='font-family:SimSun'>发生在老年代，一般情况下，触发老年代</span><span
lang=EN-US>GC</span><span lang=ZH-CN style='font-family:SimSun'>的时候不会触发</span><span
lang=EN-US>Minor GC,</span><span lang=ZH-CN style='font-family:SimSun'>但是通过配置，可以在</span><span
lang=EN-US>Full GC</span><span lang=ZH-CN style='font-family:SimSun'>之前进行一次</span><span
lang=EN-US>Minor GC</span><span lang=ZH-CN style='font-family:SimSun'>这样可以加快老年代的回收速度。</span></p>

<h1><a name="_Toc31322"><span lang=ZH-CN style='font-family:SimSun'>第</span><span
lang=EN-US>14</span></a><span lang=ZH-CN style='font-family:SimSun'>章</span><span
lang=ZH-CN> </span><span lang=EN-US>JUC</span></h1>

<p class=MsoNormal style='line-height:172%;page-break-after:avoid'><a
name="_Toc4426"><b><span lang=EN-US style='font-size:14.0pt;line-height:172%;
color:black'>14.1 Synchronized</span></b></a><b><span lang=ZH-CN
style='font-size:14.0pt;line-height:172%;font-family:SimHei;color:black'>与</span></b><b><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'>Lock</span></b><b><span
lang=ZH-CN style='font-size:14.0pt;line-height:172%;font-family:SimHei;
color:black'>的区别</span></b></p>

<p class=MsoNormal><span lang=EN-US>1</span><span lang=ZH-CN style='font-family:
SimSun'>）</span><span lang=EN-US>Synchronized</span><span lang=ZH-CN
style='font-family:SimSun'>能实现的功能</span><span lang=EN-US>Lock</span><span
lang=ZH-CN style='font-family:SimSun'>都可以实现，而且</span><span lang=EN-US>Lock</span><span
lang=ZH-CN style='font-family:SimSun'>比</span><span lang=EN-US>Synchronized</span><span
lang=ZH-CN style='font-family:SimSun'>更好用，更灵活。</span></p>

<p class=MsoNormal><span lang=EN-US>2</span><span lang=ZH-CN style='font-family:
SimSun'>）</span><span lang=EN-US>Synchronized</span><span lang=ZH-CN
style='font-family:SimSun'>可以自动上锁和解锁；</span><span lang=EN-US>Lock</span><span
lang=ZH-CN style='font-family:SimSun'>需要手动上锁和解锁</span></p>

<p class=MsoNormal style='line-height:172%;page-break-after:avoid'><a
name="_Toc22923"><b><span lang=EN-US style='font-size:14.0pt;line-height:172%;
color:black'>14.2 Runnable</span></b></a><b><span lang=ZH-CN style='font-size:
14.0pt;line-height:172%;font-family:SimHei;color:black'>和</span></b><b><span
lang=EN-US style='font-size:14.0pt;line-height:172%;color:black'>Callable</span></b><b><span
lang=ZH-CN style='font-size:14.0pt;line-height:172%;font-family:SimHei;
color:black'>的区别</span></b></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>1</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Runnable</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>接口中的方法没有返回值；</span><span lang=EN-US style='color:black'>Callable</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>接口中的方法有返回值</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>2</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Runnable</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>接口中的方法没有抛出异常；</span><span lang=EN-US style='color:black'>Callable</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>接口中的方法抛出了异常</span></p>

<p class=MsoNormal><span lang=EN-US style='color:black'>3</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>）</span><span lang=EN-US
style='color:black'>Runnable</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>接口中的落地方法是</span><span lang=EN-US style='color:black'>call</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>方法；</span><span lang=EN-US
style='color:black'>Callable</span><span lang=ZH-CN style='font-family:SimSun;
color:black'>接口中的落地方法是</span><span lang=EN-US style='color:black'>run</span><span
lang=ZH-CN style='font-family:SimSun;color:black'>方法</span></p>

<p class=MsoNormal style='line-height:172%;page-break-after:avoid'><a
name="_Toc17928"><b><span lang=EN-US style='font-size:14.0pt;line-height:172%;
color:black'>14.3 </span></b></a><b><span lang=ZH-CN style='font-size:14.0pt;
line-height:172%;font-family:SimHei;color:black'>什么是分布式锁</span></b></p>

<p class=MsoNormal><span lang=EN-US>       </span><span lang=ZH-CN
style='font-family:SimSun'>当在分布式模型下，数据只有一份（或有限制），此时需要利用锁的技术控制某一时刻修改数据的进程数。分布式锁可以将标记存在内存，只是该内存不是某个进程分配的内存而是公共内存，如</span><span
lang=EN-US> Redis</span><span lang=ZH-CN style='font-family:SimSun'>，通过</span><span
lang=EN-US>set (key,value,nx,px,timeout)</span><span lang=ZH-CN
style='font-family:SimSun'>方法添加分布式锁。</span></p>

<p class=MsoNormal style='line-height:172%;page-break-after:avoid'><a
name="_Toc11140"><b><span lang=EN-US style='font-size:14.0pt;line-height:172%;
color:black'>14.4 </span></b></a><b><span lang=ZH-CN style='font-size:14.0pt;
line-height:172%;font-family:SimHei;color:black'>什么是分布式事务</span></b></p>

<p class=MsoNormal><span lang=EN-US>       </span><span lang=ZH-CN
style='font-family:SimSun'>分布式事务指事务的参与者、支持事务的服务器、资源服务器以及事务管理器分别位于不同的分布式系统的不同节点之上。简单的说，就是一次大的操作由不同的小操作组成，这些小的操作分布在不同的服务器上，且属于不同的应用，分布式事务需要保证这些小操作要么全部成功，要么全部失败。</span></p>

<h1><a name="_Toc10725391"></a><a name="_Toc18984"><span lang=ZH-CN
style='font-family:SimSun'>第</span><span lang=EN-US>15</span></a><span
lang=ZH-CN style='font-family:SimSun'>章</span><span lang=ZH-CN> </span><span
lang=ZH-CN style='font-family:SimSun'>模拟考试</span></h1>

<h2><a name="_Toc20776"></a><a name="_Toc10725392"><span lang=EN-US>14.1 </span></a><span
lang=ZH-CN style='font-family:SimHei'>选择题</span></h2>

<h3><a name="_Toc10725393"></a><a name="_Toc25296"><span lang=EN-US>14.1.1&nbsp;&nbsp;HDFS</span></a></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>1.</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>下面哪个程序负责</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> HDFS </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>数据存储？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>a)NameNode &nbsp;b)Jobtracker
c)Datanode &nbsp;d)secondaryNameNode &nbsp;e)tasktracker</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>2. HDfS </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>中的</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> block </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>默认保存几份？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>a)3</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>份</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> b)2</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>份</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>  c)1</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>份</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>   d)</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>不确定</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>3.</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>下列哪个程序通常与</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>在一个节点启动？</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>a)SecondaryNameNode 
b)DataNode   c)TaskTracker   d)Jobtracker</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>解析：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>JobTracker </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>对应于</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>TaskTracker </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>对应于 </span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>DataNode</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>4. HDFS </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>默认</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Block Size</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>a)32MB
&nbsp;b)64MB  c)128MB</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>注：旧版本是</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>64MB</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>5. Client </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>端上传文件的时候下列哪项正确</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>a)</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>数据经过</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>传递给</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> DataNode</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>b)Client </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>端将文件切分为</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Block</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>，依次上传</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>c)Client </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>只上传数据到一台</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> DataNode</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>，然后由</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>负责</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Block </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>复制工作</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>分析：</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>Client </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>向</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>发起文件写入的请求。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>根据文件大小和文件块配置情况，返回给</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Client </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>它所管理部分</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> DataNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>的信息。</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>Client </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>将文件划分为多个</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Block</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>，根据</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> DataNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>的地址信息，按顺序写入到每一个</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> DataNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>块中。</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>6.</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>下面与</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> HDFS </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>类似的框架是？</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>C</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>A NTFS   B
FAT32   C GFS   D EXT3</span></p>

<h3><a name="_Toc10725394"></a><a name="_Toc2959"><span lang=EN-US>14.1.2&nbsp;&nbsp;</span></a><span
lang=ZH-CN style='font-family:SimSun'>集群管理</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:DengXian;color:black'>1.</span><span lang=ZH-CN
style='line-height:150%;font-family:DengXian;color:black'>下列哪项通常是集群的最主要瓶颈 </span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>C</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>a)CPU
&nbsp;b)</span><span lang=ZH-CN style='line-height:150%;font-family:DengXian;
color:black'>网络</span><span lang=EN-US style='line-height:150%;font-family:
DengXian;color:black'> &nbsp;c)</span><span lang=ZH-CN style='line-height:150%;
font-family:DengXian;color:black'>磁盘</span><span lang=EN-US style='line-height:
150%;font-family:DengXian;color:black'> IO &nbsp;d)</span><span lang=ZH-CN
style='line-height:150%;font-family:DengXian;color:black'>内存</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:DengXian;color:black'>2.</span><span lang=ZH-CN
style='line-height:150%;font-family:DengXian;color:black'>关于</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>SecondaryNameNode
</span><span lang=ZH-CN style='line-height:150%;font-family:DengXian;
color:black'>哪项是正确的？ </span><span lang=EN-US style='line-height:150%;
font-family:DengXian;color:black'>C</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>a)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>它是</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>的热备</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>b)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>它对内存没有要求</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>c)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>它的目的是帮助</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>合并编辑日志，减少</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>启动时间</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>d)SecondaryNameNode
</span><span lang=ZH-CN style='line-height:150%;font-family:DengXian;
color:black'>应与</span><span lang=EN-US style='line-height:150%;font-family:
DengXian;color:black'> NameNode </span><span lang=ZH-CN style='line-height:
150%;font-family:DengXian;color:black'>部署到一个节点</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:DengXian;color:black'>3.</span><span lang=ZH-CN
style='line-height:150%;font-family:DengXian;color:black'>配置机架感知的下面哪项正确 </span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>C</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>a)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>如果一个机架出问题，不会影响数据读写</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>b)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>写入数据的时候会写到不同机架的</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> DataNode </span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>中</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>c)MapReduce
</span><span lang=ZH-CN style='line-height:150%;font-family:DengXian;
color:black'>会根据机架获取离自己比较近的网络数据</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:DengXian;color:black'>4.</span><span lang=ZH-CN
style='line-height:150%;font-family:DengXian;color:black'>下列哪个是</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> Hadoop </span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>运行的模式 </span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>ABC</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>a)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>单机版</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> b)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>伪分布式</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> c)</span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>分布式</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:DengXian;color:black'>5. Cloudera </span><span lang=ZH-CN
style='line-height:150%;font-family:DengXian;color:black'>提供哪几种安装</span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'> CDH </span><span
lang=ZH-CN style='line-height:150%;font-family:DengXian;color:black'>的方法 </span><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>A</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:DengXian;color:black'>a)Cloudera
manager &nbsp;b)Tarball &nbsp;c)Yum &nbsp;d)Rpm</span></p>

<h3><a name="_Toc17184"></a><a name="_Toc10725395"><span lang=EN-US>14.1.3&nbsp;&nbsp;Zookeeper</span></a><span
lang=ZH-CN style='font-family:SimSun'>基础</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>1.</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>下面与</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Zookeeper </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>类似的框架是？</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>D</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>AProtobuf</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>B Java</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>C Kafka</span></p>

<p class=MsoNormal style='text-indent:21.0pt;line-height:150%'><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>D Chubby</span></p>

<h2><a name="_Toc26164"></a><a name="_Toc10725396"><span lang=EN-US>14.2 </span></a><span
lang=ZH-CN style='font-family:SimHei'>判断题</span></h2>

<h3><a name="_Toc16918"></a><a name="_Toc10725397"><span lang=EN-US>14.2.1&nbsp;&nbsp;</span></a><span
lang=ZH-CN style='font-family:SimSun'>集群管理</span></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>1. Ganglia </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>不仅可以进行监控，也可以进行告警。（正确）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>2. Nagios </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>不可以监控</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Hadoop </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>集群，因为它不提供</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Hadoop</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>支持。（错误 ）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>3.</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>如果</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>意外终止，</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>SecondaryNameNode
</span><span lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>会接替它使集群继续工作。（错误
）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>4. Cloudera CDH </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>是需要付费使用的。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>5. NameNode </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>负责管理</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> metadata</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>，</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>client </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>端每次读写请求，它都会从磁盘中读取或则会写入</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> metadata</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>信息并反馈</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> client </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>端。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>6. DataNode </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>通过长连接与</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>保持通信。错误</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>7. Hadoop </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>自身具有严格的权限管理和安全措施保障集群正常运行。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>8. Slave </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>节点要存储数据，所以它的磁盘越大越好。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>9. hadoop dfsadmin </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>–</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>report </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>命令用于检测</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> HDFS </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>损坏块。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>10. Hadoop </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>默认调度器策略为</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> FIFO</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>（错误 ）</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>  </span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>11.</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>集群内每个节点都应该配</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> RAID</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>，这样避免单磁盘损坏，影响整个节点运行。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>12. Hadoop </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>环境变量中的</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>
HADOOP_HEAPSIZE </span><span lang=ZH-CN style='line-height:150%;font-family:
SimSun;color:black'>用于设置所有</span><span lang=EN-US style='line-height:150%;
font-family:SimSun;color:black'> Hadoop </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>守护线程的内存。它默认是</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> 200 GB</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>。（ 错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>13.DataNode </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>首次加入</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> cluster </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>的时候，如果</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> log </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>中报告不兼容文件版本，那需要</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>执行―</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'>Hadoopnamenode
-format</span><span lang=ZH-CN style='line-height:150%;font-family:SimSun;
color:black'>‖操作格式化磁盘。（错误 ）</span></p>

<h3><a name="_Toc14275"></a><a name="_Toc10725398"><span lang=EN-US>14.2.2&nbsp;&nbsp;HDFS</span></a></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>1. Block Size </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>是不可以修改的。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>2. Hadoop </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>支持数据的随机读写。（错）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>3.</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>因为</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> HDFS </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>有多个副本，所以</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> NameNode </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>是不存在单点问题的。（错误
）</span></p>

<h3><a name="_Toc28845"></a><a name="_Toc10725399"><span lang=EN-US>14.2.3&nbsp;&nbsp;MapReduce</span></a></h3>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>1.&nbsp;Hadoop </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>是</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Java </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>开发的，所以</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> MapReduce </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>只支持</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> Java </span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>语言编写。（错误 ）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>2.&nbsp;</span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>每个</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> map</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>就是一个线程。（错误）</span></p>

<p class=MsoNormal style='line-height:150%'><span lang=EN-US style='line-height:
150%;font-family:SimSun;color:black'>3.&nbsp;Mapreduce </span><span lang=ZH-CN
style='line-height:150%;font-family:SimSun;color:black'>的</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> input split
</span><span lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>就是一个</span><span
lang=EN-US style='line-height:150%;font-family:SimSun;color:black'> block</span><span
lang=ZH-CN style='line-height:150%;font-family:SimSun;color:black'>。（错误）</span></p>

</div>

</body>

</html>
